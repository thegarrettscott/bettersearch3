(()=>{var __webpack_modules__={6304:function(module,__unused_webpack_exports,__webpack_require__){module=__webpack_require__.nmd(module),
/**!
 * FlexSearch.js v0.7.21 (Bundle)
 * Copyright 2018-2021 Nextapps GmbH
 * Author: Thomas Wilkerling
 * Licence: Apache-2.0
 * https://github.com/nextapps-de/flexsearch
 */
function _f(self){"use strict";try{module&&(self=module)}catch(e){}var t;function u(e){return void 0===e||e}function aa(e){const t=Array(e);for(let n=0;n<e;n++)t[n]=v();return t}function v(){return Object.create(null)}function ba(e,t){return t.length-e.length}function x(e){return"string"==typeof e}function C(e){return"object"==typeof e}function D(e){return"function"==typeof e}function ca(e,t){var n=da;if(e&&(t&&(e=E(e,t)),this.H&&(e=E(e,this.H)),this.J&&1<e.length&&(e=E(e,this.J)),n||""===n)){if(e=e.split(n),this.filter){t=this.filter,n=e.length;const r=[];for(let o=0,i=0;o<n;o++){const n=e[o];n&&!t[n]&&(r[i++]=n)}e=r}return e}return e}self._factory=_f;const da=/[\p{Z}\p{S}\p{P}\p{C}]+/u,ea=/[\u0300-\u036f]/g;function fa(e,t){const n=Object.keys(e),r=n.length,o=[];let i="",a=0;for(let s,c,u=0;u<r;u++)s=n[u],(c=e[s])?(o[a++]=F(t?"(?!\\b)"+s+"(\\b|_)":s),o[a++]=c):i+=(i?"|":"")+s;return i&&(o[a++]=F(t?"(?!\\b)("+i+")(\\b|_)":"("+i+")"),o[a]=""),o}function E(e,t){for(let n=0,r=t.length;n<r&&(e=e.replace(t[n],t[n+1]));n+=2);return e}function F(e){return new RegExp(e,"g")}function ha(e){let t="",n="";for(let r,o=0,i=e.length;o<i;o++)(r=e[o])!==n&&(t+=n=r);return t}var ja={encode:ia,F:!1,G:""};function ia(e){return ca.call(this,(""+e).toLowerCase(),!1)}const ka={},G={};function la(e){I(e,"add"),I(e,"append"),I(e,"search"),I(e,"update"),I(e,"remove")}function I(e,t){e[t+"Async"]=function(){const e=this,n=arguments;var r=n[n.length-1];let o;return D(r)&&(o=r,delete n[n.length-1]),r=new Promise((function(r){setTimeout((function(){e.async=!0;const o=e[t].apply(e,n);e.async=!1,r(o)}))})),o?(r.then(o),this):r}}function ma(e,t,n,r){const o=e.length;let i,a,s=[],c=0;r&&(r=[]);for(let u=o-1;0<=u;u--){const l=e[u],h=l.length,f=v();let d=!i;for(let e=0;e<h;e++){const h=l[e],p=h.length;if(p)for(let e,l,m=0;m<p;m++)if(l=h[m],i){if(i[l]){if(!u)if(n)n--;else if(s[c++]=l,c===t)return s;(u||r)&&(f[l]=1),d=!0}if(r&&(a[l]=(e=a[l])?++e:e=1,e<o)){const t=r[e-2]||(r[e-2]=[]);t[t.length]=l}}else f[l]=1}if(r)i||(a=f);else if(!d)return[];i=f}if(r)for(let e,o,a=r.length-1;0<=a;a--){e=r[a],o=e.length;for(let r,a=0;a<o;a++)if(r=e[a],!i[r]){if(n)n--;else if(s[c++]=r,c===t)return s;i[r]=1}}return s}function na(e,t){const n=v(),r=v(),o=[];for(let t=0;t<e.length;t++)n[e[t]]=1;for(let e,i=0;i<t.length;i++){e=t[i];for(let t,i=0;i<e.length;i++)t=e[i],n[t]&&!r[t]&&(r[t]=1,o[o.length]=t)}return o}function J(e){this.l=!0!==e&&e,this.cache=v(),this.h=[]}function oa(e,t,n){C(e)&&(e=e.query);let r=this.cache.get(e);return r||(r=this.search(e,t,n),this.cache.set(e,r)),r}J.prototype.set=function(e,t){if(!this.cache[e]){var n=this.h.length;for(n===this.l?delete this.cache[this.h[n-1]]:n++,--n;0<n;n--)this.h[n]=this.h[n-1];this.h[0]=e}this.cache[e]=t},J.prototype.get=function(e){const t=this.cache[e];if(this.l&&t&&(e=this.h.indexOf(e))){const t=this.h[e-1];this.h[e-1]=this.h[e],this.h[e]=t}return t};const qa={memory:{charset:"latin:extra",D:3,B:4,m:!1},performance:{D:3,B:3,s:!1,context:{depth:2,D:1}},match:{charset:"latin:extra",G:"reverse"},score:{charset:"latin:advanced",D:20,B:3,context:{depth:3,D:9}},default:{}};function ra(e,t,n,r,o,i){setTimeout((function(){const a=e(n,JSON.stringify(i));a&&a.then?a.then((function(){t.export(e,t,n,r,o+1)})):t.export(e,t,n,r,o+1)}))}function K(e,t){if(!(this instanceof K))return new K(e);var n;if(e){x(e)?e=qa[e]:(n=e.preset)&&(e=Object.assign({},n[n],e)),n=e.charset;var r=e.lang;x(n)&&(-1===n.indexOf(":")&&(n+=":default"),n=G[n]),x(r)&&(r=ka[r])}else e={};let o,i,a=e.context||{};if(this.encode=e.encode||n&&n.encode||ia,this.register=t||v(),this.D=o=e.resolution||9,this.G=t=n&&n.G||e.tokenize||"strict",this.depth="strict"===t&&a.depth,this.l=u(a.bidirectional),this.s=i=u(e.optimize),this.m=u(e.fastupdate),this.B=e.minlength||1,this.C=e.boost,this.map=i?aa(o):v(),this.A=o=a.resolution||1,this.h=i?aa(o):v(),this.F=n&&n.F||e.rtl,this.H=(t=e.matcher||r&&r.H)&&fa(t,!1),this.J=(t=e.stemmer||r&&r.J)&&fa(t,!0),n=t=e.filter||r&&r.filter){n=t,r=v();for(let e=0,t=n.length;e<t;e++)r[n[e]]=1;n=r}this.filter=n,this.cache=(t=e.cache)&&new J(t)}function L(e,t,n,r,o){return n&&1<e?t+(r||0)<=e?n+(o||0):(e-1)/(t+(r||0))*(n+(o||0))+1|0:0}function M(e,t,n,r,o,i,a){let s=a?e.h:e.map;(!t[n]||a&&!t[n][a])&&(e.s&&(s=s[r]),a?((t=t[n]||(t[n]=v()))[a]=1,s=s[a]||(s[a]=v())):t[n]=1,s=s[n]||(s[n]=[]),e.s||(s=s[r]||(s[r]=[])),i&&-1!==s.indexOf(o)||(s[s.length]=o,e.m&&((e=e.register[o]||(e.register[o]=[]))[e.length]=s)))}function sa(e,t,n,r,o,i,a,s){let c=[],u=s?e.h:e.map;if(e.s||(u=ua(u,a,s,e.l)),u){let n=0;const l=Math.min(u.length,s?e.A:e.D);for(let t,h,f=0,d=0;f<l&&!((t=u[f])&&(e.s&&(t=ua(t,a,s,e.l)),o&&t&&i&&(h=t.length,h<=o?(o-=h,t=null):(t=t.slice(o),o=0)),t&&(c[n++]=t,i&&(d+=t.length,d>=r))));f++);if(n)return i?ta(c,r,0):void(t[t.length]=c)}return!n&&c}function ta(e,t,n){return e=1===e.length?e[0]:[].concat.apply([],e),n||e.length>t?e.slice(n,n+t):e}function ua(e,t,n,r){return n?e=(e=e[(r=r&&t>n)?t:n])&&e[r?n:t]:e=e[t],e}function N(e,t,n,r,o){let i=0;if(e.constructor===Array)if(o)-1!==(t=e.indexOf(t))?1<e.length&&(e.splice(t,1),i++):i++;else{o=Math.min(e.length,n);for(let a,s=0;s<o;s++)(a=e[s])&&(i=N(a,t,n,r,o),r||i||delete e[s])}else for(let a in e)(i=N(e[a],t,n,r,o))||delete e[a];return i}function va(e){e=e.data;var t=self._index;const n=e.args;var r=e.task;if("init"===r)r=e.options||{},e=e.factory,t=r.encode,r.cache=!1,t&&0===t.indexOf("function")&&(r.encode=Function("return "+t)()),e?(Function("return "+e)()(self),self._index=new self.FlexSearch.Index(r),delete self.FlexSearch):self._index=new K(r);else e=e.id,t=t[r].apply(t,n),postMessage("search"===r?{id:e,msg:t}:{id:e})}t=K.prototype,t.append=function(e,t){return this.add(e,t,!0)},t.add=function(e,t,n,r){if(t&&(e||0===e)){if(!r&&!n&&this.register[e])return this.update(e,t);if(r=(t=this.encode(t)).length){const u=v(),l=v(),h=this.depth,f=this.D;for(let d=0;d<r;d++){let p=t[this.F?r-1-d:d];var o=p.length;if(p&&o>=this.B&&(h||!l[p])){var i=L(f,r,d),a="";switch(this.G){case"full":if(3<o){for(i=0;i<o;i++)for(var s=o;s>i;s--)if(s-i>=this.B){var c=L(f,r,d,o,i);M(this,l,a=p.substring(i,s),c,e,n)}break}case"reverse":if(2<o){for(s=o-1;0<s;s--)(a=p[s]+a).length>=this.B&&M(this,l,a,L(f,r,d,o,s),e,n);a=""}case"forward":if(1<o){for(s=0;s<o;s++)(a+=p[s]).length>=this.B&&M(this,l,a,i,e,n);break}default:if(this.C&&(i=Math.min(i/this.C(t,p,d)|0,f-1)),M(this,l,p,i,e,n),h&&1<r&&d<r-1)for(o=v(),a=this.A,i=p,s=Math.min(h+1,r-d),o[i]=1,c=1;c<s;c++)if((p=t[this.F?r-1-d-c:d+c])&&p.length>=this.B&&!o[p]){o[p]=1;const t=this.l&&p>i;M(this,u,t?i:p,L(a+(r/2>a?0:1),r,d,s-1,c-1),e,n,t?p:i)}}}}this.m||(this.register[e]=1)}}return this},t.search=function(e,t,n){n||(!t&&C(e)?e=(n=e).query:C(t)&&(n=t));let r,o,i,a,s,c=[],u=0;if(n){t=n.limit,u=n.offset||0;var l=n.context;o=n.suggest}if(e&&(r=(e=this.encode(e)).length,1<r)){n=v();var h=[];for(let t,i=0,a=0;i<r;i++)if((t=e[i])&&t.length>=this.B&&!n[t]){if(!(this.s||o||this.map[t]))return c;h[a++]=t,n[t]=1}r=(e=h).length}if(!r)return c;for(t||(t=100),n=0,(l=this.depth&&1<r&&!1!==l)?(i=e[0],n=1):1<r&&e.sort(ba);n<r;n++){if(s=e[n],l?(a=sa(this,c,o,t,u,2===r,s,i),o&&!1===a&&c.length||(i=s)):a=sa(this,c,o,t,u,1===r,s),a)return a;if(o&&n===r-1){if(!(h=c.length)){if(l){l=0,n=-1;continue}return c}if(1===h)return ta(c[0],t,u)}}return ma(c,t,u,o)},t.contain=function(e){return!!this.register[e]},t.update=function(e,t){return this.remove(e).add(e,t)},t.remove=function(e,t){const n=this.register[e];if(n){if(this.m)for(let t,r=0;r<n.length;r++)t=n[r],t.splice(t.indexOf(e),1);else N(this.map,e,this.D,this.s),this.depth&&N(this.h,e,this.A,this.s);if(t||delete this.register[e],this.cache){t=this.cache;for(let n,r,o=0;o<t.h.length;o++)r=t.h[o],n=t.cache[r],-1!==n.indexOf(e)&&(t.h.splice(o--,1),delete t.cache[r])}}return this},t.searchCache=oa,t.export=function(e,t,n,r,o){let i,a;switch(o||(o=0)){case 0:if(i="reg",this.m){a=v();for(let e in this.register)a[e]=1}else a=this.register;break;case 1:i="cfg",a={doc:0,opt:this.s?1:0};break;case 2:i="map",a=this.map;break;case 3:i="ctx",a=this.h;break;default:return}return ra(e,t||this,n?n+"."+i:i,r,o,a),!0},t.import=function(e,t){if(t)switch(x(t)&&(t=JSON.parse(t)),e){case"cfg":this.s=!!t.opt;break;case"reg":this.m=!1,this.register=t;break;case"map":this.map=t;break;case"ctx":this.h=t}},la(K.prototype);let wa=0;function O(e){if(!(this instanceof O))return new O(e);var t;e?D(t=e.encode)&&(e.encode=t.toString()):e={},(t=(self||window)._factory)&&(t=t.toString());const n=self.exports,r=this;this.o=xa(t,n,e.worker),this.h=v(),this.o&&(n?this.o.on("message",(function(e){r.h[e.id](e.msg),delete r.h[e.id]})):this.o.onmessage=function(e){e=e.data,r.h[e.id](e.msg),delete r.h[e.id]},this.o.postMessage({task:"init",factory:t,options:e}))}function P(e){O.prototype[e]=O.prototype[e+"Async"]=function(){const t=this,n=[].slice.call(arguments);var r=n[n.length-1];let o;return D(r)&&(o=r,n.splice(n.length-1,1)),r=new Promise((function(r){setTimeout((function(){t.h[++wa]=r,t.o.postMessage({task:e,id:wa,args:n})}))})),o?(r.then(o),this):r}}function xa(a,b,c){let d;try{d=b?eval('new (require("worker_threads")["Worker"])("../dist/node/node.js")'):a?new Worker(URL.createObjectURL(new Blob(["onmessage="+va.toString()],{type:"text/javascript"}))):new Worker(x(c)?c:"worker/worker.js",{type:"module"})}catch(e){}return d}function Q(e){if(!(this instanceof Q))return new Q(e);var t,n=e.document||e.doc||e;this.K=[],this.h=[],this.A=[],this.register=v(),this.key=(t=n.key||n.id)&&S(t,this.A)||"id",this.m=u(e.fastupdate),this.C=(t=n.store)&&!0!==t&&[],this.store=t&&v(),this.I=(t=n.tag)&&S(t,this.A),this.l=t&&v(),this.cache=(t=e.cache)&&new J(t),e.cache=!1,this.o=e.worker,this.async=!1,t=v();let r=n.index||n.field||n;x(r)&&(r=[r]);for(let n,o,i=0;i<r.length;i++)n=r[i],x(n)||(o=n,n=n.field),o=C(o)?Object.assign({},e,o):e,this.o&&(t[n]=new O(o),t[n].o||(this.o=!1)),this.o||(t[n]=new K(o,this.register)),this.K[i]=S(n,this.A),this.h[i]=n;if(this.C)for(x(e=n.store)&&(e=[e]),n=0;n<e.length;n++)this.C[n]=S(e[n],this.A);this.index=t}function S(e,t){const n=e.split(":");let r=0;for(let o=0;o<n.length;o++)0<=(e=n[o]).indexOf("[]")&&(e=e.substring(0,e.length-2))&&(t[r]=!0),e&&(n[r++]=e);return r<n.length&&(n.length=r),1<r?n:n[0]}function T(e,t){if(x(t))e=e[t];else for(let n=0;e&&n<t.length;n++)e=e[t[n]];return e}function U(e,t,n,r,o){if(e=e[o],r===n.length-1)t[o]=e;else if(e)if(e.constructor===Array)for(t=t[o]=Array(e.length),o=0;o<e.length;o++)U(e,t,n,r,o);else t=t[o]||(t[o]=v()),o=n[++r],U(e,t,n,r,o)}function V(e,t,n,r,o,i,a,s){if(e=e[a])if(r===t.length-1){if(e.constructor===Array){if(n[r]){for(t=0;t<e.length;t++)o.add(i,e[t],!0,!0);return}e=e.join(" ")}o.add(i,e,s,!0)}else if(e.constructor===Array)for(a=0;a<e.length;a++)V(e,t,n,r,o,i,a,s);else a=t[++r],V(e,t,n,r,o,i,a,s)}function ya(e,t,n,r){let o=this.l[e],i=o&&o.length-n;if(i&&0<i)return(i>t||n)&&(o=o.slice(n,n+t)),r&&(o=za.call(this,o)),{tag:e,result:o}}function za(e){const t=Array(e.length);for(let n,r=0;r<e.length;r++)n=e[r],t[r]={id:n,doc:this.store[n]};return t}P("add"),P("append"),P("search"),P("update"),P("remove"),t=Q.prototype,t.add=function(e,t,n){if(C(e)&&(e=T(t=e,this.key)),t&&(e||0===e)){if(!n&&this.register[e])return this.update(e,t);for(let r,o,i=0;i<this.h.length;i++)o=this.h[i],r=this.K[i],x(r)&&(r=[r]),V(t,r,this.A,0,this.index[o],e,r[0],n);if(this.I){let r=T(t,this.I),o=v();x(r)&&(r=[r]);for(let t,i,a=0;a<r.length;a++)if(t=r[a],!o[t]&&(o[t]=1,i=this.l[t]||(this.l[t]=[]),!n||-1===i.indexOf(e))&&(i[i.length]=e,this.m)){const t=this.register[e]||(this.register[e]=[]);t[t.length]=i}}if(this.store&&(!n||!this.store[e])){let n;if(this.C){n=v();for(let e,r=0;r<this.C.length;r++)e=this.C[r],x(e)?n[e]=t[e]:U(t,n,e,0,e[0])}this.store[e]=n||t}}return this},t.append=function(e,t){return this.add(e,t,!0)},t.update=function(e,t){return this.remove(e).add(e,t)},t.remove=function(e){if(C(e)&&(e=T(e,this.key)),this.register[e]){for(var t=0;t<this.h.length&&(this.index[this.h[t]].remove(e,!this.o),!this.m);t++);if(this.I&&!this.m)for(let n in this.l){const r=(t=this.l[n]).indexOf(e);-1!==r&&(1<t.length?t.splice(r,1):delete this.l[n])}this.store&&delete this.store[e],delete this.register[e]}return this},t.search=function(e,t,n,r){n||(!t&&C(e)?e=(n=e).query:C(t)&&(n=t,t=0));let o,i,a,s,c,u,l=[],h=[],f=0;if(n)if(n.constructor===Array)a=n,n=null;else{if(a=(o=n.pluck)||n.index||n.field,s=n.tag,i=this.store&&n.enrich,c="and"===n.bool,t=n.limit||100,u=n.offset||0,s&&(x(s)&&(s=[s]),!e)){for(let e,n=0;n<s.length;n++)(e=ya.call(this,s[n],t,u,i))&&(l[l.length]=e,f++);return f?l:[]}x(a)&&(a=[a])}a||(a=this.h),c=c&&(1<a.length||s&&1<s.length);const d=!r&&(this.o||this.async)&&[];for(let o,i,p,m=0;m<a.length;m++){let g;if(i=a[m],x(i)||(g=i,i=i.field),d)d[m]=this.index[i].searchAsync(e,t,g||n);else{if(o=r?r[m]:this.index[i].search(e,t,g||n),p=o&&o.length,s&&p){const e=[];let n=0;c&&(e[0]=[o]);for(let t,r,o=0;o<s.length;o++)t=s[o],(p=(r=this.l[t])&&r.length)&&(n++,e[e.length]=c?[r]:r);n&&(o=c?ma(e,t||100,u||0):na(o,e),p=o.length)}if(p)h[f]=i,l[f++]=o;else if(c)return[]}}if(d){const r=this;return new Promise((function(o){Promise.all(d).then((function(i){o(r.search(e,t,n,i))}))}))}if(!f)return[];if(o&&(!i||!this.store))return l[0];for(let e,t=0;t<h.length;t++){if(e=l[t],e.length&&i&&(e=za.call(this,e)),o)return e;l[t]={field:h[t],result:e}}return l},t.contain=function(e){return!!this.register[e]},t.get=function(e){return this.store[e]},t.set=function(e,t){return this.store[e]=t,this},t.searchCache=oa,t.export=function(e,t,n,r,o){if(o||(o=0),r||(r=0),r<this.h.length){const n=this.h[r],i=this.index[n];t=this,setTimeout((function(){i.export(e,t,o?n.replace(":","-"):"",r,o++)||(r++,o=1,t.export(e,t,n,r,o))}))}else{let t;switch(o){case 1:n="tag",t=this.l;break;case 2:n="store",t=this.store;break;default:return}ra(e,this,n,r,o,t)}},t.import=function(e,t){if(t)switch(x(t)&&(t=JSON.parse(t)),e){case"tag":this.l=t;break;case"reg":this.m=!1,this.register=t;for(let e,n=0;n<this.h.length;n++)e=this.index[this.h[n]],e.register=t,e.m=!1;break;case"store":this.store=t;break;default:const n=(e=e.split("."))[0];e=e[1],n&&e&&this.index[n].import(e,t)}},la(Q.prototype);var Ba={encode:Aa,F:!1,G:""};const Ca=[F("[àáâãäå]"),"a",F("[èéêë]"),"e",F("[ìíîï]"),"i",F("[òóôõöő]"),"o",F("[ùúûüű]"),"u",F("[ýŷÿ]"),"y",F("ñ"),"n",F("[çc]"),"k",F("ß"),"s",F(" & ")," and "];function Aa(e){var t=e;return t.normalize&&(t=t.normalize("NFD").replace(ea,"")),ca.call(this,t.toLowerCase(),!e.normalize&&Ca)}var Ea={encode:Da,F:!1,G:"strict"};const Fa=/[^a-z0-9]+/,Ga={b:"p",v:"f",w:"f",z:"s",x:"s",ß:"s",d:"t",n:"m",c:"k",g:"k",j:"k",q:"k",i:"e",y:"e",u:"o"};function Da(e){const t=[];if(e=Aa.call(this,e).join(" ")){const n=e.split(Fa),r=n.length;for(let o,i=0,a=0;i<r;i++)if((e=n[i])&&(!this.filter||!this.filter[e])){o=e[0];let n=Ga[o]||o,r=n;for(let t=1;t<e.length;t++){o=e[t];const i=Ga[o]||o;i&&i!==r&&(n+=i,r=i)}t[a++]=n}}return t}var Ia={encode:Ha,F:!1,G:""};const Ja=[F("ae"),"a",F("oe"),"o",F("sh"),"s",F("th"),"t",F("ph"),"f",F("pf"),"f",F("(?![aeo])h(?![aeo])"),"",F("(?!^[aeo])h(?!^[aeo])"),""];function Ha(e,t){return e&&(2<(e=Da.call(this,e).join(" ")).length&&(e=E(e,Ja)),t||(1<e.length&&(e=ha(e)),e&&(e=e.split(" ")))),e}var La={encode:Ka,F:!1,G:""};const Ma=F("(?!\\b)[aeo]");function Ka(e){return e&&(1<(e=Ha.call(this,e,!0)).length&&(e=e.replace(Ma,"")),1<e.length&&(e=ha(e)),e&&(e=e.split(" "))),e}G["latin:default"]=ja,G["latin:simple"]=Ba,G["latin:balance"]=Ea,G["latin:advanced"]=Ia,G["latin:extra"]=La;const W=self;let Y;const Z={Index:K,Document:Q,Worker:O,registerCharset:function(e,t){G[e]=t},registerLanguage:function(e,t){ka[e]=t}};(Y=W.define)&&Y.amd?Y([],(function(){return Z})):W.exports?W.exports=Z:W.FlexSearch=Z}(this)}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__={};(()=>{"use strict";var e={REWRITE_ACTIVE:!0,COMMAND_ACTIVE:!0,TESTING_REWRITE:!1,TESTING_COMMAND:!1,UNIVERSAL_CONTEXT:!1,ZENDESK_AUTOFILL:!1,AVOID_RELOAD:!1,IMAGE_CHECKBOX:!0,REWRITE_IMAGES:!0,LOG_MUTATIONS:!1,OVERRIDE_TYPEAHEAD_URL:void 0,TEMPLATE_ACTIVE:!1,DEBUG:!1,BASE_URL:"https://api.hyperwriteai.com/",USE_OTHERSIDE_TOKEN:!0,LOG_TIMES:!1},t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};!function(e){function t(){}function n(e,t){if(e=void 0===e?"utf-8":e,t=void 0===t?{fatal:!1}:t,-1===o.indexOf(e.toLowerCase()))throw new RangeError("Failed to construct 'TextDecoder': The encoding label provided ('"+e+"') is invalid.");if(t.fatal)throw Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}function r(e){for(var t=0,n=Math.min(65536,e.length+1),r=new Uint16Array(n),o=[],i=0;;){var a=t<e.length;if(!a||i>=n-1){if(o.push(String.fromCharCode.apply(null,r.subarray(0,i))),!a)return o.join("");e=e.subarray(t),i=t=0}if(0==(128&(a=e[t++])))r[i++]=a;else if(192==(224&a)){var s=63&e[t++];r[i++]=(31&a)<<6|s}else if(224==(240&a)){s=63&e[t++];var c=63&e[t++];r[i++]=(31&a)<<12|s<<6|c}else 240==(248&a)&&(65535<(a=(7&a)<<18|(s=63&e[t++])<<12|(c=63&e[t++])<<6|63&e[t++])&&(a-=65536,r[i++]=a>>>10&1023|55296,a=56320|1023&a),r[i++]=a)}}if(e.TextEncoder&&e.TextDecoder)return!1;var o=["utf-8","utf8","unicode-1-1-utf-8"];Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),t.prototype.encode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to encode: the 'stream' option is unsupported.");t=0;for(var n=e.length,r=0,o=Math.max(32,n+(n>>>1)+7),i=new Uint8Array(o>>>3<<3);t<n;){var a=e.charCodeAt(t++);if(55296<=a&&56319>=a){if(t<n){var s=e.charCodeAt(t);56320==(64512&s)&&(++t,a=((1023&a)<<10)+(1023&s)+65536)}if(55296<=a&&56319>=a)continue}if(r+4>i.length&&(o+=8,o=(o*=1+t/e.length*2)>>>3<<3,(s=new Uint8Array(o)).set(i),i=s),0==(4294967168&a))i[r++]=a;else{if(0==(4294965248&a))i[r++]=a>>>6&31|192;else if(0==(4294901760&a))i[r++]=a>>>12&15|224,i[r++]=a>>>6&63|128;else{if(0!=(4292870144&a))continue;i[r++]=a>>>18&7|240,i[r++]=a>>>12&63|128,i[r++]=a>>>6&63|128}i[r++]=63&a|128}}return i.slice?i.slice(0,r):i.subarray(0,r)},Object.defineProperty(n.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(n.prototype,"fatal",{value:!1}),Object.defineProperty(n.prototype,"ignoreBOM",{value:!1});var i=r;"function"==typeof Buffer&&Buffer.from?i=function(e){return Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf-8")}:"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&(i=function(e){try{var t=URL.createObjectURL(new Blob([e],{type:"text/plain;charset=UTF-8"})),n=new XMLHttpRequest;return n.open("GET",t,!1),n.send(),n.responseText}catch(t){return r(e)}finally{t&&URL.revokeObjectURL(t)}}),n.prototype.decode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to decode: the 'stream' option is unsupported.");return e=e instanceof Uint8Array?e:e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer):new Uint8Array(e),i(e)},e.TextEncoder=t,e.TextDecoder=n}("undefined"!=typeof window?window:t);var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)};function i(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function a(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function c(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,o,(t=e[n](t)).done,t.value)}))}}}var u={exports:{}};"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,function(e){if("undefined"==typeof browser||Object.getPrototypeOf(browser)!==Object.prototype){const t="The message port closed before a response was received.",n="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",r=e=>{const r={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(r).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class o extends WeakMap{constructor(e,t){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const i=(t,n)=>(...r)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||r.length<=1&&!1!==n.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},a=e=>1==e?"argument":"arguments",s=(e,t)=>function(n,...r){if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${a(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${a(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((o,a)=>{if(t.fallbackToNoCallback)try{n[e](...r,i({resolve:o,reject:a},t))}catch(a){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,a),n[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,o()}else t.noCallback?(n[e](...r),o()):n[e](...r,i({resolve:o,reject:a},t))}))},c=(e,t,n)=>new Proxy(t,{apply:(t,r,o)=>n.call(r,e,...o)});let u=Function.call.bind(Object.prototype.hasOwnProperty);const l=(e,t={},n={})=>{let r=Object.create(null),o={has:(t,n)=>n in e||n in r,get(o,i,a){if(i in r)return r[i];if(!(i in e))return;let h=e[i];if("function"==typeof h)if("function"==typeof t[i])h=c(e,e[i],t[i]);else if(u(n,i)){let t=s(i,n[i]);h=c(e,e[i],t)}else h=h.bind(e);else if("object"==typeof h&&null!==h&&(u(t,i)||u(n,i)))h=l(h,t[i],n[i]);else{if(!u(n,"*"))return Object.defineProperty(r,i,{configurable:!0,enumerable:!0,get:()=>e[i],set(t){e[i]=t}}),h;h=l(h,t[i],n["*"])}return r[i]=h,h},set:(t,n,o,i)=>(n in r?r[n]=o:e[n]=o,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(r,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)},i=Object.create(e);return new Proxy(i,o)},h=e=>({addListener(t,n,...r){t.addListener(e.get(n),...r)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),f=new o((e=>"function"!=typeof e?e:function(t){const n=l(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)}));let d=!1;const p=new o((e=>"function"!=typeof e?e:function(t,r,o){let i,a,s=!1,c=new Promise((e=>{i=function(t){d||(console.warn(n,(new Error).stack),d=!0),s=!0,e(t)}}));try{a=e(t,r,i)}catch(e){a=Promise.reject(e)}const u=!0!==a&&(e=>e&&"object"==typeof e&&"function"==typeof e.then)(a);if(!0!==a&&!u&&!s)return!1;return(e=>{e.then((e=>{o(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",o({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)}))})(u?a:c),!0})),m=({reject:n,resolve:r},o)=>{e.runtime.lastError?e.runtime.lastError.message===t?r():n(new Error(e.runtime.lastError.message)):o&&o.__mozWebExtensionPolyfillReject__?n(new Error(o.message)):r(o)},g=(e,t,n,...r)=>{if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${a(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${a(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,t)=>{const o=m.bind(null,{resolve:e,reject:t});r.push(o),n.sendMessage(...r)}))},y={devtools:{network:{onRequestFinished:h(f)}},runtime:{onMessage:h(p),onMessageExternal:h(p),sendMessage:g.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:g.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},v={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return r.privacy={network:{"*":v},services:{"*":v},websites:{"*":v}},l(e,y,r)};if("object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");e.exports=r(chrome)}else e.exports=browser}(u);var l=u.exports,h=function(){function e(){var e=this;this.locked=new Map,this.addToLocked=function(t,n){var r=e.locked.get(t);void 0===r?void 0===n?e.locked.set(t,[]):e.locked.set(t,[n]):void 0!==n&&(r.unshift(n),e.locked.set(t,r))},this.isLocked=function(t){return e.locked.has(t)},this.lock=function(t){return new Promise((function(n,r){e.isLocked(t)?e.addToLocked(t,n):(e.addToLocked(t),n())}))},this.unlock=function(t){var n=e.locked.get(t);if(void 0!==n&&0!==n.length){var r=n.pop();e.locked.set(t,n),void 0!==r&&setTimeout(r,0)}else e.locked.delete(t)}}return e.getInstance=function(){return void 0===e.instance&&(e.instance=new e),e.instance},e}();function f(){return h.getInstance()}var d=function(){return crypto||window.msCrypto},p=function(){var e=d();return e.subtle||e.webkitSubtle},m=function(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.",n="",r=0;r<e;r++)n+=t[Math.floor(Math.random()*t.length)];return n},g=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_~.",t="";return Array.from(d().getRandomValues(new Uint8Array(43))).forEach((function(n){return t+=e[n%e.length]})),t},y=function(e){return btoa(e)},v=function(e){return Object.keys(e).filter((function(t){return void 0!==e[t]})).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")},b=function(e){return a(void 0,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,p().digest({name:"SHA-256"},(new TextEncoder).encode(e))];case 1:return[2,t.sent()]}}))}))},w=function(e){return function(e){return decodeURIComponent((t=e,atob(t)).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));var t}(e.replace(/_/g,"/").replace(/-/g,"+"))},x=function(e){var t=new Uint8Array(e);return function(e){var t={"+":"-","/":"_","=":""};return e.replace(/[+/=]/g,(function(e){return t[e]}))}(y(String.fromCharCode.apply(String,Array.from(t))))},k=function(e){return new Promise((function(t){return setTimeout(t,e)}))},_=function(){function e(){this.waiters=void 0,this.acquiredIatSet=new Set,this.id=Date.now().toString()+m(15),void 0===this.waiters&&(this.waiters=[])}return e.prototype.acquireLock=function(e,t){return void 0===t&&(t=5e3),a(this,void 0,void 0,(function(){var n,r,o,i,a;return s(this,(function(s){switch(s.label){case 0:n=Date.now()+m(4),r=Date.now()+t,o="".concat("auth0-web-extension-lock-key","::").concat(e),s.label=1;case 1:return Date.now()<r?[4,k(30)]:[3,11];case 2:return s.sent(),[4,this.hasKey(o)];case 3:return s.sent()?[4,this.lockCorrector()]:[3,6];case 4:return s.sent(),[4,this.waitForSomethingToChange(r)];case 5:return s.sent(),[3,10];case 6:return[4,this.setItem(o,JSON.stringify({id:this.id,iat:n,timeUpdated:Date.now()}))];case 7:return s.sent(),[4,k(30)];case 8:return s.sent(),[4,this.getItem(o)];case 9:if(null!==(i=s.sent())&&(a=JSON.parse(i)).id===this.id&&a.iat===n)return this.acquiredIatSet.add(n),this.refreshLock(e,n),[2,!0];s.label=10;case 10:return n=Date.now()+m(4),[3,1];case 11:return[2,!1]}}))}))},e.prototype.releaseLock=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return s(this,(function(o){switch(o.label){case 0:return t="".concat("auth0-web-extension-lock-key","::").concat(e),[4,this.getItem(t)];case 1:return null===(n=o.sent())?[2]:(r=JSON.parse(n)).id!==this.id?[3,4]:[4,f().lock(r.iat)];case 2:return o.sent(),this.acquiredIatSet.delete(r.iat),[4,this.removeItem(t)];case 3:o.sent(),f().unlock(r.iat),this.notifyWaiters(),o.label=4;case 4:return[2]}}))}))},e.prototype.refreshLock=function(e,t){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){return setTimeout((function(){return a(n,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return[4,f().lock(t)];case 1:return o.sent(),this.acquiredIatSet.has(t)?[4,this.getItem(e)]:(f().unlock(t),[2]);case 2:return null===(n=o.sent())?[3,4]:((r=JSON.parse(n)).timeUpdated=Date.now(),[4,this.setItem(e,JSON.stringify(r))]);case 3:return o.sent(),f().unlock(t),[3,5];case 4:return f().unlock(t),[2];case 5:return this.refreshLock(e,t),[2]}}))}))}),1e3),[2]}))}))},e.prototype.lockCorrector=function(){var e,t;return a(this,void 0,void 0,(function(){var n,r,o,i,a,u,l,h;return s(this,(function(s){switch(s.label){case 0:return n=Date.now()-5e3,[4,this.allKeys()];case 1:r=s.sent(),o=!1,s.label=2;case 2:s.trys.push([2,8,9,14]),i=c(r),s.label=3;case 3:return[4,i.next()];case 4:return(a=s.sent()).done?[3,7]:(u=a.value).includes("auth0-web-extension-lock-key")?[4,this.getItem(u)]:[3,6];case 5:null!==(l=s.sent())&&JSON.parse(l).timeUpdated<n&&(this.removeItem(u),o=!0),s.label=6;case 6:return[3,3];case 7:return[3,14];case 8:return h=s.sent(),e={error:h},[3,14];case 9:return s.trys.push([9,,12,13]),a&&!a.done&&(t=i.return)?[4,t.call(i)]:[3,11];case 10:s.sent(),s.label=11;case 11:return[3,13];case 12:if(e)throw e.error;return[7];case 13:return[7];case 14:return o&&this.notifyWaiters(),[2]}}))}))},e.prototype.waitForSomethingToChange=function(e){return a(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n){var r=!1,o=Date.now(),i=!1,a=function(){if(i||(l.storage.onChanged.removeListener(a),t.removeFromWaiting(a),clearTimeout(s),i=!0),!r){r=!0;var e=50-(Date.now()-o);e>0?setTimeout(n,e):n()}};l.storage.onChanged.addListener(a),t.addToWaiting(a);var s=setTimeout(a,Math.max(0,e-Date.now()))}))];case 1:return n.sent(),[2]}}))}))},e.prototype.addToWaiting=function(e){this.removeFromWaiting(e),void 0!==this.waiters&&this.waiters.push(e)},e.prototype.removeFromWaiting=function(e){void 0!==this.waiters&&(this.waiters=this.waiters.filter((function(t){return t!==e})))},e.prototype.notifyWaiters=function(){void 0!==this.waiters&&function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([],this.waiters,!0).forEach((function(e){return e()}))},e.prototype.allKeys=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,l.storage.local.get(null)];case 1:return e=t.sent(),[2,Object.keys(e)]}}))}))},e.prototype.hasKey=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return[4,l.storage.local.get(e)];case 1:return t=n.sent(),[2,Boolean(null==t?void 0:t[e])]}}))}))},e.prototype.setItem=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return[4,l.storage.local.set((n={},n[e]=t,n))];case 1:return[2,r.sent()]}}))}))},e.prototype.getItem=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return[4,l.storage.local.get(e)];case 1:return[2,(null==(t=n.sent())?void 0:t[e])||null]}}))}))},e.prototype.removeItem=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,l.storage.local.remove(e)];case 1:return[2,t.sent()]}}))}))},e}(),A=function(){function e(){}return e.prototype.sendTabMessage=function(e,t){var n=o(o({},t),{source:"auth0-web-extension"});return l.tabs.sendMessage(e,n)},e.prototype.sendRuntimeMessage=function(e){var t=o(o({},e),{source:"auth0-web-extension"});return l.runtime.sendMessage(void 0,t)},e.prototype.addMessageListener=function(e){l.runtime.onMessage.addListener((function(t,n){if("auth0-web-extension"===t.source)return e(t,n)}))},e}(),E=function(){function e(e,t){this.storage=e,this.clientId=t,this.storageKey="".concat("a0.webext.txs",".").concat(this.clientId),this.transaction=this.storage.get(this.storageKey)}return e.prototype.create=function(e){this.transaction=e,this.storage.save(this.storageKey,e,{daysUntilExpire:1})},e.prototype.get=function(){return this.transaction},e.prototype.remove=function(){delete this.transaction,this.storage.remove(this.storageKey)},e}(),S=["login_required","consent_required","interaction_required","account_selection_required","access_denied"],O=function(){return Date.now()},T=function(e){function t(n,r){var o=e.call(this,r)||this;return o.error=n,o.error_description=r,Object.setPrototypeOf(o,t.prototype),o}return r(t,e),t.fromPayload=function(e){return new t(e.error,e.error_description)},t}(Error),j=function(e){function t(n,r,o,i){void 0===i&&(i=null);var a=e.call(this,n,r)||this;return a.state=o,a.appState=i,Object.setPrototypeOf(a,t.prototype),a}return r(t,e),t}(T),P=function(e){function t(){var n=e.call(this,"timeout","Timeout")||this;return Object.setPrototypeOf(n,t.prototype),n}return r(t,e),t}(T),L=function(e){function t(n,r,o){var i=e.call(this,n,r)||this;return i.mfa_token=o,Object.setPrototypeOf(i,t.prototype),i}return r(t,e),t}(T),I=function(e,t){return a(void 0,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return[4,fetch(e,t)];case 1:return n=o.sent(),r={ok:n.ok},[4,n.json()];case 2:return[2,(r.json=o.sent(),r)]}}))}))},D=function(e,t,n){return void 0===n&&(n=1e4),a(void 0,void 0,void 0,(function(){var r,o;return s(this,(function(i){return r=new AbortController,t.signal=r.signal,[2,Promise.race([I(e,t),new Promise((function(e,t){o=setTimeout((function(){r.abort(),t(new Error("Timeout when executing 'fetch'"))}),n)}))]).finally((function(){clearTimeout(o)}))]}))}))};function C(e,t,n){return a(this,void 0,void 0,(function(){var r,o,a,c,u,l,h,f,d;return s(this,(function(s){switch(s.label){case 0:r=null,a=0,s.label=1;case 1:if(!(a<3))return[3,6];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,D(e,t,n)];case 3:return o=s.sent(),r=null,[3,6];case 4:return c=s.sent(),r=c,[3,5];case 5:return a++,[3,1];case 6:if(r)throw r.message=r.message||"Failed to fetch",r;if(u=o.json,l=u.error,h=u.error_description,f=i(u,["error","error_description"]),!o.ok){if(d=h||"HTTP error. Unable to fetch ".concat(e),"mfa_required"===l)throw new L(l,d,f.mfa_token);throw new T(l||"request_error",d)}return[2,f]}}))}))}function M(e){var t=e.baseUrl,n=e.timeout;e.audience,e.scope;var r=e.useFormData,o=i(e,["baseUrl","timeout","audience","scope","useFormData"]);return a(this,void 0,void 0,(function(){var e;return s(this,(function(i){switch(i.label){case 0:return e=r?v(o):JSON.stringify(o),[4,C("".concat(t,"/oauth/token"),{method:"POST",body:e,headers:{"Content-Type":r?"application/x-www-form-urlencoded":"application/json"}},n)];case 1:return[2,i.sent()]}}))}))}var F,K=function(e){return"number"==typeof e},N=["iss","aud","exp","nbf","iat","jti","azp","nonce","auth_time","at_hash","c_hash","acr","amr","sub_jwk","cnf","sip_from_tag","sip_date","sip_callid","sip_cseq_num","sip_via_branch","orig","dest","mky","events","toe","txn","rph","sid","vot","vtm"],R=function(e){if(!e.id_token)throw new Error("ID token is required but missing");var t=function(e){var t=e.split("."),n=t[0],r=t[1],o=t[2];if(3!==t.length||!n||!r||!o)throw new Error("ID token could not be decoded");var i=JSON.parse(w(r)),a={__raw:e},s={};return Object.keys(i).forEach((function(e){a[e]=i[e],N.includes(e)||(s[e]=i[e])})),{encoded:{header:n,payload:r,signature:o},header:JSON.parse(w(n)),claims:a,user:s}}(e.id_token);if(!t.claims.iss)throw new Error("Issuer (iss) claim must be a string present in the ID token");if(t.claims.iss!==e.iss)throw new Error('Issuer (iss) claim mismatch in the ID token; expected "'.concat(e.iss,'", found "').concat(t.claims.iss,'"'));if(!t.user.sub)throw new Error("Subject (sub) claim must be a string present in the ID token");if("RS256"!==t.header.alg)throw new Error('Signature algorithm of "'.concat(t.header.alg,'" is not supported. Expected the ID token to be signed with "RS256".'));if(!t.claims.aud||"string"!=typeof t.claims.aud&&!Array.isArray(t.claims.aud))throw new Error("Audience (aud) claim must be a string or array of strings present in the ID token");if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e.aud))throw new Error('Audience (aud) claim mismatch in the ID token; expected "'.concat(e.aud,'" but was not one of "').concat(t.claims.aud.join(", "),'"'));if(t.claims.aud.length>1){if(!t.claims.azp)throw new Error("Authorized Party (azp) claim must be a string present in the ID token when Audience (aud) claim has multiple values");if(t.claims.azp!==e.aud)throw new Error('Authorized Party (azp) claim mismatch in the ID token; expected "'.concat(e.aud,'", found "').concat(t.claims.azp,'"'))}}else if(t.claims.aud!==e.aud)throw new Error('Audience (aud) claim mismatch in the ID token; expected "'.concat(e.aud,'" but found "').concat(t.claims.aud,'"'));if(e.nonce){if(!t.claims.nonce)throw new Error("Nonce (nonce) claim must be a string present in the ID token");if(t.claims.nonce!==e.nonce)throw new Error('Nonce (nonce) claim mismatch in the ID token; expected "'.concat(e.nonce,'", found "').concat(t.claims.nonce,'"'))}if(e.max_age&&!K(t.claims.auth_time))throw new Error("Authentication Time (auth_time) claim must be a number present in the ID token when Max Age (max_age) is specified");if(!K(t.claims.exp))throw new Error("Expiration Time (exp) claim must be a number present in the ID token");if(!K(t.claims.iat))throw new Error("Issued At (iat) claim must be a number present in the ID token");var n=e.leeway||60,r=new Date(e.now||Date.now()),o=new Date(0),i=new Date(0),a=new Date(0);if(a.setUTCSeconds(parseInt(t.claims.auth_time)+e.max_age+n),o.setUTCSeconds(t.claims.exp+n),i.setUTCSeconds(t.claims.nbf-n),r>o)throw new Error("Expiration Time (exp) claim error in the ID token; current time (".concat(r,") is after expiration time (").concat(o,")"));if(K(t.claims.nbf)&&r<i)throw new Error("Not Before time (nbf) claim in the ID token indicates that this token can't be used just yet. Currrent time (".concat(r,") is before ").concat(i));if(K(t.claims.auth_time)&&r>a)throw new Error("Authentication Time (auth_time) claim in the ID token indicates that too much time has passed since the last end-user authentication. Currrent time (".concat(r,") is after last auth at ").concat(a));if(e.organizationId){if(!t.claims.org_id)throw new Error("Organization ID (org_id) claim must be a string present in the ID token");if(e.organizationId!==t.claims.org_id)throw new Error('Organization ID (org_id) claim mismatch in the ID token; expected "'.concat(e.organizationId,'", found "').concat(t.claims.org_id,'"'))}return t},B=function(e){return Array.from(new Set(e))},q=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return B(e.filter(Boolean).join(" ").trim().split(/\s+/)).join(" ")},z=function(){function e(){this.storage={}}return e.prototype.get=function(e){var t=this.storage[e];if(void 0!==t)return JSON.parse(t)},e.prototype.save=function(e,t){this.storage[e]=JSON.stringify(t)},e.prototype.remove=function(e){delete this.storage[e]},e}(),U=function(){var e;this.enclosedCache=(e={},{set:function(t,n){e[t]=n},get:function(t){return e[t]||null},remove:function(t){delete e[t]},allKeys:function(){return Object.keys(e)}})},G=function(){function e(e,t){void 0===t&&(t="@@auth0webext@@"),this.prefix=t,this.client_id=e.client_id,this.scope=e.scope,this.audience=e.audience}return e.prototype.toKey=function(){return"".concat(this.prefix,"::").concat(this.client_id,"::").concat(this.audience,"::").concat(this.scope)},e.fromKey=function(t){var n=t.split("::"),r=n[0],o=n[1],i=n[2],a=n[3];return r&&o&&a&&i?new e({client_id:o,scope:a,audience:i},r):null},e.fromCacheEntry=function(t){return new e({scope:t.scope,audience:t.audience,client_id:t.client_id})},e}(),W=function(){function e(e,t,n){this.cache=e,t&&(this.keyManifest=t),this.nowProvider=n||O}return e.prototype.get=function(e,t){var n;return void 0===t&&(t=0),a(this,void 0,void 0,(function(){var r,o,i,a,c;return s(this,(function(s){switch(s.label){case 0:return[4,this.cache.get(e.toKey())];case 1:return(r=s.sent())?[3,4]:[4,this.getCacheKeys()];case 2:return(o=s.sent())&&(i=this.matchExistingCacheKey(e,o))?[4,this.cache.get(i)]:[2];case 3:r=s.sent(),s.label=4;case 4:return r?[4,this.nowProvider()]:[2];case 5:return a=s.sent(),c=Math.floor(a/1e3),r.expiresAt-t<c?r.body.refresh_token?(r.body={refresh_token:r.body.refresh_token},[4,this.cache.set(e.toKey(),r)]):[3,7]:[3,10];case 6:return s.sent(),[2,r.body];case 7:return[4,this.cache.remove(e.toKey())];case 8:return s.sent(),[4,null===(n=this.keyManifest)||void 0===n?void 0:n.remove(e.toKey())];case 9:return s.sent(),[2];case 10:return[2,r.body]}}))}))},e.prototype.set=function(e){var t;return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return n=new G({client_id:e.client_id,scope:e.scope,audience:e.audience}),[4,this.wrapCacheEntry(e)];case 1:return r=o.sent(),[4,this.cache.set(n.toKey(),r)];case 2:return o.sent(),[4,null===(t=this.keyManifest)||void 0===t?void 0:t.add(n.toKey())];case 3:return o.sent(),[2]}}))}))},e.prototype.clear=function(e){var t;return a(this,void 0,void 0,(function(){var n,r=this;return s(this,(function(o){switch(o.label){case 0:return[4,this.getCacheKeys()];case 1:return(n=o.sent())?[4,n.filter((function(t){return!e||t.includes(e)})).reduce((function(e,t){return a(r,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,e];case 1:return n.sent(),[4,this.cache.remove(t)];case 2:return n.sent(),[2]}}))}))}),Promise.resolve())]:[2];case 2:return o.sent(),[4,null===(t=this.keyManifest)||void 0===t?void 0:t.clear()];case 3:return o.sent(),[2]}}))}))},e.prototype.clearSync=function(e){var t,n,r=this,o=null===(n=(t=this.cache).allKeys)||void 0===n?void 0:n.call(t);o&&o.filter((function(t){return!e||t.includes(e)})).forEach((function(e){r.cache.remove(e)}))},e.prototype.wrapCacheEntry=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return s(this,(function(o){switch(o.label){case 0:return[4,this.nowProvider()];case 1:return t=o.sent(),n=Math.floor(t/1e3)+e.expires_in,r=Math.min(n,e.decodedToken.claims.exp),[2,{body:e,expiresAt:r}]}}))}))},e.prototype.getCacheKeys=function(){var e,t;return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return this.keyManifest?[4,this.keyManifest.get()]:[3,2];case 1:return[2,(n.sent()||{}).keys||[]];case 2:return[4,null===(t=(e=this.cache).allKeys)||void 0===t?void 0:t.call(e)];case 3:return[2,n.sent()||[]]}}))}))},e.prototype.matchExistingCacheKey=function(e,t){return t.filter((function(t){var n=G.fromKey(t),r=new Set((null==n?void 0:n.scope)&&n.scope.split(" ")),o=e.scope.split(" "),i=(null==n?void 0:n.scope)&&o.reduce((function(e,t){return e&&r.has(t)}),!0);return"@@auth0webext@@"===(null==n?void 0:n.prefix)&&n.client_id===e.client_id&&n.audience===e.audience&&i}))[0]},e}(),$=function(){function e(e,t){this.cache=e,this.clientId=t,this.manifestKey=this.createManifestKeyFrom(this.clientId)}return e.prototype.add=function(e){var t;return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(o){switch(o.label){case 0:return r=Set.bind,[4,this.cache.get(this.manifestKey)];case 1:return(n=new(r.apply(Set,[void 0,(null===(t=o.sent())||void 0===t?void 0:t.keys)||[]]))).add(e),[4,this.cache.set(this.manifestKey,{keys:Array.from(n.values())})];case 2:return o.sent(),[2]}}))}))},e.prototype.remove=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return[4,this.cache.get(this.manifestKey)];case 1:return(t=r.sent())?((n=new Set(t.keys)).delete(e),n.size>0?[4,this.cache.set(this.manifestKey,{keys:Array.from(n.values())})]:[3,3]):[3,5];case 2:case 4:return[2,r.sent()];case 3:return[4,this.cache.remove(this.manifestKey)];case 5:return[2]}}))}))},e.prototype.get=function(){return this.cache.get(this.manifestKey)},e.prototype.clear=function(){return this.cache.remove(this.manifestKey)},e.prototype.createManifestKeyFrom=function(e){return"".concat("@@auth0webext@@","::").concat(e)},e}(),J={},V=function(e,t,n){void 0===n&&(n=!1),console.log("[auth0-web-extension] singlePromise() key",t);var r=J[t];return n||r?n&&(r=e()):(console.log("[auth0-web-extension] singlePromise() there is no promise"),r=e().finally((function(){console.log("[auth0-web-extension] singlePromise() completing finally"),delete J[t],r=void 0})),J[t]=r),r},Y=function(e,t){return void 0===t&&(t=3),a(void 0,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:n=0,r.label=1;case 1:return n<t?[4,e()]:[3,4];case 2:if(r.sent())return[2,!0];r.label=3;case 3:return n++,[3,1];case 4:return[2,!1]}}))}))},H=new _,Q=function(){function e(e){var t,n,r,o=this;if(this.options=e,this.options.debug&&console.log("[auth0-web-extension] - constructor"),function(){if(!d())throw new Error("For security reasons, `window.crypto` is required to run `auth0-web-extension`.");if(void 0===p())throw new Error("\n      auth0-web-extension must run on a secure origin.\n    ")}(),e.cache&&e.cacheLocation&&console.warn("Both `cache` and `cacheLocation` options have been specified in the Auth0Client configuration; ignoring `cacheLocation` and using `cache`."),e.cache)r=e.cache,this.cacheLocation="memory";else{this.cacheLocation=e.cacheLocation||"memory";var i=te(this.cacheLocation);if(!i)throw new Error('Invalid cache location "'.concat(this.cacheLocation,'"'));r=i()}var a=new z;this.transactionManager=new E(a,this.options.client_id),this.messenger=new A,this.scope=this.options.scope,this.nowProvider=this.options.nowProvider||O,this.cacheManager=new W(r,r.allKeys?null:new $(r,this.options.client_id),this.nowProvider),this.options.debug&&console.log("[auth0-web-extension] - Auth0Client constructor, getting domainUrl"),this.domainUrl=X(this.options.domain),this.tokenIssuer=ne(this.options.issuer,this.domainUrl),this.defaultScope=q("openid",void 0!==(null===(n=null===(t=this.options)||void 0===t?void 0:t.advancedOptions)||void 0===n?void 0:n.defaultScope)?this.options.advancedOptions.defaultScope:"openid profile email"),this.options.useRefreshTokens,this.customOptions=re(e),this.options.debug&&console.log("[auth0-web-extension] - Ading message listener to this"),this.messenger.addMessageListener((function(e,t){var n,r;switch(o.options.debug&&console.log("[auth0-web-extension] - Message recieved",e),e.type){case"auth-result":return(null===(n=t.tab)||void 0===n?void 0:n.id)&&o.messenger.sendTabMessage(t.tab.id,{type:"auth-cleanup"}),o.options.debug&&console.log("[auth0-web-extension] Received authentication result back, cleaning up..."),new Promise((function(t){o._handleAuthorizeResponse(e.payload).then((function(){return t()}))}));case"auth-error":return null==(i=o.transactionManager.get())||i.errorCallback(e.error),(null===(r=t.tab)||void 0===r?void 0:r.id)&&o.messenger.sendTabMessage(t.tab.id,{type:"auth-cleanup"}),Promise.resolve();case"auth-params":var i=o.transactionManager.get();return o.options.debug&&console.log("[auth0-web-extension] Sending authorize url to content script: ",i),i?Promise.resolve({authorizeUrl:i.authorizeUrl,domainUrl:i.domainUrl}):Promise.resolve();default:throw new Error("Invalid message type ".concat(e.type))}})),this.options.debug&&console.log("[auth0-web-extension] - finished adding message listener")}return e.prototype._url=function(e){return"".concat(this.domainUrl).concat(e)},e.prototype._getParams=function(e,t,n,r,a){var s=this.options;s.useRefreshTokens,s.useCookiesForTransactions,s.useFormData,s.auth0Client,s.cacheLocation,s.advancedOptions,s.detailedResponse,s.nowProvider,s.authorizeTimeoutInSeconds,s.legacySameSiteCookie,s.sessionCheckExpiryDays,s.domain,s.leeway;var c=i(s,["useRefreshTokens","useCookiesForTransactions","useFormData","auth0Client","cacheLocation","advancedOptions","detailedResponse","nowProvider","authorizeTimeoutInSeconds","legacySameSiteCookie","sessionCheckExpiryDays","domain","leeway"]);return o(o(o({},c),e),{scope:q(this.defaultScope,this.scope,e.scope),response_type:"code",response_mode:"query",state:t,nonce:n,redirect_uri:a||this.options.redirect_uri,code_challenge:r,code_challenge_method:"S256"})},e.prototype._authorizeUrl=function(e){return this._url("/authorize?".concat(v(e)))},e.prototype.getUser=function(e){var t;return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var n,r,o,i;return s(this,(function(a){switch(a.label){case 0:return this.options.debug&&console.log("[auth0-web-extension] - getUser"),n=e.audience||this.options.audience||"default",r=q(this.defaultScope,this.scope,e.scope),o=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60,this.options.debug&&console.log("[auth0-web-extension] - checking session"),[4,this.checkSession({audience:n,scope:r,timeoutInSeconds:o})];case 1:return a.sent(),[4,this.cacheManager.get(new G({client_id:this.options.client_id,audience:n,scope:r}))];case 2:return i=a.sent(),[2,null===(t=null==i?void 0:i.decodedToken)||void 0===t?void 0:t.user]}}))}))},e.prototype.getIdTokenClaims=function(e){var t;return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var n,r,o;return s(this,(function(i){switch(i.label){case 0:return n=e.audience||this.options.audience||"default",r=q(this.defaultScope,this.scope,e.scope),this.options.debug&&console.log("[auth0-web-extension] - checking session"),[4,this.checkSession({audience:n,scope:r})];case 1:return i.sent(),[4,this.cacheManager.get(new G({client_id:this.options.client_id,audience:n,scope:r}))];case 2:return o=i.sent(),[2,null===(t=null==o?void 0:o.decodedToken)||void 0===t?void 0:t.claims]}}))}))},e.prototype.loginWithNewTab=function(e){return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var t,n,r,o,c,u,h,f,d,p,m,v,w=this;return s(this,(function(k){switch(k.label){case 0:return t=e.redirect_uri,n=e.appState,r=i(e,["redirect_uri","appState"]),o=y(g()),c=y(g()),u=g(),[4,b(u)];case 1:return h=k.sent(),f=x(h),d=e.fragment?"#".concat(e.fragment):"",p=this._getParams(r,o,c,f,t),m=this._authorizeUrl(p),v=m+d,[4,Y((function(){return H.acquireLock("auth0.lock.getTokenSilently",5e3)}),10)];case 2:if(!k.sent())return[3,8];k.label=3;case 3:return k.trys.push([3,,5,7]),[4,new Promise((function(e,t){return a(w,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return this.transactionManager.create({authorizeUrl:v,domainUrl:this.domainUrl,nonce:c,code_verifier:u,appState:n,scope:p.scope,audience:p.audience||"default",redirect_uri:p.redirect_uri,state:o,callback:e,errorCallback:t}),[4,l.tabs.create({url:m})];case 1:return r.sent(),[2]}}))}))}))];case 4:return k.sent(),[3,7];case 5:return[4,H.releaseLock("auth0.lock.getTokenSilently")];case 6:return k.sent(),this.options.debug&&console.log("[auth0-web-extension] - lock released"),[7];case 7:return[3,9];case 8:throw new P;case 9:return[2]}}))}))},e.prototype.loginWithPopup=function(e,t){return a(this,void 0,void 0,(function(){var t,n,r,c,u,h,f,d,p,m,v=this;return s(this,(function(w){switch(w.label){case 0:return t=i(e=e||{},[]),n=y(g()),r=y(g()),c=g(),[4,b(c)];case 1:return u=w.sent(),h=x(u),f=this._getParams(t,n,r,h,this.options.redirect_uri),d=this._authorizeUrl(o(o({},f),{response_mode:"query"})),p=400,m=600,[4,Y((function(){return H.acquireLock("auth0.lock.getTokenSilently",5e3)}),10)];case 2:if(!w.sent())return[3,7];w.label=3;case 3:return w.trys.push([3,,4,6]),[2,new Promise((function(e,t){return a(v,void 0,void 0,(function(){var o,i;return s(this,(function(a){switch(a.label){case 0:return[4,l.windows.create({width:p,height:m,type:"popup",url:d})];case 1:return o=a.sent(),i=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];o.id&&l.windows.remove(o.id),e(t)}},this.transactionManager.create({authorizeUrl:d,domainUrl:this.domainUrl,nonce:r,code_verifier:c,scope:f.scope,audience:f.audience||"default",redirect_uri:f.redirect_uri,state:n,callback:i(e),errorCallback:i(t)}),[2]}}))}))}))];case 4:return[4,H.releaseLock("auth0.lock.getTokenSilently")];case 5:return w.sent(),this.options.debug&&console.log("[auth0-web-extension] - lock released"),[7];case 6:return[3,8];case 7:throw new P;case 8:return[2]}}))}))},e.prototype._handleAuthorizeResponse=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,a,c,u,l,h,f;return s(this,(function(s){switch(s.label){case 0:if(s.trys.push([0,4,5,6]),t=e.error,n=void 0===t?"":t,r=e.error_description,i=void 0===r?"":r,a=e.state,c=e.code,!(f=this.transactionManager.get()))throw new Error("Invalid state");if(this.options.debug&&console.log("[auth0-web-extension] Unregistering current transaction"),e.error)throw new j(n,i,e.state,f.appState);if(!f.code_verifier||f.state&&f.state!==a)throw new Error("Invalid state");return[4,M(o(o({},this.customOptions),{audience:f.audience,scope:f.scope,redirect_uri:f.redirect_uri||this.options.redirect_uri,baseUrl:this.domainUrl,client_id:this.options.client_id,code_verifier:f.code_verifier,grant_type:"authorization_code",code:c,useFormData:this.options.useFormData}))];case 1:return u=s.sent(),this.options.debug&&console.log("[auth0-web-extension] Received token using code and verifier"),[4,this._verifyIdToken(u.id_token,f.nonce)];case 2:return l=s.sent(),[4,this.cacheManager.set(o(o(o(o({},u),{decodedToken:l,audience:f.audience,scope:f.scope}),u.scope?{oauthTokenScope:u.scope}:null),{client_id:this.options.client_id}))];case 3:return s.sent(),this.options.debug&&console.log("[auth0-web-extension] Stored token in cache"),f.callback(o(o({},u),{decodedToken:l,scope:f.scope,oauthTokenScope:f.scope,audience:f.audience})),[3,6];case 4:return h=s.sent(),null==(f=this.transactionManager.get())||f.errorCallback(h),[3,6];case 5:return this.transactionManager.remove(),[7];case 6:return[2]}}))}))},e.prototype.isAuthenticated=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return this.options.debug&&console.log("[auth0-web-extension] - isAuthenticated"),[4,this.getUser()];case 1:return e=t.sent(),[2,Boolean(e)]}}))}))},e.prototype.checkSession=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getTokenSilently(e)];case 1:return n.sent(),[3,3];case 2:if(t=n.sent(),!S.includes(t.error))throw t;return[3,3];case 3:return[2]}}))}))},e.prototype.getTokenSilently=function(e){return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){return this.options.debug&&console.log("[auth0-web-extension] - prepare getTokenSilently"),[2,V((function(){return t._getTokenSilently(o(o({audience:t.options.audience,ignoreCache:!1},e),{scope:q(t.defaultScope,t.scope,e.scope)}))}),"".concat(this.options.client_id,"::").concat(this.options.audience,"::").concat(q(this.defaultScope,this.scope,e.scope)),!0)]}))}))},e.prototype._getTokenSilently=function(e){return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var t,n,r,a,c,u,l,h,f,d,p,m,g;return s(this,(function(s){switch(s.label){case 0:return this.options.debug&&console.log("[auth0-web-extension] - getTokenSilently"),t=e.ignoreCache,n=i(e,["ignoreCache"]),t||!n.scope?[3,2]:[4,this._getEntryFromCache({scope:n.scope,audience:n.audience||"default",client_id:this.options.client_id,getDetailedEntry:e.detailedResponse})];case 1:if(r=s.sent())return this.options.debug&&console.log("[auth0-web-extension] - cache hit! returning token"),[2,r];this.options.debug&&console.log("[auth0-web-extension] - no cache hit, continuing"),s.label=2;case 2:return this.options.debug&&console.log("[auth0-web-extension] - waiting for lock"),[4,Y((function(){return H.acquireLock("auth0.lock.getTokenSilently",5e3)}),10)];case 3:if(!s.sent())return[3,15];this.options.debug&&console.log("[auth0-web-extension] - lock acquired!"),s.label=4;case 4:return s.trys.push([4,,12,14]),t||!n.scope?[3,6]:[4,this._getEntryFromCache({scope:n.scope,audience:n.audience||"default",client_id:this.options.client_id,getDetailedEntry:e.detailedResponse})];case 5:if(r=s.sent())return this.options.debug&&console.log("[auth0-web-extension] - cache hit! returning token"),[2,r];this.options.debug&&console.log("[auth0-web-extension] - no hit, continuing"),s.label=6;case 6:return a=e.timeoutInSeconds||this.options.authorizeTimeoutInSeconds||60,c=new Promise((function(e,t){setTimeout((function(){return t(new P)}),1e3*a)})),this.options.debug&&console.log("[auth0-web-extension] - checking auth"),h=(l=Promise).race,this.options.useRefreshTokens?[4,this._getTokenUsingRefreshToken(n)]:[3,8];case 7:return f=s.sent(),[3,10];case 8:return[4,this._getTokenFromIFrame(n)];case 9:f=s.sent(),s.label=10;case 10:return[4,h.apply(l,[[f,c]])];case 11:return u=s.sent(),this.options.debug&&console.log("[auth0-web-extension] - authResult",u),e.detailedResponse?(this.options.debug&&console.log("[auth0-web-extension] - giving detailed response"),d=u.id_token,p=u.access_token,m=u.oauthTokenScope,g=u.expires_in,[2,o(o({id_token:d,access_token:p},m?{scope:m}:null),{expires_in:g})]):[2,u.access_token];case 12:return this.options.debug&&console.log("[auth0-web-extension] - releasing lock"),[4,H.releaseLock("auth0.lock.getTokenSilently")];case 13:return s.sent(),this.options.debug&&console.log("[auth0-web-extension] - lock released"),[7];case 14:return[3,16];case 15:throw this.options.debug&&console.log("[auth0-web-extension] - timed out get token silently"),new P;case 16:return[2]}}))}))},e.prototype._getTokenUsingRefreshToken=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(e){throw"We currently don't support using refresh tokens, set useRefreshTokens to false"}))}))},e.prototype._getTokenFromIFrame=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,c,u,l,h,f,d=this;return s(this,(function(p){switch(p.label){case 0:return t=y(g()),n=y(g()),r=g(),[4,b(r)];case 1:i=p.sent(),c=x(i),this.options.debug&&console.log("[auth0-web-extension] - getTokenFromIFrame"),u=this._getParams(e,t,n,c,e.redirect_uri||this.options.redirect_uri),l=this._authorizeUrl(o(o({},u),{prompt:"none",response_mode:"web_message"})),this.options.debug&&console.log("[auth0-web-extension] - built authorize url"),p.label=2;case 2:return p.trys.push([2,5,,6]),this.options.debug&&console.log("[auth0-web-extension] - checking if current tab has content script running"),[4,(m=this._getTabId.bind(this),v=10,void 0===v&&(v=3),a(void 0,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:e=0,t.label=1;case 1:if(!(e<v))return[3,6];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,m()];case 3:return[2,t.sent()];case 4:return t.sent(),[3,5];case 5:return e++,[3,1];case 6:return[2,null]}}))})))];case 3:if(!(h=p.sent()))throw"Failed to connect to tab too many times";return[4,this.messenger.sendTabMessage(h,{type:"auth-start"})];case 4:return p.sent(),this.options.debug&&console.log("[auth0-web-extension] - sent auth-start message to content script"),[2,new Promise((function(e,o){d.transactionManager.create({authorizeUrl:l,domainUrl:d.domainUrl,nonce:n,code_verifier:r,scope:u.scope,audience:u.audience||"default",redirect_uri:u.redirect_uri,state:t,callback:e,errorCallback:o})}))];case 5:throw(f=p.sent()).error,f;case 6:return[2]}var m,v}))}))},e.prototype._getTabId=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o;return s(this,(function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),this.options.debug&&console.log("[auth0-web-extension] - checking current tab id"),e={active:!0,currentWindow:!0},[4,l.tabs.query(e)];case 1:return t=i.sent()[0],n=(t||{}).id,this.options.debug&&console.log("[auth0-web-extension] - current tab id ".concat(n)),n?[4,this.messenger.sendTabMessage(n,{type:"auth-ack"})]:[3,3];case 2:if(r=i.sent(),this.options.debug&&console.log("[auth0-web-extension] - received response from current tab",r),"ack"===r)return[2,n];throw new Error("Received invalid response on acknowledgement");case 3:this.options.debug&&console.log("[auth0-web-extension] - no current tab, waiting for one"),i.label=4;case 4:return[3,6];case 5:throw o=i.sent(),this.options.debug&&console.log("[auth0-web-extension] - ".concat(o)),o;case 6:throw"Could not access current tab."}}))}))},e.prototype._verifyIdToken=function(e,t,n){return a(this,void 0,void 0,(function(){var r;return s(this,(function(o){switch(o.label){case 0:return[4,this.nowProvider()];case 1:return r=o.sent(),[2,R({iss:this.tokenIssuer,aud:this.options.client_id,id_token:e,nonce:t,organizationId:n,leeway:this.options.leeway,max_age:Z(this.options.max_age),now:r})]}}))}))},e.prototype._getEntryFromCache=function(e){var t=e.scope,n=e.audience,r=e.client_id,i=e.getDetailedEntry,c=void 0!==i&&i;return a(this,void 0,void 0,(function(){var e,i,a,u,l;return s(this,(function(s){switch(s.label){case 0:return[4,this.cacheManager.get(new G({scope:t,audience:n,client_id:r}),60)];case 1:return(e=s.sent())&&e.access_token?c?(i=e.id_token,a=e.access_token,u=e.oauthTokenScope,l=e.expires_in,i&&l?[2,o(o({id_token:i,access_token:a},u?{scope:u}:null),{expires_in:l})]:[2,void 0]):[2,e.access_token]:[2]}}))}))},e}(),Z=function(e){return"string"!=typeof e?e:parseInt(e,10)||void 0},X=function(e){return/^https?:\/\//.test(e)?e:"https://".concat(e)},ee=((F={}).memory=function(){return(new U).enclosedCache},F),te=function(e){return ee[e]},ne=function(e,t){return e?e.startsWith("https://")?e:"https://".concat(e,"/"):"".concat(t,"/")},re=function(e){return e.advancedOptions,e.audience,e.auth0Client,e.authorizeTimeoutInSeconds,e.cacheLocation,e.client_id,e.domain,e.issuer,e.leeway,e.max_age,e.redirect_uri,e.scope,e.useRefreshTokens,e.useCookiesForTransactions,e.useFormData,i(e,["advancedOptions","audience","auth0Client","authorizeTimeoutInSeconds","cacheLocation","client_id","domain","issuer","leeway","max_age","redirect_uri","scope","useRefreshTokens","useCookiesForTransactions","useFormData"])};function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){se(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function se(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ce(e){return function(e){if(Array.isArray(e))return ue(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ue(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function le(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */le=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return E()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function h(){}function f(){}function d(){}var p={};s(p,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(A([])));g&&g!==t&&n.call(g,o)&&(p=g);var y=d.prototype=h.prototype=Object.create(p);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==oe(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=d,s(y,"constructor",d),s(d,"constructor",f),f.displayName=s(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(b.prototype),s(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new b(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function he(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function fe(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){he(i,r,o,a,s,"next",e)}function s(e){he(i,r,o,a,s,"throw",e)}a(void 0)}))}}var de={h1:"https://api.hyperwriteai.com/",a1:"https://otherside-authedflaskapi.zeet-otherside.zeet.app/",l1:"http://127.0.0.1:5000/",c1:"https://typeaheads.hyperwriteai.com/",d1:"https://hyperwrite-api-dev.herokuapp.com/",z1:"https://typeaheads.hyperwriteai.com/"},pe=de.h1,me=e.OVERRIDE_TYPEAHEAD_URL||de.z1,ge=function(){var t=fe(le().mark((function t(n){var r,o,i,a,s,c,u,l,h,f,d,p,m,g,y,v,b,w,x,k,_,A,E,S,O,T,j,P,L,I,D;return le().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.isEarlyTypeahead,o=n.typeaheadMetadata,i=n.text,a=n.title,s=void 0===a?"Email":a,c=n.description,u=void 0===c?"Email":c,l=n.history,h=n.priorText,f=n.email,d=void 0===f?"":f,p=n.doSpeedy,m=n.app,g=void 0===m?"":m,y=n.history_format,v=void 0===y?"":y,b=n.metadata,w=void 0===b?{}:b,x=n.temperature,k=n.gens,_=n.tokens,A=n.reason,E=void 0===A?"":A,S=n.similarSnippets,O=void 0===S?[]:S,T=new FormData,t.next=4,Ai();case 4:return j=t.sent,T.append("writing",i),T.append("title",s),T.append("description",u),T.append("snippets",JSON.stringify(O)),null!=o&&o.history&&(o.history=[].concat(ce(o.history),[{time:(new Date).getTime(),function:"api_leaving_getTypeAheads",timeTaken:(new Date).getTime()-o.history.slice(-1)[0].time}])),T.append("typeaheadMetadata",JSON.stringify(o)),T.append("website","Superhuman"),T.append("withScores","true"),r&&T.append("isEarlyTypeahead","true"),l&&T.append("history",JSON.stringify(l)),h&&T.append("priorText",h),p&&T.append("doSpeedy",p),g&&T.append("app",g),v&&T.append("history_format",v),w&&T.append("metadata",JSON.stringify(w)),x&&T.append("temperature",x),k&&T.append("gens",k),_&&T.append("tokens",_),E&&T.append("reason",E),T.append("allowPartial","true"),T.append("version","0.0.3"),P={method:"POST",body:T,redirect:"follow",headers:{Authorization:"Bearer ".concat(j)}},L=(new Date).getTime(),t.next=30,fetch(me+"/typeaheadnsorted",P).then((function(e){return e.json()})).catch((function(e){return["Error generating typeahead"]}));case 30:return I=t.sent,d.endsWith("@othersideai.com")&&(D=(new Date).getTime(),D-L),I.setEndpoint&&(C=I.setEndpoint,M=void 0,(M=de[C])&&(me=M),e.OVERRIDE_TYPEAHEAD_URL&&(pe=e.OVERRIDE_TYPEAHEAD_URL)),t.abrupt("return",I);case 34:case"end":return t.stop()}var C,M}),t)})));return function(e){return t.apply(this,arguments)}}();var ye=function(){var e=fe(le().mark((function e(t){var n,r,o,i,a,s,c,u,l;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=void 0===n?"":n,o=t.text,i=t.title,a=t.sourceId,s=t.url,console.log("saving: ",{id:r,text:o,title:i,sourceId:a}),c=new FormData,e.next=5,Ai();case 5:return u=e.sent,r&&c.append("id",r),c.append("text",o),c.append("title",i),c.append("sourceId",a),c.append("source","typeahead"),c.append("dev","tempoary"),c.append("url",s),l={method:"POST",body:c,redirect:"follow",headers:{Authorization:"Bearer ".concat(u)}},e.next=16,fetch(pe+"/save_external_document",l).then((function(e){return e.json()})).catch((function(e){return console.log(e),["Error saving"]}));case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve=function(){var e=fe(le().mark((function e(t){var n,r,o,i,a,s,c,u,l,h,f,d;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=void 0===n?"":n,o=t.text,i=t.from,a=t.url,s=t.platform,c=void 0===s?"":s,u=t.metadata,l=void 0===u?{}:u,h=new FormData,e.next=4,Ai();case 4:return f=e.sent,r&&h.append("id",r),h.append("text",o),h.append("id",r),h.append("from",i),h.append("url",a),h.append("platform",c),h.append("metadata",JSON.stringify(l)),d={method:"POST",body:h,redirect:"follow",headers:{Authorization:"Bearer ".concat(f)}},e.next=15,fetch(pe+"/save_example_email",d).then((function(e){return e.json()})).catch((function(e){return console.log(e),["Error saving"]}));case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=function(){var e=fe(le().mark((function e(t){var n,r,o,i,a,s,c;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.contentId,r=void 0===n?"":n,o=t.platform,i=void 0===o?"":o,a=new FormData,e.next=4,Ai();case 4:return s=e.sent,r&&a.append("contentId",r),a.append("platform",i),c={method:"POST",body:a,redirect:"follow",headers:{Authorization:"Bearer ".concat(s)}},console.log("removing:lol "),e.next=11,fetch(pe+"/deleteSavedEmail",c).then((function(e){return e.json()})).catch((function(e){return console.log(e),["Error saving"]}));case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),we=function(){var e=fe(le().mark((function e(t){var n,r,o,i;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=new FormData,e.next=4,Ai();case 4:return o=e.sent,r.append("version","1"),n&&r.append("emails",JSON.stringify(n)),i={method:"POST",body:r,redirect:"follow",headers:{Authorization:"Bearer ".concat(o)}},console.log("checking email index status"),e.next=11,fetch(pe+"/checkSavedEmailStatus",i).then((function(e){return e.json()})).catch((function(e){return console.log(e),["Error saving"]}));case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xe=function(){var e=fe(le().mark((function e(t){var n,r,o,i,a,s,c;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.feedback,r=t.metadata,o=t.user_comment,e.next=3,Ai();case 3:return i=e.sent,a=pe+"/submitSuggestionFeedback",(s=new FormData).append("content_type","typeahead"),s.append("reason",n),r&&s.append("metadata",JSON.stringify(r)),s.append("user_comment",null!=o?o:""),e.next=12,fetch(a,{method:"POST",body:s,headers:{Authorization:"Bearer ".concat(i)}}).then((function(e){return console.log("content feedback save fired",e)})).catch((function(e){return console.log("error",e),{}}));case 12:return c=e.sent,e.abrupt("return",c);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ke=function(){var e=fe(le().mark((function e(t){var n,r,o,i,a;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.text,r=t.method,o=new FormData,e.next=4,Ai();case 4:return i=e.sent,console.log("method from api: ",r),o.append("text",n),o.append("method",r),a={method:"POST",body:o,redirect:"follow",headers:{Authorization:"Bearer ".concat(i)}},e.next=11,fetch(pe+"/list_example_emails",a).then((function(e){return e.json()})).catch((function(e){return console.log(e),["Error saving"]}));case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_e=function(){var e=fe(le().mark((function e(t){var n,r,o,i;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("saving measurement: ",t),n=pe+"/saveTypeAheadMeasurements",r=new FormData,e.next=5,Ai();case 5:return o=e.sent,null!=t&&t.messageTime&&r.append("messageTime",t.messageTime),null!=t&&t.keyDownCount&&r.append("keyDownCount",t.keyDownCount),null!=t&&t.appName&&r.append("platform",t.appName),null!=t&&t.acceptedCount&&r.append("acceptedCount",t.acceptedCount),null!=t&&t.notAcceptedCount&&r.append("notAcceptedCount",t.notAcceptedCount),e.next=13,fetch(n,{method:"POST",body:r,headers:{Authorization:"Bearer ".concat(o)}}).then((function(e){return console.log("saved the typeahead measurement: ",e)})).catch((function(e){return console.log("error",e),{}}));case 13:return i=e.sent,e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ae=function(){var e=fe(le().mark((function e(t){var n,r,o,i,a,s;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.type,r=t.metadata,o=t.app,i=new FormData,e.next=4,Ai();case 4:return a=e.sent,i.append("type",n),i.append("metadata",JSON.stringify(r)),i.append("app",o),s={method:"POST",body:i,redirect:"follow",headers:{Authorization:"Bearer ".concat(a)}},e.next=11,fetch(pe+"/logAcceptedTypeahead",s).then((function(e){return e.json()})).catch((function(e){return console.log(e),["Error saving"]}));case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ee=function(){var e=fe(le().mark((function e(t){var n,r,o,i,a,s;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.type,r=t.app,o=t.metadata,i=new FormData,e.next=4,Ai();case 4:return a=e.sent,i.append("type",n),i.append("app",r),i.append("metadata",JSON.stringify(o)),s={method:"POST",body:i,redirect:"follow",headers:{Authorization:"Bearer ".concat(a)}},e.next=11,fetch(pe+"/logShownTypeahead",s).then((function(e){return e.json()})).catch((function(e){return console.log(e),["Error saving"]}));case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(){var e=fe(le().mark((function e(t){var n,r,o,i,a,s,c,u,l,h,f,d;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.source,o=void 0===r?"Not specified":r,i=t.isError,a=void 0===i?"false":i,s=t.metadata,c=void 0===s?{}:s,u=new FormData,e.next=4,Ai();case 4:return l=e.sent,h=chrome.runtime.getManifest(),f={version:h.version},c&&(c=ae(ae({},f),c)),u.append("name",n),u.append("source",o),u.append("isError",a),u.append("metadata",JSON.stringify(c)),d={method:"POST",body:u,redirect:"follow",headers:{Authorization:"Bearer ".concat(l)}},e.next=15,fetch(pe+"/clientEvent",d).then((function(e){return e.json()})).catch((function(e){return console.log(e),["Error saving"]}));case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=fe(le().mark((function e(){var t,n,r;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ai();case 2:return t=e.sent,n=pe+"/loadTypeaheadAccess",e.next=6,fetch(n,{method:"POST",mode:"cors",headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).catch((function(e){console.log("error:",e)}));case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=fe(le().mark((function e(t){var n,r,o,i;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.applicationAccess,e.next=3,Ai();case 3:return r=e.sent,(o=new FormData).append("applicationAccess",JSON.stringify(n)),i=fetch(pe+"/userRequestUpdateTypeaheadAccess",{method:"POST",mode:"cors",body:o,redirect:"manual",headers:{Authorization:"Bearer ".concat(r)}}).then((function(e){return e.json()})).catch((function(e){console.log("error:",e)})),e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),je=function(){var e=fe(le().mark((function e(t){var n,r,o,i;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ai();case 2:return n=e.sent,r=pe+"/submitSurvey",(o=new FormData).append("surveyid",t.surveyId),o.append("results",JSON.stringify(t.surveyResults)),e.next=9,fetch(r,{method:"POST",body:o,headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){return e.json()})).catch((function(e){console.info(e)}));case 9:return i=e.sent,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Pe=function(){var e=fe(le().mark((function e(t){var n,r,o,i;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ai();case 2:return n=e.sent,r=pe+"/checkSurveyComplete",(o=new FormData).append("surveyid",t.surveyId),e.next=8,fetch(r,{method:"POST",body:o,headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){return e.json()})).catch((function(e){return console.log("error",e),{}}));case 8:return i=e.sent,e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Le=function(){var e=fe(le().mark((function e(t){var n,r,o,i;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ai();case 2:return n=e.sent,r=pe+"/registerCompletedTypeahead",(o=new FormData).append("id",t.id),o.append("metadata",JSON.stringify(t.metadata)),e.next=9,fetch(r,{method:"POST",body:o,headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){return e.json()})).catch((function(e){return console.log("error",e),{}}));case 9:return i=e.sent,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();const Ie="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,De=Object.keys,Ce=Array.isArray;function Me(e,t){return"object"!=typeof t||De(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||Ie.Promise||(Ie.Promise=Promise);const Fe=Object.getPrototypeOf,Ke={}.hasOwnProperty;function Ne(e,t){return Ke.call(e,t)}function Re(e,t){"function"==typeof t&&(t=t(Fe(e))),("undefined"==typeof Reflect?De:Reflect.ownKeys)(t).forEach((n=>{qe(e,n,t[n])}))}const Be=Object.defineProperty;function qe(e,t,n,r){Be(e,t,Me(n&&Ne(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function ze(e){return{from:function(t){return e.prototype=Object.create(t.prototype),qe(e.prototype,"constructor",e),{extend:Re.bind(null,e.prototype)}}}}const Ue=Object.getOwnPropertyDescriptor;function Ge(e,t){let n;return Ue(e,t)||(n=Fe(e))&&Ge(n,t)}const We=[].slice;function $e(e,t,n){return We.call(e,t,n)}function Je(e,t){return t(e)}function Ve(e){if(!e)throw new Error("Assertion Failed")}function Ye(e){Ie.setImmediate?setImmediate(e):setTimeout(e,0)}function He(e,t){return e.reduce(((e,n,r)=>{var o=t(n,r);return o&&(e[o[0]]=o[1]),e}),{})}function Qe(e,t){if(Ne(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,o=t.length;r<o;++r){var i=Qe(e,t[r]);n.push(i)}return n}var a=t.indexOf(".");if(-1!==a){var s=e[t.substr(0,a)];return void 0===s?void 0:Qe(s,t.substr(a+1))}}function Ze(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){Ve("string"!=typeof n&&"length"in n);for(var r=0,o=t.length;r<o;++r)Ze(e,t[r],n[r])}else{var i=t.indexOf(".");if(-1!==i){var a=t.substr(0,i),s=t.substr(i+1);if(""===s)void 0===n?Ce(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var c=e[a];c&&Ne(e,a)||(c=e[a]={}),Ze(c,s,n)}}else void 0===n?Ce(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Xe(e){var t={};for(var n in e)Ne(e,n)&&(t[n]=e[n]);return t}const et=[].concat;function tt(e){return et.apply([],e)}const nt="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(tt([8,16,32,64].map((e=>["Int","Uint","Float"].map((t=>t+e+"Array")))))).filter((e=>Ie[e])),rt=nt.map((e=>Ie[e]));He(nt,(e=>[e,!0]));let ot=null;function it(e){ot="undefined"!=typeof WeakMap&&new WeakMap;const t=at(e);return ot=null,t}function at(e){if(!e||"object"!=typeof e)return e;let t=ot&&ot.get(e);if(t)return t;if(Ce(e)){t=[],ot&&ot.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(at(e[n]))}else if(rt.indexOf(e.constructor)>=0)t=e;else{const n=Fe(e);for(var o in t=n===Object.prototype?{}:Object.create(n),ot&&ot.set(e,t),e)Ne(e,o)&&(t[o]=at(e[o]))}return t}const{toString:st}={};function ct(e){return st.call(e).slice(8,-1)}const ut="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",lt="symbol"==typeof ut?function(e){var t;return null!=e&&(t=e[ut])&&t.apply(e)}:function(){return null},ht={};function ft(e){var t,n,r,o;if(1===arguments.length){if(Ce(e))return e.slice();if(this===ht&&"string"==typeof e)return[e];if(o=lt(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}const dt="undefined"!=typeof Symbol?e=>"AsyncFunction"===e[Symbol.toStringTag]:()=>!1;var pt="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function mt(e,t){pt=e,gt=t}var gt=()=>!0;const yt=!new Error("").stack;function vt(){if(yt)try{throw vt.arguments,new Error}catch(e){return e}return new Error}function bt(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(gt).map((e=>"\n"+e)).join("")):""}var wt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],xt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(wt),kt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function _t(e,t){this._e=vt(),this.name=e,this.message=t}function At(e,t){return e+". Errors: "+Object.keys(t).map((e=>t[e].toString())).filter(((e,t,n)=>n.indexOf(e)===t)).join("\n")}function Et(e,t,n,r){this._e=vt(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=At(e,t)}function St(e,t){this._e=vt(),this.name="BulkError",this.failures=Object.keys(t).map((e=>t[e])),this.failuresByPos=t,this.message=At(e,t)}ze(_t).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+bt(this._e,2))}},toString:function(){return this.name+": "+this.message}}),ze(Et).from(_t),ze(St).from(_t);var Ot=xt.reduce(((e,t)=>(e[t]=t+"Error",e)),{});const Tt=_t;var jt=xt.reduce(((e,t)=>{var n=t+"Error";function r(e,r){this._e=vt(),this.name=n,e?"string"==typeof e?(this.message=`${e}${r?"\n "+r:""}`,this.inner=r||null):"object"==typeof e&&(this.message=`${e.name} ${e.message}`,this.inner=e):(this.message=kt[t]||n,this.inner=null)}return ze(r).from(Tt),e[t]=r,e}),{});jt.Syntax=SyntaxError,jt.Type=TypeError,jt.Range=RangeError;var Pt=wt.reduce(((e,t)=>(e[t+"Error"]=jt[t],e)),{}),Lt=xt.reduce(((e,t)=>(-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=jt[t]),e)),{});function It(){}function Dt(e){return e}function Ct(e,t){return null==e||e===Dt?t:function(n){return t(e(n))}}function Mt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Ft(e,t){return e===It?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Mt(r,this.onsuccess):r),o&&(this.onerror=this.onerror?Mt(o,this.onerror):o),void 0!==i?i:n}}function Kt(e,t){return e===It?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Mt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Mt(r,this.onerror):r)}}function Nt(e,t){return e===It?t:function(n){var r=e.apply(this,arguments);Me(n,r);var o=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?Mt(o,this.onsuccess):o),i&&(this.onerror=this.onerror?Mt(i,this.onerror):i),void 0===r?void 0===a?void 0:a:Me(r,a)}}function Rt(e,t){return e===It?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function Bt(e,t){return e===It?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,o=arguments.length,i=new Array(o);o--;)i[o]=arguments[o];return n.then((function(){return t.apply(r,i)}))}return t.apply(this,arguments)}}Lt.ModifyError=Et,Lt.DexieError=_t,Lt.BulkError=St;var qt={};const[zt,Ut,Gt]="undefined"==typeof Promise?[]:(()=>{let e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,Fe(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Fe(t),e]})(),Wt=Ut&&Ut.then,$t=zt&&zt.constructor,Jt=!!Gt;var Vt=!1,Yt=Gt?()=>{Gt.then(bn)}:Ie.setImmediate?setImmediate.bind(null,bn):Ie.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver((()=>{bn(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(bn,0)},Ht=function(e,t){an.push([e,t]),Zt&&(Yt(),Zt=!1)},Qt=!0,Zt=!0,Xt=[],en=[],tn=null,nn=Dt,rn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Un,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((e=>{try{Un(e[0],e[1])}catch(e){}}))}},on=rn,an=[],sn=0,cn=[];function un(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=It,this._lib=!1;var t=this._PSD=on;if(pt&&(this._stackHolder=vt(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==qt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&dn(this,this._value))}this._state=null,this._value=null,++t.ref,fn(this,e)}const ln={get:function(){var e=on,t=jn;function n(n,r){var o=!e.global&&(e!==on||t!==jn);const i=o&&!Dn();var a=new un(((t,a)=>{mn(this,new hn(qn(n,e,o,i),qn(r,e,o,i),t,a,e))}));return pt&&vn(a,this),a}return n.prototype=qt,n},set:function(e){qe(this,"then",e&&e.prototype===qt?ln:{get:function(){return e},set:ln.set})}};function hn(e,t,n,r,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=o}function fn(e,t){try{t((t=>{if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&wn();t&&"function"==typeof t.then?fn(e,((e,n)=>{t instanceof un?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,pn(e)),n&&xn()}}),dn.bind(null,e))}catch(t){dn(e,t)}}function dn(e,t){if(en.push(t),null===e._state){var n=e._lib&&wn();t=nn(t),e._state=!1,e._value=t,pt&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,void 0)}catch(e){}}((()=>{var n=Ge(t,"stack");t._promise=e,qe(t,"stack",{get:()=>Vt?n&&(n.get?n.get.apply(t):n.value):e.stack})})),function(e){Xt.some((t=>t._value===e._value))||Xt.push(e)}(e),pn(e),n&&xn()}}function pn(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)mn(e,t[n]);var o=e._PSD;--o.ref||o.finalize(),0===sn&&(++sn,Ht((()=>{0==--sn&&kn()}),[]))}function mn(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++sn,Ht(gn,[n,e,t])}else e._listeners.push(t)}function gn(e,t,n){try{tn=t;var r,o=t._value;t._state?r=e(o):(en.length&&(en=[]),r=e(o),-1===en.indexOf(o)&&function(e){for(var t=Xt.length;t;)if(Xt[--t]._value===e._value)return void Xt.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{tn=null,0==--sn&&kn(),--n.psd.ref||n.psd.finalize()}}function yn(e,t,n){if(t.length===n)return t;var r="";if(!1===e._state){var o,i,a=e._value;null!=a?(o=a.name||"Error",i=a.message||a,r=bt(a,0)):(o=a,i=""),t.push(o+(i?": "+i:"")+r)}return pt&&((r=bt(e._stackHolder,2))&&-1===t.indexOf(r)&&t.push(r),e._prev&&yn(e._prev,t,n)),t}function vn(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function bn(){wn()&&xn()}function wn(){var e=Qt;return Qt=!1,Zt=!1,e}function xn(){var e,t,n;do{for(;an.length>0;)for(e=an,an=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(an.length>0);Qt=!0,Zt=!0}function kn(){var e=Xt;Xt=[],e.forEach((e=>{e._PSD.onunhandled.call(null,e._value,e)}));for(var t=cn.slice(0),n=t.length;n;)t[--n]()}function _n(e){return new un(qt,!1,e)}function An(e,t){var n=on;return function(){var r=wn(),o=on;try{return Kn(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{Kn(o,!1),r&&xn()}}}Re(un.prototype,{then:ln,_then:function(e,t){mn(this,new hn(null,null,e,t,on))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(e=>e instanceof t?n(e):_n(e))):this.then(null,(e=>e&&e.name===t?n(e):_n(e)))},finally:function(e){return this.then((t=>(e(),t)),(t=>(e(),_n(t))))},stack:{get:function(){if(this._stack)return this._stack;try{Vt=!0;var e=yn(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{Vt=!1}}},timeout:function(e,t){return e<1/0?new un(((n,r)=>{var o=setTimeout((()=>r(new jt.Timeout(t))),e);this.then(n,r).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&qe(un.prototype,Symbol.toStringTag,"Dexie.Promise"),rn.env=Nn(),Re(un,{all:function(){var e=ft.apply(null,arguments).map(Cn);return new un((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach(((o,i)=>un.resolve(o).then((n=>{e[i]=n,--r||t(e)}),n)))}))},resolve:e=>{if(e instanceof un)return e;if(e&&"function"==typeof e.then)return new un(((t,n)=>{e.then(t,n)}));var t=new un(qt,!0,e);return vn(t,tn),t},reject:_n,race:function(){var e=ft.apply(null,arguments).map(Cn);return new un(((t,n)=>{e.map((e=>un.resolve(e).then(t,n)))}))},PSD:{get:()=>on,set:e=>on=e},totalEchoes:{get:()=>jn},newPSD:Ln,usePSD:Rn,scheduler:{get:()=>Ht,set:e=>{Ht=e}},rejectionMapper:{get:()=>nn,set:e=>{nn=e}},follow:(e,t)=>new un(((n,r)=>Ln(((t,n)=>{var r=on;r.unhandleds=[],r.onunhandled=n,r.finalize=Mt((function(){!function(e){cn.push((function t(){e(),cn.splice(cn.indexOf(t),1)})),++sn,Ht((()=>{0==--sn&&kn()}),[])}((()=>{0===this.unhandleds.length?t():n(this.unhandleds[0])}))}),r.finalize),e()}),t,n,r)))}),$t&&($t.allSettled&&qe(un,"allSettled",(function(){const e=ft.apply(null,arguments).map(Cn);return new un((t=>{0===e.length&&t([]);let n=e.length;const r=new Array(n);e.forEach(((e,o)=>un.resolve(e).then((e=>r[o]={status:"fulfilled",value:e}),(e=>r[o]={status:"rejected",reason:e})).then((()=>--n||t(r)))))}))})),$t.any&&"undefined"!=typeof AggregateError&&qe(un,"any",(function(){const e=ft.apply(null,arguments).map(Cn);return new un(((t,n)=>{0===e.length&&n(new AggregateError([]));let r=e.length;const o=new Array(r);e.forEach(((e,i)=>un.resolve(e).then((e=>t(e)),(e=>{o[i]=e,--r||n(new AggregateError(o))}))))}))})));const En={awaits:0,echoes:0,id:0};var Sn=0,On=[],Tn=0,jn=0,Pn=0;function Ln(e,t,n,r){var o=on,i=Object.create(o);i.parent=o,i.ref=0,i.global=!1,i.id=++Pn;var a=rn.env;i.env=Jt?{Promise:un,PromiseProp:{value:un,configurable:!0,writable:!0},all:un.all,race:un.race,allSettled:un.allSettled,any:un.any,resolve:un.resolve,reject:un.reject,nthen:zn(a.nthen,i),gthen:zn(a.gthen,i)}:{},t&&Me(i,t),++o.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=Rn(i,e,n,r);return 0===i.ref&&i.finalize(),s}function In(){return En.id||(En.id=++Sn),++En.awaits,En.echoes+=100,En.id}function Dn(){return!!En.awaits&&(0==--En.awaits&&(En.id=0),En.echoes=100*En.awaits,!0)}function Cn(e){return En.echoes&&e&&e.constructor===$t?(In(),e.then((e=>(Dn(),e)),(e=>(Dn(),Gn(e))))):e}function Mn(e){++jn,En.echoes&&0!=--En.echoes||(En.echoes=En.id=0),On.push(on),Kn(e,!0)}function Fn(){var e=On[On.length-1];On.pop(),Kn(e,!1)}function Kn(e,t){var n=on;if((t?!En.echoes||Tn++&&e===on:!Tn||--Tn&&e===on)||Bn(t?Mn.bind(null,e):Fn),e!==on&&(on=e,n===rn&&(rn.env=Nn()),Jt)){var r=rn.env.Promise,o=e.env;Ut.then=o.nthen,r.prototype.then=o.gthen,(n.global||e.global)&&(Object.defineProperty(Ie,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function Nn(){var e=Ie.Promise;return Jt?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(Ie,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Ut.then,gthen:e.prototype.then}:{}}function Rn(e,t,n,r,o){var i=on;try{return Kn(e,!0),t(n,r,o)}finally{Kn(i,!1)}}function Bn(e){Wt.call(zt,e)}function qn(e,t,n,r){return"function"!=typeof e?e:function(){var o=on;n&&In(),Kn(t,!0);try{return e.apply(this,arguments)}finally{Kn(o,!1),r&&Bn(Dn)}}}function zn(e,t){return function(n,r){return e.call(this,qn(n,t),qn(r,t))}}function Un(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var r,o={promise:t,reason:e};if(Ie.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),Me(r,o)):Ie.CustomEvent&&Me(r=new CustomEvent("unhandledrejection",{detail:o}),o),r&&Ie.dispatchEvent&&(dispatchEvent(r),!Ie.PromiseRejectionEvent&&Ie.onunhandledrejection))try{Ie.onunhandledrejection(r)}catch(e){}pt&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch(e){}}-1===(""+Wt).indexOf("[native code]")&&(In=Dn=It);var Gn=un.reject;function Wn(e,t,n,r){if(e.idbdb&&(e._state.openComplete||on.letThrough||e._vip)){var o=e._createTransaction(t,n,e._dbSchema);try{o.create(),e._state.PR1398_maxLoop=3}catch(o){return o.name===Ot.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>Wn(e,t,n,r)))):Gn(o)}return o._promise(t,((e,t)=>Ln((()=>(on.trans=o,r(e,t,o)))))).then((e=>o._completion.then((()=>e))))}if(e._state.openComplete)return Gn(new jt.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Gn(new jt.DatabaseClosed);e.open().catch(It)}return e._state.dbReadyPromise.then((()=>Wn(e,t,n,r)))}const $n=String.fromCharCode(65535),Jn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Vn=[],Yn="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Hn=Yn,Qn=Yn,Zn=e=>!/(dexie\.js|dexie\.min\.js)/.test(e);function Xn(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const er={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function tr(e){return"string"!=typeof e||/\./.test(e)?e=>e:t=>(void 0===t[e]&&e in t&&delete(t=it(t))[e],t)}class nr{_trans(e,t,n){const r=this._tx||on.trans,o=this.name;function i(e,n,r){if(!r.schema[o])throw new jt.NotFound("Table "+o+" not part of transaction");return t(r.idbtrans,r)}const a=wn();try{return r&&r.db===this.db?r===on.trans?r._promise(e,i,n):Ln((()=>r._promise(e,i,n)),{trans:r,transless:on.transless||on}):Wn(this.db,e,[this.name],i)}finally{a&&xn()}}get(e,t){return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(t=>this.core.get({trans:t,key:e}).then((e=>this.hook.reading.fire(e))))).then(t)}where(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(Ce(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const t=De(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter((e=>e.compound&&t.every((t=>e.keyPath.indexOf(t)>=0))&&e.keyPath.every((e=>t.indexOf(e)>=0))))[0];if(n&&this.db._maxKey!==$n)return this.where(n.name).equals(n.keyPath.map((t=>e[t])));!n&&pt&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${t.join("+")}]`);const{idxByName:r}=this.schema,o=this.db._deps.indexedDB;function i(e,t){try{return 0===o.cmp(e,t)}catch(e){return!1}}const[a,s]=t.reduce((([t,n],o)=>{const a=r[o],s=e[o];return[t||a,t||!a?Xn(n,a&&a.multi?e=>{const t=Qe(e,o);return Ce(t)&&t.some((e=>i(s,e)))}:e=>i(s,Qe(e,o))):n]}),[null,null]);return a?this.where(a.name).equals(e[a.keyPath]).filter(s):n?this.filter(s):this.where(t).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,Ce(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const t=t=>{if(!t)return t;const n=Object.create(e.prototype);for(var r in t)if(Ne(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e}defineClass(){return this.mapToClass((function(e){Me(this,e)}))}add(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let o=e;return r&&n&&(o=tr(r)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[o]}))).then((e=>e.numFailures?un.reject(e.failures[0]):e.lastResult)).then((t=>{if(r)try{Ze(e,r,t)}catch(e){}return t}))}update(e,t){if("object"!=typeof e||Ce(e))return this.where(":id").equals(e).modify(t);{const n=Qe(e,this.schema.primKey.keyPath);if(void 0===n)return Gn(new jt.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof t?De(t).forEach((n=>{Ze(e,n,t[n])})):t(e,{value:e,primKey:n})}catch(e){}return this.where(":id").equals(n).modify(t)}}put(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let o=e;return r&&n&&(o=tr(r)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"put",values:[o],keys:null!=t?[t]:null}))).then((e=>e.numFailures?un.reject(e.failures[0]):e.lastResult)).then((t=>{if(r)try{Ze(e,r,t)}catch(e){}return t}))}delete(e){return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:[e]}))).then((e=>e.numFailures?un.reject(e.failures[0]):void 0))}clear(){return this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"deleteRange",range:er}))).then((e=>e.numFailures?un.reject(e.failures[0]):void 0))}bulkGet(e){return this._trans("readonly",(t=>this.core.getMany({keys:e,trans:t}).then((e=>e.map((e=>this.hook.reading.fire(e)))))))}bulkAdd(e,t,n){const r=Array.isArray(t)?t:void 0,o=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:n,keyPath:i}=this.schema.primKey;if(i&&r)throw new jt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new jt.InvalidArgument("Arguments objects and keys must have the same length");const a=e.length;let s=i&&n?e.map(tr(i)):e;return this.core.mutate({trans:t,type:"add",keys:r,values:s,wantResults:o}).then((({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return o?t:n;throw new St(`${this.name}.bulkAdd(): ${e} of ${a} operations failed`,r)}))}))}bulkPut(e,t,n){const r=Array.isArray(t)?t:void 0,o=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:n,keyPath:i}=this.schema.primKey;if(i&&r)throw new jt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new jt.InvalidArgument("Arguments objects and keys must have the same length");const a=e.length;let s=i&&n?e.map(tr(i)):e;return this.core.mutate({trans:t,type:"put",keys:r,values:s,wantResults:o}).then((({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return o?t:n;throw new St(`${this.name}.bulkPut(): ${e} of ${a} operations failed`,r)}))}))}bulkDelete(e){const t=e.length;return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:e}))).then((({numFailures:e,lastResult:n,failures:r})=>{if(0===e)return n;throw new St(`${this.name}.bulkDelete(): ${e} of ${t} operations failed`,r)}))}}function rr(e){var t={},n=function(n,r){if(r){for(var o=arguments.length,i=new Array(o-1);--o;)i[o-1]=arguments[o];return t[n].subscribe.apply(null,i),e}if("string"==typeof n)return t[n]};n.addEventType=i;for(var r=1,o=arguments.length;r<o;++r)i(arguments[r]);return n;function i(e,r,o){if("object"==typeof e)return a(e);r||(r=Rt),o||(o=It);var i={subscribers:[],fire:o,subscribe:function(e){-1===i.subscribers.indexOf(e)&&(i.subscribers.push(e),i.fire=r(i.fire,e))},unsubscribe:function(e){i.subscribers=i.subscribers.filter((function(t){return t!==e})),i.fire=i.subscribers.reduce(r,o)}};return t[e]=n[e]=i,i}function a(e){De(e).forEach((function(t){var n=e[t];if(Ce(n))i(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new jt.InvalidArgument("Invalid event config");var r=i(t,Dt,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){Ye((function(){e.apply(null,t)}))}))}))}}))}}function or(e,t){return ze(t).from({prototype:e}),t}function ir(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function ar(e,t){e.filter=Xn(e.filter,t)}function sr(e,t,n){var r=e.replayFilter;e.replayFilter=r?()=>Xn(r(),t()):t,e.justLimit=n&&!r}function cr(e,t){if(e.isPrimKey)return t.primaryKey;const n=t.getIndexByKeyPath(e.index);if(!n)throw new jt.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function ur(e,t,n){const r=cr(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function lr(e,t,n,r){const o=e.replayFilter?Xn(e.filter,e.replayFilter()):e.filter;if(e.or){const i={},a=(e,n,r)=>{if(!o||o(n,r,(e=>n.stop(e)),(e=>n.fail(e)))){var a=n.primaryKey,s=""+a;"[object ArrayBuffer]"===s&&(s=""+new Uint8Array(a)),Ne(i,s)||(i[s]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),hr(ur(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return hr(ur(e,r,n),Xn(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function hr(e,t,n,r){var o=An(r?(e,t,o)=>n(r(e),t,o):n);return e.then((e=>{if(e)return e.start((()=>{var n=()=>e.continue();t&&!t(e,(e=>n=e),(t=>{e.stop(t),n=It}),(t=>{e.fail(t),n=It}))||o(e.value,e,(e=>n=e)),n()}))}))}function fr(e,t){try{const n=dr(e),r=dr(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){const n=e.length,r=t.length,o=n<r?n:r;for(let n=0;n<o;++n)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return n===r?0:n<r?-1:1}(pr(e),pr(t));case"Array":return function(e,t){const n=e.length,r=t.length,o=n<r?n:r;for(let n=0;n<o;++n){const r=fr(e[n],t[n]);if(0!==r)return r}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function dr(e){const t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";const n=ct(e);return"ArrayBuffer"===n?"binary":n}function pr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class mr{_read(e,t){var n=this._ctx;return n.error?n.table._trans(null,Gn.bind(null,n.error)):n.table._trans("readonly",e).then(t)}_write(e){var t=this._ctx;return t.error?t.table._trans(null,Gn.bind(null,t.error)):t.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var t=this._ctx;t.algorithm=Xn(t.algorithm,e)}_iterate(e,t){return lr(this._ctx,e,t,this._ctx.table.core)}clone(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&Me(n,e),t._ctx=n,t}raw(){return this._ctx.valueMapper=null,this}each(e){var t=this._ctx;return this._read((n=>lr(t,e,n,t.table.core)))}count(e){return this._read((e=>{const t=this._ctx,n=t.table.core;if(ir(t,!0))return n.count({trans:e,query:{index:cr(t,n.schema),range:t.range}}).then((e=>Math.min(e,t.limit)));var r=0;return lr(t,(()=>(++r,!1)),e,n).then((()=>r))})).then(e)}sortBy(e,t){const n=e.split(".").reverse(),r=n[0],o=n.length-1;function i(e,t){return t?i(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function s(e,t){var n=i(e,o),r=i(t,o);return n<r?-a:n>r?a:0}return this.toArray((function(e){return e.sort(s)})).then(t)}toArray(e){return this._read((e=>{var t=this._ctx;if("next"===t.dir&&ir(t,!0)&&t.limit>0){const{valueMapper:n}=t,r=cr(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:r,range:t.range}}).then((({result:e})=>n?e.map(n):e))}{const n=[];return lr(t,(e=>n.push(e)),e,t.table.core).then((()=>n))}}),e)}offset(e){var t=this._ctx;return e<=0||(t.offset+=e,ir(t)?sr(t,(()=>{var t=e;return(e,n)=>0===t||(1===t?(--t,!1):(n((()=>{e.advance(t),t=0})),!1))})):sr(t,(()=>{var t=e;return()=>--t<0}))),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),sr(this._ctx,(()=>{var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this}until(e,t){return ar(this._ctx,(function(n,r,o){return!e(n.value)||(r(o),t)})),this}first(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)}last(e){return this.reverse().first(e)}filter(e){var t,n;return ar(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=Xn(t.isMatch,n),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))}keys(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)}primaryKeys(e){var t=this._ctx;if("next"===t.dir&&ir(t,!0)&&t.limit>0)return this._read((e=>{var n=cr(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((({result:e})=>e)).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys((function(e){return e[0]})).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return ar(this._ctx,(function(e){var t=e.primaryKey.toString(),r=Ne(n,t);return n[t]=!0,!r})),this}modify(e){var t=this._ctx;return this._write((n=>{var r;if("function"==typeof e)r=e;else{var o=De(e),i=o.length;r=function(t){for(var n=!1,r=0;r<i;++r){var a=o[r],s=e[a];Qe(t,a)!==s&&(Ze(t,a,s),n=!0)}return n}}const a=t.table.core,{outbound:s,extractKey:c}=a.schema.primaryKey,u=this.db._options.modifyChunkSize||200,l=[];let h=0;const f=[],d=(e,t)=>{const{failures:n,numFailures:r}=t;h+=e-r;for(let e of De(n))l.push(n[e])};return this.clone().primaryKeys().then((o=>{const i=l=>{const h=Math.min(u,o.length-l);return a.getMany({trans:n,keys:o.slice(l,l+h),cache:"immutable"}).then((f=>{const p=[],m=[],g=s?[]:null,y=[];for(let e=0;e<h;++e){const t=f[e],n={value:it(t),primKey:o[l+e]};!1!==r.call(n,n.value,n)&&(null==n.value?y.push(o[l+e]):s||0===fr(c(t),c(n.value))?(m.push(n.value),s&&g.push(o[l+e])):(y.push(o[l+e]),p.push(n.value)))}const v=ir(t)&&t.limit===1/0&&("function"!=typeof e||e===gr)&&{index:t.index,range:t.range};return Promise.resolve(p.length>0&&a.mutate({trans:n,type:"add",values:p}).then((e=>{for(let t in e.failures)y.splice(parseInt(t),1);d(p.length,e)}))).then((()=>(m.length>0||v&&"object"==typeof e)&&a.mutate({trans:n,type:"put",keys:g,values:m,criteria:v,changeSpec:"function"!=typeof e&&e}).then((e=>d(m.length,e))))).then((()=>(y.length>0||v&&e===gr)&&a.mutate({trans:n,type:"delete",keys:y,criteria:v}).then((e=>d(y.length,e))))).then((()=>o.length>l+h&&i(l+u)))}))};return i(0).then((()=>{if(l.length>0)throw new Et("Error modifying one or more objects",l,h,f);return o.length}))}))}))}delete(){var e=this._ctx,t=e.range;return ir(e)&&(e.isPrimKey&&!Qn||3===t.type)?this._write((n=>{const{primaryKey:r}=e.table.core.schema,o=t;return e.table.core.count({trans:n,query:{index:r,range:o}}).then((t=>e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then((({failures:e,lastResult:n,results:r,numFailures:o})=>{if(o)throw new Et("Could not delete some values",Object.keys(e).map((t=>e[t])),t-o);return t-o}))))})):this.modify(gr)}}const gr=(e,t)=>t.value=null;function yr(e,t){return e<t?-1:e===t?0:1}function vr(e,t){return e>t?-1:e===t?0:1}function br(e,t,n){var r=e instanceof Er?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function wr(e){return new e.Collection(e,(()=>Ar(""))).limit(0)}function xr(e,t,n,r,o,i){for(var a=Math.min(e.length,r.length),s=-1,c=0;c<a;++c){var u=t[c];if(u!==r[c])return o(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):o(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;o(e[c],u)<0&&(s=c)}return a<r.length&&"next"===i?e+n.substr(e.length):a<e.length&&"prev"===i?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}function kr(e,t,n,r){var o,i,a,s,c,u,l,h=n.length;if(!n.every((e=>"string"==typeof e)))return br(e,"String expected.");function f(e){o=function(e){return"next"===e?e=>e.toUpperCase():e=>e.toLowerCase()}(e),i=function(e){return"next"===e?e=>e.toLowerCase():e=>e.toUpperCase()}(e),a="next"===e?yr:vr;var t=n.map((function(e){return{lower:i(e),upper:o(e)}})).sort((function(e,t){return a(e.lower,t.lower)}));s=t.map((function(e){return e.upper})),c=t.map((function(e){return e.lower})),u=e,l="next"===e?"":r}f("next");var d=new e.Collection(e,(()=>_r(s[0],c[h-1]+r)));d._ondirectionchange=function(e){f(e)};var p=0;return d._addAlgorithm((function(e,n,r){var o=e.key;if("string"!=typeof o)return!1;var f=i(o);if(t(f,c,p))return!0;for(var d=null,m=p;m<h;++m){var g=xr(o,f,s[m],c[m],a,u);null===g&&null===d?p=m+1:(null===d||a(d,g)>0)&&(d=g)}return n(null!==d?function(){e.continue(d+l)}:r),!1})),d}function _r(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Ar(e){return{type:1,lower:e,upper:e}}class Er{get Collection(){return this._ctx.table.db.Collection}between(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?wr(this):new this.Collection(this,(()=>_r(e,t,!n,!r)))}catch(e){return br(this,Jn)}}equals(e){return null==e?br(this,Jn):new this.Collection(this,(()=>Ar(e)))}above(e){return null==e?br(this,Jn):new this.Collection(this,(()=>_r(e,void 0,!0)))}aboveOrEqual(e){return null==e?br(this,Jn):new this.Collection(this,(()=>_r(e,void 0,!1)))}below(e){return null==e?br(this,Jn):new this.Collection(this,(()=>_r(void 0,e,!1,!0)))}belowOrEqual(e){return null==e?br(this,Jn):new this.Collection(this,(()=>_r(void 0,e)))}startsWith(e){return"string"!=typeof e?br(this,"String expected."):this.between(e,e+$n,!0,!0)}startsWithIgnoreCase(e){return""===e?this.startsWith(e):kr(this,((e,t)=>0===e.indexOf(t[0])),[e],$n)}equalsIgnoreCase(e){return kr(this,((e,t)=>e===t[0]),[e],"")}anyOfIgnoreCase(){var e=ft.apply(ht,arguments);return 0===e.length?wr(this):kr(this,((e,t)=>-1!==t.indexOf(e)),e,"")}startsWithAnyOfIgnoreCase(){var e=ft.apply(ht,arguments);return 0===e.length?wr(this):kr(this,((e,t)=>t.some((t=>0===e.indexOf(t)))),e,$n)}anyOf(){const e=ft.apply(ht,arguments);let t=this._cmp;try{e.sort(t)}catch(e){return br(this,Jn)}if(0===e.length)return wr(this);const n=new this.Collection(this,(()=>_r(e[0],e[e.length-1])));n._ondirectionchange=n=>{t="next"===n?this._ascending:this._descending,e.sort(t)};let r=0;return n._addAlgorithm(((n,o,i)=>{const a=n.key;for(;t(a,e[r])>0;)if(++r,r===e.length)return o(i),!1;return 0===t(a,e[r])||(o((()=>{n.continue(e[r])})),!1)})),n}notEqual(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=ft.apply(ht,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return br(this,Jn)}const t=e.reduce(((e,t)=>e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,t){const n=this._cmp,r=this._ascending,o=this._descending,i=this._min,a=this._max;if(0===e.length)return wr(this);if(!e.every((e=>void 0!==e[0]&&void 0!==e[1]&&r(e[0],e[1])<=0)))return br(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",jt.InvalidArgument);const s=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers;let u,l=r;function h(e,t){return l(e[0],t[0])}try{u=e.reduce((function(e,t){let r=0,o=e.length;for(;r<o;++r){const o=e[r];if(n(t[0],o[1])<0&&n(t[1],o[0])>0){o[0]=i(o[0],t[0]),o[1]=a(o[1],t[1]);break}}return r===o&&e.push(t),e}),[]),u.sort(h)}catch(e){return br(this,Jn)}let f=0;const d=c?e=>r(e,u[f][1])>0:e=>r(e,u[f][1])>=0,p=s?e=>o(e,u[f][0])>0:e=>o(e,u[f][0])>=0;let m=d;const g=new this.Collection(this,(()=>_r(u[0][0],u[u.length-1][1],!s,!c)));return g._ondirectionchange=e=>{"next"===e?(m=d,l=r):(m=p,l=o),u.sort(h)},g._addAlgorithm(((e,t,n)=>{for(var o=e.key;m(o);)if(++f,f===u.length)return t(n),!1;return!!function(e){return!d(e)&&!p(e)}(o)||(0===this._cmp(o,u[f][1])||0===this._cmp(o,u[f][0])||t((()=>{l===r?e.continue(u[f][0]):e.continue(u[f][1])})),!1)})),g}startsWithAnyOf(){const e=ft.apply(ht,arguments);return e.every((e=>"string"==typeof e))?0===e.length?wr(this):this.inAnyRange(e.map((e=>[e,e+$n]))):br(this,"startsWithAnyOf() only works with strings")}}function Sr(e){return An((function(t){return Or(t),e(t.target.error),!1}))}function Or(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const Tr=rr(null,"storagemutated");class jr{_lock(){return Ve(!on.global),++this._reculock,1!==this._reculock||on.global||(on.lockOwnerFor=this),this}_unlock(){if(Ve(!on.global),0==--this._reculock)for(on.global||(on.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Rn(e[1],e[0])}catch(e){}}return this}_locked(){return this._reculock&&on.lockOwnerFor!==this}create(e){if(!this.mode)return this;const t=this.db.idbdb,n=this.db._state.dbOpenError;if(Ve(!this.idbtrans),!e&&!t)switch(n&&n.name){case"DatabaseClosedError":throw new jt.DatabaseClosed(n);case"MissingAPIError":throw new jt.MissingAPI(n.message,n);default:throw new jt.OpenFailed(n)}if(!this.active)throw new jt.TransactionInactive;return Ve(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=An((t=>{Or(t),this._reject(e.error)})),e.onabort=An((t=>{Or(t),this.active&&this._reject(new jt.Abort(e.error)),this.active=!1,this.on("abort").fire(t)})),e.oncomplete=An((()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Tr.storagemutated.fire(e.mutatedParts)})),this}_promise(e,t,n){if("readwrite"===e&&"readwrite"!==this.mode)return Gn(new jt.ReadOnly("Transaction is readonly"));if(!this.active)return Gn(new jt.TransactionInactive);if(this._locked())return new un(((r,o)=>{this._blockedFuncs.push([()=>{this._promise(e,t,n).then(r,o)},on])}));if(n)return Ln((()=>{var e=new un(((e,n)=>{this._lock();const r=t(e,n,this);r&&r.then&&r.then(e,n)}));return e.finally((()=>this._unlock())),e._lib=!0,e}));var r=new un(((e,n)=>{var r=t(e,n,this);r&&r.then&&r.then(e,n)}));return r._lib=!0,r}_root(){return this.parent?this.parent._root():this}waitFor(e){var t=this._root();const n=un.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((()=>n));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var o=t._waitingFor;return new un(((e,r)=>{n.then((n=>t._waitingQueue.push(An(e.bind(null,n)))),(e=>t._waitingQueue.push(An(r.bind(null,e))))).finally((()=>{t._waitingFor===o&&(t._waitingFor=null)}))}))}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new jt.Abort))}table(e){const t=this._memoizedTables||(this._memoizedTables={});if(Ne(t,e))return t[e];const n=this.schema[e];if(!n)throw new jt.NotFound("Table "+e+" not part of transaction");const r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r}}function Pr(e,t,n,r,o,i,a){return{name:e,keyPath:t,unique:n,multi:r,auto:o,compound:i,src:(n&&!a?"&":"")+(r?"*":"")+(o?"++":"")+Lr(t)}}function Lr(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Ir(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:He(n,(e=>[e.name,e]))}}let Dr=e=>{try{return e.only([[]]),Dr=()=>[[]],[[]]}catch(e){return Dr=()=>$n,$n}};function Cr(e){return null==e?()=>{}:"string"==typeof e?function(e){return 1===e.split(".").length?t=>t[e]:t=>Qe(t,e)}(e):t=>Qe(t,e)}function Mr(e){return[].slice.call(e)}let Fr=0;function Kr(e){return null==e?":id":"string"==typeof e?e:`[${e.join("+")}]`}function Nr({_novip:e},t){const n=t.db,r=function(e,t,{IDBKeyRange:n,indexedDB:r},o){const i=function(e,t){return t.reduce(((e,{create:t})=>({...e,...t(e)})),e)}(function(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:n,upper:r,lowerOpen:o,upperOpen:i}=e;return void 0===n?void 0===r?null:t.upperBound(r,!!i):void 0===r?t.lowerBound(n,!!o):t.bound(n,r,!!o,!!i)}const{schema:o,hasGetAll:i}=function(e,t){const n=Mr(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((e=>t.objectStore(e))).map((e=>{const{keyPath:t,autoIncrement:n}=e,r=Ce(t),o=null==t,i={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:o,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Cr(t)},indexes:Mr(e.indexNames).map((t=>e.index(t))).map((e=>{const{name:t,unique:n,multiEntry:r,keyPath:o}=e,a={name:t,compound:Ce(o),keyPath:o,unique:n,multiEntry:r,extractKey:Cr(o)};return i[Kr(o)]=a,a})),getIndexByKeyPath:e=>i[Kr(e)]};return i[":id"]=a.primaryKey,null!=t&&(i[Kr(t)]=a.primaryKey),a}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),a=o.tables.map((e=>function(e){const t=e.name;return{name:t,schema:e,mutate:function({trans:e,type:n,keys:o,values:i,range:a}){return new Promise(((s,c)=>{s=An(s);const u=e.objectStore(t),l=null==u.keyPath,h="put"===n||"add"===n;if(!h&&"delete"!==n&&"deleteRange"!==n)throw new Error("Invalid operation type: "+n);const{length:f}=o||i||{length:1};if(o&&i&&o.length!==i.length)throw new Error("Given keys array must have same length as given values array.");if(0===f)return s({numFailures:0,failures:{},results:[],lastResult:void 0});let d;const p=[],m=[];let g=0;const y=e=>{++g,Or(e)};if("deleteRange"===n){if(4===a.type)return s({numFailures:g,failures:m,results:[],lastResult:void 0});3===a.type?p.push(d=u.clear()):p.push(d=u.delete(r(a)))}else{const[e,t]=h?l?[i,o]:[i,null]:[o,null];if(h)for(let r=0;r<f;++r)p.push(d=t&&void 0!==t[r]?u[n](e[r],t[r]):u[n](e[r])),d.onerror=y;else for(let t=0;t<f;++t)p.push(d=u[n](e[t])),d.onerror=y}const v=e=>{const t=e.target.result;p.forEach(((e,t)=>null!=e.error&&(m[t]=e.error))),s({numFailures:g,failures:m,results:"delete"===n?o:p.map((e=>e.result)),lastResult:t})};d.onerror=e=>{y(e),v(e)},d.onsuccess=v}))},getMany:({trans:e,keys:n})=>new Promise(((r,o)=>{r=An(r);const i=e.objectStore(t),a=n.length,s=new Array(a);let c,u=0,l=0;const h=e=>{const t=e.target;s[t._pos]=t.result,++l===u&&r(s)},f=Sr(o);for(let e=0;e<a;++e)null!=n[e]&&(c=i.get(n[e]),c._pos=e,c.onsuccess=h,c.onerror=f,++u);0===u&&r(s)})),get:({trans:e,key:n})=>new Promise(((r,o)=>{r=An(r);const i=e.objectStore(t).get(n);i.onsuccess=e=>r(e.target.result),i.onerror=Sr(o)})),query:function(e){return n=>new Promise(((o,i)=>{o=An(o);const{trans:a,values:s,limit:c,query:u}=n,l=c===1/0?void 0:c,{index:h,range:f}=u,d=a.objectStore(t),p=h.isPrimaryKey?d:d.index(h.name),m=r(f);if(0===c)return o({result:[]});if(e){const e=s?p.getAll(m,l):p.getAllKeys(m,l);e.onsuccess=e=>o({result:e.target.result}),e.onerror=Sr(i)}else{let e=0;const t=s||!("openKeyCursor"in p)?p.openCursor(m):p.openKeyCursor(m),n=[];t.onsuccess=r=>{const i=t.result;return i?(n.push(s?i.value:i.primaryKey),++e===c?o({result:n}):void i.continue()):o({result:n})},t.onerror=Sr(i)}}))}(i),openCursor:function({trans:e,values:n,query:o,reverse:i,unique:a}){return new Promise(((s,c)=>{s=An(s);const{index:u,range:l}=o,h=e.objectStore(t),f=u.isPrimaryKey?h:h.index(u.name),d=i?a?"prevunique":"prev":a?"nextunique":"next",p=n||!("openKeyCursor"in f)?f.openCursor(r(l),d):f.openKeyCursor(r(l),d);p.onerror=Sr(c),p.onsuccess=An((t=>{const n=p.result;if(!n)return void s(null);n.___id=++Fr,n.done=!1;const r=n.continue.bind(n);let o=n.continuePrimaryKey;o&&(o=o.bind(n));const i=n.advance.bind(n),a=()=>{throw new Error("Cursor not stopped")};n.trans=e,n.stop=n.continue=n.continuePrimaryKey=n.advance=()=>{throw new Error("Cursor not started")},n.fail=An(c),n.next=function(){let e=1;return this.start((()=>e--?this.continue():this.stop())).then((()=>this))},n.start=e=>{const t=new Promise(((e,t)=>{e=An(e),p.onerror=Sr(t),n.fail=t,n.stop=t=>{n.stop=n.continue=n.continuePrimaryKey=n.advance=a,e(t)}})),s=()=>{if(p.result)try{e()}catch(e){n.fail(e)}else n.done=!0,n.start=()=>{throw new Error("Cursor behind last entry")},n.stop()};return p.onsuccess=An((e=>{p.onsuccess=s,s()})),n.continue=r,n.continuePrimaryKey=o,n.advance=i,s(),t},s(n)}),c)}))},count({query:e,trans:n}){const{index:o,range:i}=e;return new Promise(((e,a)=>{const s=n.objectStore(t),c=o.isPrimaryKey?s:s.index(o.name),u=r(i),l=u?c.count(u):c.count();l.onsuccess=An((t=>e(t.target.result))),l.onerror=Sr(a)}))}}}(e))),s={};return a.forEach((e=>s[e.name]=e)),{stack:"dbcore",transaction:e.transaction.bind(e),table(e){if(!s[e])throw new Error(`Table '${e}' not found`);return s[e]},MIN_KEY:-1/0,MAX_KEY:Dr(t),schema:o}}(t,n,o),e.dbcore);return{dbcore:i}}(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((t=>{const n=t.name;e.core.schema.tables.some((e=>e.name===n))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function Rr({_novip:e},t,n,r){n.forEach((n=>{const o=r[n];t.forEach((t=>{const r=Ge(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?qe(t,n,{get(){return this.table(n)},set(e){Be(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,o))}))}))}function Br({_novip:e},t){t.forEach((t=>{for(let n in t)t[n]instanceof e.Table&&delete t[n]}))}function qr(e,t){return e._cfg.version-t._cfg.version}function zr(e,t){const n={del:[],add:[],change:[]};let r;for(r in e)t[r]||n.del.push(r);for(r in t){const o=e[r],i=t[r];if(o){const e={name:r,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||o.primKey.auto!==i.primKey.auto&&!Yn)e.recreate=!0,n.change.push(e);else{const t=o.idxByName,r=i.idxByName;let a;for(a in t)r[a]||e.del.push(a);for(a in r){const n=t[a],o=r[a];n?n.src!==o.src&&e.change.push(o):e.add.push(o)}(e.del.length>0||e.add.length>0||e.change.length>0)&&n.change.push(e)}}else n.add.push([r,i])}return n}function Ur(e,t,n,r){const o=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((e=>Gr(o,e))),o}function Gr(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Wr(e,t,n){const r={};return $e(t.objectStoreNames,0).forEach((e=>{const t=n.objectStore(e);let o=t.keyPath;const i=Pr(Lr(o),o||"",!1,!1,!!t.autoIncrement,o&&"string"!=typeof o,!0),a=[];for(let e=0;e<t.indexNames.length;++e){const n=t.index(t.indexNames[e]);o=n.keyPath;var s=Pr(n.name,o,!!n.unique,!!n.multiEntry,!1,o&&"string"!=typeof o,!1);a.push(s)}r[e]=Ir(e,i,a)})),r}function $r({_novip:e},t,n){const r=n.db.objectStoreNames;for(let o=0;o<r.length;++o){const i=r[o],a=n.objectStore(i);e._hasGetAll="getAll"in a;for(let e=0;e<a.indexNames.length;++e){const n=a.indexNames[e],r=a.index(n).keyPath,o="string"==typeof r?r:"["+$e(r).join("+")+"]";if(t[i]){const e=t[i].idxByName[o];e&&(e.name=n,delete t[i].idxByName[o],t[i].idxByName[n]=e)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Ie.WorkerGlobalScope&&Ie instanceof Ie.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class Jr{_parseStoresSpec(e,t){De(e).forEach((n=>{if(null!==e[n]){var r=e[n].split(",").map(((e,t)=>{const n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Pr(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),Ce(r),0===t)})),o=r.shift();if(o.multi)throw new jt.Schema("Primary key cannot be multi-valued");r.forEach((e=>{if(e.auto)throw new jt.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new jt.Schema("Index must have a name and cannot be an empty string")})),t[n]=Ir(n,o,r)}}))}stores(e){const t=this.db;this._cfg.storesSource=this._cfg.storesSource?Me(this._cfg.storesSource,e):e;const n=t._versions,r={};let o={};return n.forEach((e=>{Me(r,e._cfg.storesSource),o=e._cfg.dbschema={},e._parseStoresSpec(r,o)})),t._dbSchema=o,Br(t,[t._allTables,t,t.Transaction.prototype]),Rr(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],De(o),o),t._storeNames=De(o),this}upgrade(e){return this._cfg.contentUpgrade=Bt(this._cfg.contentUpgrade||It,e),this}}function Vr(e,t){let n=e._dbNamesDB;return n||(n=e._dbNamesDB=new yo("__dbnames",{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Yr(e){return e&&"function"==typeof e.databases}function Hr(e){return Ln((function(){return on.letThrough=!0,e()}))}function Qr(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function Zr(e){const t=e._state,{indexedDB:n}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((()=>t.dbOpenError?Gn(t.dbOpenError):e));pt&&(t.openCanceller._stackHolder=vt()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const r=t.openCanceller;function o(){if(t.openCanceller!==r)throw new jt.DatabaseClosed("db.open() was cancelled")}let i=t.dbReadyResolve,a=null,s=!1;return un.race([r,("undefined"==typeof navigator?un.resolve():Qr()).then((()=>new un(((r,i)=>{if(o(),!n)throw new jt.MissingAPI;const c=e.name,u=t.autoSchema?n.open(c):n.open(c,Math.round(10*e.verno));if(!u)throw new jt.MissingAPI;u.onerror=Sr(i),u.onblocked=An(e._fireOnBlocked),u.onupgradeneeded=An((r=>{if(a=u.transaction,t.autoSchema&&!e._options.allowEmptyDB){u.onerror=Or,a.abort(),u.result.close();const e=n.deleteDatabase(c);e.onsuccess=e.onerror=An((()=>{i(new jt.NoSuchDatabase(`Database ${c} doesnt exist`))}))}else{a.onerror=Sr(i);var o=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;s=o<1,e._novip.idbdb=u.result,function(e,t,n,r){const o=e._dbSchema,i=e._createTransaction("readwrite",e._storeNames,o);i.create(n),i._completion.catch(r);const a=i._reject.bind(i),s=on.transless||on;Ln((()=>{on.trans=i,on.transless=s,0===t?(De(o).forEach((e=>{Ur(n,e,o[e].primKey,o[e].indexes)})),Nr(e,n),un.follow((()=>e.on.populate.fire(i))).catch(a)):function({_novip:e},t,n,r){const o=[],i=e._versions;let a=e._dbSchema=Wr(0,e.idbdb,r),s=!1;return i.filter((e=>e._cfg.version>=t)).forEach((i=>{o.push((()=>{const o=a,c=i._cfg.dbschema;$r(e,o,r),$r(e,c,r),a=e._dbSchema=c;const u=zr(o,c);u.add.forEach((e=>{Ur(r,e[0],e[1].primKey,e[1].indexes)})),u.change.forEach((e=>{if(e.recreate)throw new jt.Upgrade("Not yet support for changing primary key");{const t=r.objectStore(e.name);e.add.forEach((e=>Gr(t,e))),e.change.forEach((e=>{t.deleteIndex(e.name),Gr(t,e)})),e.del.forEach((e=>t.deleteIndex(e)))}}));const l=i._cfg.contentUpgrade;if(l&&i._cfg.version>t){Nr(e,r),n._memoizedTables={},s=!0;let t=Xe(c);u.del.forEach((e=>{t[e]=o[e]})),Br(e,[e.Transaction.prototype]),Rr(e,[e.Transaction.prototype],De(t),t),n.schema=t;const i=dt(l);let a;i&&In();const h=un.follow((()=>{if(a=l(n),a&&i){var e=Dn.bind(null,null);a.then(e,e)}}));return a&&"function"==typeof a.then?un.resolve(a):h.then((()=>a))}})),o.push((t=>{s&&Hn||function(e,t){[].slice.call(t.db.objectStoreNames).forEach((n=>null==e[n]&&t.db.deleteObjectStore(n)))}(i._cfg.dbschema,t),Br(e,[e.Transaction.prototype]),Rr(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),function e(){return o.length?un.resolve(o.shift()(n.idbtrans)).then(e):un.resolve()}().then((()=>{var e,t;t=r,De(e=a).forEach((n=>{t.db.objectStoreNames.contains(n)||Ur(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,i,n).catch(a)}))}(e,o/10,a,i)}}),i),u.onsuccess=An((()=>{a=null;const n=e._novip.idbdb=u.result,o=$e(n.objectStoreNames);if(o.length>0)try{const r=n.transaction(1===(i=o).length?i[0]:i,"readonly");t.autoSchema?function({_novip:e},t,n){e.verno=t.version/10;const r=e._dbSchema=Wr(0,t,n);e._storeNames=$e(t.objectStoreNames,0),Rr(e,[e._allTables],De(r),r)}(e,n,r):($r(e,e._dbSchema,r),function(e,t){const n=zr(Wr(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((e=>e.add.length||e.change.length)))}(e,r)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Nr(e,r)}catch(e){}var i;Vn.push(e),n.onversionchange=An((n=>{t.vcFired=!0,e.on("versionchange").fire(n)})),n.onclose=An((t=>{e.on("close").fire(t)})),s&&function({indexedDB:e,IDBKeyRange:t},n){!Yr(e)&&"__dbnames"!==n&&Vr(e,t).put({name:n}).catch(It)}(e._deps,c),r()}),i)}))))]).then((()=>(o(),t.onReadyBeingFired=[],un.resolve(Hr((()=>e.on.ready.fire(e.vip)))).then((function n(){if(t.onReadyBeingFired.length>0){let r=t.onReadyBeingFired.reduce(Bt,It);return t.onReadyBeingFired=[],un.resolve(Hr((()=>r(e.vip)))).then(n)}}))))).finally((()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1})).then((()=>e)).catch((n=>{t.dbOpenError=n;try{a&&a.abort()}catch(e){}return r===t.openCanceller&&e._close(),Gn(n)})).finally((()=>{t.openComplete=!0,i()}))}function Xr(e){var t=t=>e.next(t),n=o(t),r=o((t=>e.throw(t)));function o(e){return t=>{var o=e(t),i=o.value;return o.done?i:i&&"function"==typeof i.then?i.then(n,r):Ce(i)?Promise.all(i).then(n,r):n(i)}}return o(t)()}function eo(e,t,n){var r=arguments.length;if(r<2)throw new jt.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];n=o.pop();var i=tt(o);return[e,i,n]}function to(e,t,n,r,o){return un.resolve().then((()=>{const i=on.transless||on,a=e._createTransaction(t,n,e._dbSchema,r),s={trans:a,transless:i};if(r)a.idbtrans=r.idbtrans;else try{a.create(),e._state.PR1398_maxLoop=3}catch(r){return r.name===Ot.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>to(e,t,n,null,o)))):Gn(r)}const c=dt(o);let u;c&&In();const l=un.follow((()=>{if(u=o.call(a,a),u)if(c){var e=Dn.bind(null,null);u.then(e,e)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=Xr(u))}),s);return(u&&"function"==typeof u.then?un.resolve(u).then((e=>a.active?e:Gn(new jt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn")))):l.then((()=>u))).then((e=>(r&&a._resolve(),a._completion.then((()=>e))))).catch((e=>(a._reject(e),Gn(e))))}))}function no(e,t,n){const r=Ce(e)?e.slice():[e];for(let e=0;e<n;++e)r.push(t);return r}const ro={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const n=e.table(t),{schema:r}=n,o={},i=[];function a(e,t,n){const r=Kr(e),s=o[r]=o[r]||[],c=null==e?0:"string"==typeof e?1:e.length,u=t>0,l={...n,isVirtual:u,keyTail:t,keyLength:c,extractKey:Cr(e),unique:!u&&n.unique};return s.push(l),l.isPrimaryKey||i.push(l),c>1&&a(2===c?e[0]:e.slice(0,c-1),t+1,n),s.sort(((e,t)=>e.keyTail-t.keyTail)),l}const s=a(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[s];for(const e of r.indexes)a(e.keyPath,0,e);function c(t){const n=t.query.index;return n.isVirtual?{...t,query:{index:n,range:(r=t.query.range,o=n.keyTail,{type:1===r.type?2:r.type,lower:no(r.lower,r.lowerOpen?e.MAX_KEY:e.MIN_KEY,o),lowerOpen:!0,upper:no(r.upper,r.upperOpen?e.MIN_KEY:e.MAX_KEY,o),upperOpen:!0})}}:t;var r,o}const u={...n,schema:{...r,primaryKey:s,indexes:i,getIndexByKeyPath:function(e){const t=o[Kr(e)];return t&&t[0]}},count:e=>n.count(c(e)),query:e=>n.query(c(e)),openCursor(t){const{keyTail:r,isVirtual:o,keyLength:i}=t.query.index;return o?n.openCursor(c(t)).then((n=>n&&function(n){const o=Object.create(n,{continue:{value:function(o){null!=o?n.continue(no(o,t.reverse?e.MAX_KEY:e.MIN_KEY,r)):t.unique?n.continue(n.key.slice(0,i).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,r)):n.continue()}},continuePrimaryKey:{value(t,o){n.continuePrimaryKey(no(t,e.MAX_KEY,r),o)}},primaryKey:{get:()=>n.primaryKey},key:{get(){const e=n.key;return 1===i?e[0]:e.slice(0,i)}},value:{get:()=>n.value}});return o}(n))):n.openCursor(t)}};return u}}}};function oo(e,t,n,r){return n=n||{},r=r||"",De(e).forEach((o=>{if(Ne(t,o)){var i=e[o],a=t[o];if("object"==typeof i&&"object"==typeof a&&i&&a){const e=ct(i);e!==ct(a)?n[r+o]=t[o]:"Object"===e?oo(i,a,n,r+o+"."):i!==a&&(n[r+o]=t[o])}else i!==a&&(n[r+o]=t[o])}else n[r+o]=void 0})),De(t).forEach((o=>{Ne(e,o)||(n[r+o]=t[o])})),n}const io={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const n=e.table(t),{primaryKey:r}=n.schema,o={...n,mutate(e){const o=on.trans,{deleting:i,creating:a,updating:s}=o.table(t).hook;switch(e.type){case"add":if(a.fire===It)break;return o._promise("readwrite",(()=>c(e)),!0);case"put":if(a.fire===It&&s.fire===It)break;return o._promise("readwrite",(()=>c(e)),!0);case"delete":if(i.fire===It)break;return o._promise("readwrite",(()=>c(e)),!0);case"deleteRange":if(i.fire===It)break;return o._promise("readwrite",(()=>function(e){return u(e.trans,e.range,1e4)}(e)),!0)}return n.mutate(e);function c(e){const t=on.trans,o=e.keys||function(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}(r,e);if(!o)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?{...e,keys:o}:{...e}).type&&(e.values=[...e.values]),e.keys&&(e.keys=[...e.keys]),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(n,e,o).then((c=>{const u=o.map(((n,o)=>{const u=c[o],l={onerror:null,onsuccess:null};if("delete"===e.type)i.fire.call(l,n,u,t);else if("add"===e.type||void 0===u){const i=a.fire.call(l,n,e.values[o],t);null==n&&null!=i&&(n=i,e.keys[o]=n,r.outbound||Ze(e.values[o],r.keyPath,n))}else{const r=oo(u,e.values[o]),i=s.fire.call(l,r,n,u,t);if(i){const t=e.values[o];Object.keys(i).forEach((e=>{Ne(t,e)?t[e]=i[e]:Ze(t,e,i[e])}))}}return l}));return n.mutate(e).then((({failures:t,results:n,numFailures:r,lastResult:i})=>{for(let r=0;r<o.length;++r){const i=n?n[r]:o[r],a=u[r];null==i?a.onerror&&a.onerror(t[r]):a.onsuccess&&a.onsuccess("put"===e.type&&c[r]?e.values[r]:i)}return{failures:t,results:n,numFailures:r,lastResult:i}})).catch((e=>(u.forEach((t=>t.onerror&&t.onerror(e))),Promise.reject(e))))}))}function u(e,t,o){return n.query({trans:e,values:!1,query:{index:r,range:t},limit:o}).then((({result:n})=>c({type:"delete",keys:n,trans:e}).then((r=>r.numFailures>0?Promise.reject(r.failures[0]):n.length<o?{failures:[],numFailures:0,lastResult:void 0}:u(e,{...t,lower:n[n.length-1],lowerOpen:!0},o)))))}}};return o}})};function ao(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;const r=[];for(let o=0,i=0;o<t.keys.length&&i<e.length;++o)0===fr(t.keys[o],e[i])&&(r.push(n?it(t.values[o]):t.values[o]),++i);return r.length===e.length?r:null}catch(e){return null}}const so={stack:"dbcore",level:-1,create:e=>({table:t=>{const n=e.table(t);return{...n,getMany:e=>{if(!e.cache)return n.getMany(e);const t=ao(e.keys,e.trans._cache,"clone"===e.cache);return t?un.resolve(t):n.getMany(e).then((t=>(e.trans._cache={keys:e.keys,values:"clone"===e.cache?it(t):t},t)))},mutate:e=>("add"!==e.type&&(e.trans._cache=null),n.mutate(e))}}})};function co(e){return!("from"in e)}const uo=function(e,t){if(!this){const t=new uo;return e&&"d"in e&&Me(t,e),t}Me(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function lo(e,t,n){const r=fr(t,n);if(isNaN(r))return;if(r>0)throw RangeError();if(co(e))return Me(e,{from:t,to:n,d:1});const o=e.l,i=e.r;if(fr(n,e.from)<0)return o?lo(o,t,n):e.l={from:t,to:n,d:1,l:null,r:null},po(e);if(fr(t,e.to)>0)return i?lo(i,t,n):e.r={from:t,to:n,d:1,l:null,r:null},po(e);fr(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),fr(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);const a=!e.r;o&&!e.l&&ho(e,o),i&&a&&ho(e,i)}function ho(e,t){co(t)||function e(t,{from:n,to:r,l:o,r:i}){lo(t,n,r),o&&e(t,o),i&&e(t,i)}(e,t)}function fo(e){let t=co(e)?null:{s:0,n:e};return{next(e){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&fr(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||fr(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function po(e){var t,n;const r=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){const t="r"===o?"l":"r",n={...e},r=e[o];e.from=r.from,e.to=r.to,e[o]=r[o],n[o]=r[t],e[t]=n,n.d=mo(n)}e.d=mo(e)}function mo({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Re(uo.prototype,{add(e){return ho(this,e),this},addKey(e){return lo(this,e,e),this},addKeys(e){return e.forEach((e=>lo(this,e,e))),this},[ut](){return fo(this)}});const go={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,n=new uo(e.MIN_KEY,e.MAX_KEY);return{...e,table:r=>{const o=e.table(r),{schema:i}=o,{primaryKey:a}=i,{extractKey:s,outbound:c}=a,u={...o,mutate:e=>{const a=e.trans,s=a.mutatedParts||(a.mutatedParts={}),c=e=>{const n=`idb://${t}/${r}/${e}`;return s[n]||(s[n]=new uo)},u=c(""),l=c(":dels"),{type:h}=e;let[f,d]="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[[],e.values]:[];const p=e.trans._cache;return o.mutate(e).then((e=>{if(Ce(f)){"delete"!==h&&(f=e.results),u.addKeys(f);const t=ao(f,p);t||"add"===h||l.addKeys(f),(t||d)&&function(e,t,n,r){t.indexes.forEach((function(t){const o=e(t.name||"");function i(e){return null!=e?t.extractKey(e):null}const a=e=>t.multiEntry&&Ce(e)?e.forEach((e=>o.addKey(e))):o.addKey(e);(n||r).forEach(((e,t)=>{const o=n&&i(n[t]),s=r&&i(r[t]);0!==fr(o,s)&&(null!=o&&a(o),null!=s&&a(s))}))}))}(c,i,t,d)}else if(f){const e={from:f.lower,to:f.upper};l.add(e),u.add(e)}else u.add(n),l.add(n),i.indexes.forEach((e=>c(e.name).add(n)));return e}))}},l=({query:{index:t,range:n}})=>{var r,o;return[t,new uo(null!==(r=n.lower)&&void 0!==r?r:e.MIN_KEY,null!==(o=n.upper)&&void 0!==o?o:e.MAX_KEY)]},h={get:e=>[a,new uo(e.key)],getMany:e=>[a,(new uo).addKeys(e.keys)],count:l,query:l,openCursor:l};return De(h).forEach((e=>{u[e]=function(i){const{subscr:a}=on;if(a){const u=e=>{const n=`idb://${t}/${r}/${e}`;return a[n]||(a[n]=new uo)},l=u(""),f=u(":dels"),[d,p]=h[e](i);if(u(d.name||"").add(p),!d.isPrimaryKey){if("count"!==e){const t="query"===e&&c&&i.values&&o.query({...i,values:!1});return o[e].apply(this,arguments).then((n=>{if("query"===e){if(c&&i.values)return t.then((({result:e})=>(l.addKeys(e),n)));const e=i.values?n.result.map(s):n.result;i.values?l.addKeys(e):f.addKeys(e)}else if("openCursor"===e){const e=n,t=i.values;return e&&Object.create(e,{key:{get:()=>(f.addKey(e.primaryKey),e.key)},primaryKey:{get(){const t=e.primaryKey;return f.addKey(t),t}},value:{get:()=>(t&&l.addKey(e.primaryKey),e.value)}})}return n}))}f.add(n)}}return o[e].apply(this,arguments)}})),u}}}};class yo{constructor(e,t){this._middlewares={},this.verno=0;const n=yo.dependencies;this._options=t={addons:yo.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...t},this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};const{addons:r}=t;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:It,dbReadyPromise:null,cancelOpen:It,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var i;o.dbReadyPromise=new un((e=>{o.dbReadyResolve=e})),o.openCanceller=new un(((e,t)=>{o.cancelOpen=t})),this._state=o,this.name=e,this.on=rr(this,"populate","blocked","versionchange","close",{ready:[Bt,It]}),this.on.ready.subscribe=Je(this.on.ready.subscribe,(e=>(t,n)=>{yo.vip((()=>{const r=this._state;if(r.openComplete)r.dbOpenError||un.resolve().then(t),n&&e(t);else if(r.onReadyBeingFired)r.onReadyBeingFired.push(t),n&&e(t);else{e(t);const r=this;n||e((function e(){r.on.ready.unsubscribe(t),r.on.ready.unsubscribe(e)}))}}))})),this.Collection=(i=this,or(mr.prototype,(function(e,t){this.db=i;let n=er,r=null;if(t)try{n=t()}catch(e){r=e}const o=e._ctx,a=o.table,s=a.hook.reading.fire;this._ctx={table:a,index:o.index,isPrimKey:!o.index||a.schema.primKey.keyPath&&o.index===a.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:o.or,valueMapper:s!==Dt?s:null}}))),this.Table=function(e){return or(nr.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:rr(null,{creating:[Ft,It],reading:[Ct,Dt],updating:[Nt,It],deleting:[Kt,It]})}))}(this),this.Transaction=function(e){return or(jr.prototype,(function(t,n,r,o,i){this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=rr(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new un(((e,t)=>{this._resolve=e,this._reject=t})),this._completion.then((()=>{this.active=!1,this.on.complete.fire()}),(e=>{var t=this.active;return this.active=!1,this.on.error.fire(e),this.parent?this.parent._reject(e):t&&this.idbtrans&&this.idbtrans.abort(),Gn(e)}))}))}(this),this.Version=function(e){return or(Jr.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return or(Er.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};const o=e._deps.indexedDB;if(!o)throw new jt.MissingAPI;this._cmp=this._ascending=o.cmp.bind(o),this._descending=(e,t)=>o.cmp(t,e),this._max=(e,t)=>o.cmp(e,t)>0?e:t,this._min=(e,t)=>o.cmp(e,t)<0?e:t,this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(e=>{e.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()})),this.on("blocked",(e=>{!e.newVersion||e.newVersion<e.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${e.oldVersion/10}`)})),this._maxKey=Dr(t.IDBKeyRange),this._createTransaction=(e,t,n,r)=>new this.Transaction(e,t,n,this._options.chromeTransactionDurability,r),this._fireOnBlocked=e=>{this.on("blocked").fire(e),Vn.filter((e=>e.name===this.name&&e!==this&&!e._state.vcFired)).map((t=>t.on("versionchange").fire(e)))},this.use(ro),this.use(io),this.use(go),this.use(so),this.vip=Object.create(this,{_vip:{value:!0}}),r.forEach((e=>e(this)))}version(e){if(isNaN(e)||e<.1)throw new jt.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new jt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const t=this._versions;var n=t.filter((t=>t._cfg.version===e))[0];return n||(n=new this.Version(e),t.push(n),t.sort(qr),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(e){return this.idbdb&&(this._state.openComplete||on.letThrough||this._vip)?e():new un(((e,t)=>{if(this._state.openComplete)return t(new jt.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void t(new jt.DatabaseClosed);this.open().catch(It)}this._state.dbReadyPromise.then(e,t)})).then(e)}use({stack:e,create:t,level:n,name:r}){r&&this.unuse({stack:e,name:r});const o=this._middlewares[e]||(this._middlewares[e]=[]);return o.push({stack:e,create:t,level:null==n?10:n,name:r}),o.sort(((e,t)=>e.level-t.level)),this}unuse({stack:e,name:t,create:n}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter((e=>n?e.create!==n:!!t&&e.name!==t))),this}open(){return Zr(this)}_close(){const e=this._state,t=Vn.indexOf(this);if(t>=0&&Vn.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this._novip.idbdb=null}e.dbReadyPromise=new un((t=>{e.dbReadyResolve=t})),e.openCanceller=new un(((t,n)=>{e.cancelOpen=n}))}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new jt.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,t=this._state;return new un(((n,r)=>{const o=()=>{this.close();var e=this._deps.indexedDB.deleteDatabase(this.name);e.onsuccess=An((()=>{!function({indexedDB:e,IDBKeyRange:t},n){!Yr(e)&&"__dbnames"!==n&&Vr(e,t).delete(n).catch(It)}(this._deps,this.name),n()})),e.onerror=Sr(r),e.onblocked=this._fireOnBlocked};if(e)throw new jt.InvalidArgument("Arguments not allowed in db.delete()");t.isBeingOpened?t.dbReadyPromise.then(o):o()}))}backendDB(){return this.idbdb}isOpen(){return null!==this.idbdb}hasBeenClosed(){const e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name}hasFailed(){return null!==this._state.dbOpenError}dynamicallyOpened(){return this._state.autoSchema}get tables(){return De(this._allTables).map((e=>this._allTables[e]))}transaction(){const e=eo.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,t,n){let r=on.trans;r&&r.db===this&&-1===e.indexOf("!")||(r=null);const o=-1!==e.indexOf("?");let i,a;e=e.replace("!","").replace("?","");try{if(a=t.map((e=>{var t=e instanceof this.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)i="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new jt.InvalidArgument("Invalid transaction mode: "+e);i="readwrite"}if(r){if("readonly"===r.mode&&"readwrite"===i){if(!o)throw new jt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&a.forEach((e=>{if(r&&-1===r.storeNames.indexOf(e)){if(!o)throw new jt.SubTransaction("Table "+e+" not included in parent transaction.");r=null}})),o&&r&&!r.active&&(r=null)}}catch(e){return r?r._promise(null,((t,n)=>{n(e)})):Gn(e)}const s=to.bind(null,this,i,a,r,n);return r?r._promise(i,s,"lock"):on.trans?Rn(on.transless,(()=>this._whenReady(s))):this._whenReady(s)}table(e){if(!Ne(this._allTables,e))throw new jt.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const vo="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";class bo{constructor(e){this._subscribe=e}subscribe(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})}[vo](){return this}}function wo(e,t){return De(t).forEach((n=>{ho(e[n]||(e[n]=new uo),t[n])})),e}let xo;try{xo={indexedDB:Ie.indexedDB||Ie.mozIndexedDB||Ie.webkitIndexedDB||Ie.msIndexedDB,IDBKeyRange:Ie.IDBKeyRange||Ie.webkitIDBKeyRange}}catch(t){xo={indexedDB:null,IDBKeyRange:null}}const ko=yo;function _o(e){let t=Ao;try{Ao=!0,Tr.storagemutated.fire(e)}finally{Ao=t}}Re(ko,{...Lt,delete:e=>new ko(e,{addons:[]}).delete(),exists:e=>new ko(e,{addons:[]}).open().then((e=>(e.close(),!0))).catch("NoSuchDatabaseError",(()=>!1)),getDatabaseNames(e){try{return function({indexedDB:e,IDBKeyRange:t}){return Yr(e)?Promise.resolve(e.databases()).then((e=>e.map((e=>e.name)).filter((e=>"__dbnames"!==e)))):Vr(e,t).toCollection().primaryKeys()}(ko.dependencies).then(e)}catch(e){return Gn(new jt.MissingAPI)}},defineClass:()=>function(e){Me(this,e)},ignoreTransaction:e=>on.trans?Rn(on.transless,e):e(),vip:Hr,async:function(e){return function(){try{var t=Xr(e.apply(this,arguments));return t&&"function"==typeof t.then?t:un.resolve(t)}catch(e){return Gn(e)}}},spawn:function(e,t,n){try{var r=Xr(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:un.resolve(r)}catch(e){return Gn(e)}},currentTransaction:{get:()=>on.trans||null},waitFor:function(e,t){const n=un.resolve("function"==typeof e?ko.ignoreTransaction(e):e).timeout(t||6e4);return on.trans?on.trans.waitFor(n):n},Promise:un,debug:{get:()=>pt,set:e=>{mt(e,"dexie"===e?()=>!0:Zn)}},derive:ze,extend:Me,props:Re,override:Je,Events:rr,on:Tr,liveQuery:function(e){return new bo((t=>{const n=dt(e);let r=!1,o={},i={};const a={get closed(){return r},unsubscribe:()=>{r=!0,Tr.storagemutated.unsubscribe(l)}};t.start&&t.start(a);let s=!1,c=!1;function u(){return De(i).some((e=>o[e]&&function(e,t){const n=fo(t);let r=n.next();if(r.done)return!1;let o=r.value;const i=fo(e);let a=i.next(o.from),s=a.value;for(;!r.done&&!a.done;){if(fr(s.from,o.to)<=0&&fr(s.to,o.from)>=0)return!0;fr(o.from,s.from)<0?o=(r=n.next(s.from)).value:s=(a=i.next(o.from)).value}return!1}(o[e],i[e])))}const l=e=>{wo(o,e),u()&&h()},h=()=>{if(s||r)return;o={};const f={},d=function(t){n&&In();const r=()=>Ln(e,{subscr:t,trans:null}),o=on.trans?Rn(on.transless,r):r();return n&&o.then(Dn,Dn),o}(f);c||(Tr("storagemutated",l),c=!0),s=!0,Promise.resolve(d).then((e=>{s=!1,r||(u()?h():(o={},i=f,t.next&&t.next(e)))}),(e=>{s=!1,t.error&&t.error(e),a.unsubscribe()}))};return h(),a}))},extendObservabilitySet:wo,getByKeyPath:Qe,setByKeyPath:Ze,delByKeyPath:function(e,t){"string"==typeof t?Ze(e,t,void 0):"length"in t&&[].map.call(t,(function(t){Ze(e,t,void 0)}))},shallowClone:Xe,deepClone:it,getObjectDiff:oo,cmp:fr,asap:Ye,minKey:-1/0,addons:[],connections:Vn,errnames:Ot,dependencies:xo,semVer:"3.2.2",version:"3.2.2".split(".").map((e=>parseInt(e))).reduce(((e,t,n)=>e+t/Math.pow(10,2*n)))}),ko.maxKey=Dr(ko.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Tr("storagemutated",(e=>{if(!Ao){let t;Yn?(t=document.createEvent("CustomEvent"),t.initCustomEvent("x-storagemutated-1",!0,!0,e)):t=new CustomEvent("x-storagemutated-1",{detail:e}),Ao=!0,dispatchEvent(t),Ao=!1}})),addEventListener("x-storagemutated-1",(({detail:e})=>{Ao||_o(e)})));let Ao=!1;if("undefined"!=typeof BroadcastChannel){const e=new BroadcastChannel("x-storagemutated-1");Tr("storagemutated",(t=>{Ao||e.postMessage(t)})),e.onmessage=e=>{e.data&&_o(e.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){Tr("storagemutated",(e=>{try{Ao||("undefined"!=typeof localStorage&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:e})),"object"==typeof self.clients&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach((t=>t.postMessage({type:"x-storagemutated-1",changedParts:e}))))}catch(e){}})),"undefined"!=typeof addEventListener&&addEventListener("storage",(e=>{if("x-storagemutated-1"===e.key){const t=JSON.parse(e.newValue);t&&_o(t.changedParts)}}));const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",(function({data:e}){e&&"x-storagemutated-1"===e.type&&_o(e.changedParts)}))}un.rejectionMapper=function(e,t){if(!e||e instanceof _t||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Pt[e.name])return e;var n=new Pt[e.name](t||e.message,e);return"stack"in e&&qe(n,"stack",{get:function(){return this.inner.stack}}),n},mt(pt,Zn);var Eo=__webpack_require__(6304),So=["2 girls 1 cup","anal","anus","areole","arian","arrse","arse","arsehole","aryan","asanchez","ass","assbang","assbanged","asses","assfuck","assfucker","assfukka","asshole","assmunch","asswhole","autoerotic","ballsack","bastard","bdsm","beastial","beastiality","bellend","bestial","bestiality","bimbo","bimbos","bitch","bitches","bitchin","bitching","blowjob","blowjobs","blue waffle","bondage","boner","boob","boobs","booobs","boooobs","booooobs","booooooobs","booty call","breasts","brown shower","brown showers","buceta","bukake","bukkake","bullshit","busty","butthole","carpet muncher","cawk","chink","cipa","clit","clitoris","clits","cnut","cock","cockface","cockhead","cockmunch","cockmuncher","cocks","cocksuck","cocksucked","cocksucker","cocksucking","cocksucks","cokmuncher","coon","cowgirl","cowgirls","crap","crotch","cum","cuming","cummer","cumming","cums","cumshot","cunilingus","cunillingus","cunnilingus","cunt","cuntlicker","cuntlicking","cunts","damn","deepthroat","dick","dickhead","dildo","dildos","dink","dinks","dlck","dog style","dog-fucker","doggiestyle","doggin","dogging","doggystyle","dong","donkeyribber","doofus","doosh","dopey","douche","douchebag","douchebags","douchey","drunk","duche","dumass","dumbass","dumbasses","dummy","dyke","dykes","eatadick","eathairpie","ejaculate","ejaculated","ejaculates","ejaculating","ejaculatings","ejaculation","ejakulate","enlargement","erect","erection","erotic","erotism","essohbee","extacy","extasy","facial","fack","fag","fagg","fagged","fagging","faggit","faggitt","faggot","faggs","fagot","fagots","fags","faig","faigt","fanny","fannybandit","fannyflaps","fannyfucker","fanyy","fart","fartknocker","fat","fatass","fcuk","fcuker","fcuking","feck","fecker","felch","felcher","felching","fellate","fellatio","feltch","feltcher","femdom","fingerfuck","fingerfucked","fingerfucker","fingerfuckers","fingerfucking","fingerfucks","fingering","fisted","fistfuck","fistfucked","fistfucker","fistfuckers","fistfucking","fistfuckings","fistfucks","fisting","fisty","flange","flogthelog","floozy","foad","fondle","foobar","fook","fooker","footjob","foreskin","freex","frigg","frigga","fubar","fuck","fucka","fuckass","fuckbitch","fucked","fucker","fuckers","fuckface","fuckhead","fuckheads","fuckhole","fuckin","fucking","fuckings","fuckingshitmotherfucker","fuckme","fuckmeat","fucknugget","fucknut","fuckoff","fuckpuppet","fucks","fucktard","fucktoy","fucktrophy","fuckup","fuckwad","fuckwhit","fuckwit","fuckyomama","fudgepacker","fuk","fuker","fukker","fukkin","fukking","fuks","fukwhit","fukwit","futanari","futanary","fux","fuxor","fxck","gae","gai","gangbang","gangbanged","gangbangs","ganja","gassyass","gay","gaylord","gays","gaysex","gey","gfy","ghay","ghey","gigolo","glans","goatse","god","godamn","godamnit","goddam","goddammit","goddamn","goddamned","gokkun","goldenshower","gonad","gonads","gook","gooks","gringo","gspot","gtfo","guido","hamflap","handjob","hardcoresex","hardon","hebe","heeb","hell","hemp","hentai","heroin","herp","herpes","herpy","heshe","hitler","hiv","hoar","hoare","hobag","hoer","homey","homo","homoerotic","homoey","honky","hooch","hookah","hooker","hoor","hootch","hooter","hooters","hore","horniest","horny","hotsex","howtokill","howtomurdep","hump","humped","humping","hussy","hymen","inbred","incest","injun","jackass","jackhole","jackoff","jap","japs","jerk","jerked","jerkoff","jism","jiz","jizm","jizz","jizzed","junkie","junky","kawk","kike","kikes","kill","kinbaku","kinky","kinkyJesus","kkk","klan","knob","knobead","knobed","knobend","knobhead","knobjocky","knobjokey","kock","kondum","kondums","kooch","kooches","kootch","kraut","kum","kummer","kumming","kums","kunilingus","kwif","kyke","l3itch","labia","lech","len","leper","lesbians","lesbo","lesbos","lez","lezbian","lezbians","lezbo","lezbos","lezzie","lezzies","lezzy","lmao","lmfao","loin","loins","lube","lust","lusting","lusty","m-fucking","mafugly","mams","masochist","massa","masterb8","masterbate","masterbating","masterbation","masterbations","masturbate","masturbating","masturbation","maxi","menses","menstruate","menstruation","meth","milf","mofo","molest","moolie","moron","mothafuck","mothafucka","mothafuckas","mothafuckaz","mothafucked","mothafucker","mothafuckers","mothafuckin","mothafucking","mothafuckings","mothafucks","motherfuck","motherfucka","motherfucked","motherfucker","motherfuckers","motherfuckin","motherfucking","motherfuckings","motherfuckka","motherfucks","mtherfucker","mthrfucker","mthrfucking","muff","muffdiver","muffpuff","murder","mutha","muthafecker","muthafuckaz","muthafucker","muthafuckker","muther","mutherfucker","mutherfucking","muthrfucking","nad","nads","naked","napalm","nappy","nazi","nazism","needthedick","negro","nig","nigg","nigga","niggah","niggas","niggaz","nigger","niggers","niggle","niglet","nimrod","ninny","nipple","nipples","nob","nobhead","nobjocky","nobjokey","nooky","nude","nudes","numbnuts","nutbutter","nutsack","nympho","omg","opiate","opium","oral","orally","organ","orgasim","orgasims","orgasm","orgasmic","orgasms","orgies","orgy","ovary","ovum","ovums","paddy","paki","pantie","panties","panty","pastie","pasty","pawn","pcp","pecker","pedo","pedophile","pedophilia","pedophiliac","pee","peepee","penetrate","penetration","penial","penile","penis","penisfucker","perversion","peyote","phalli","phallic","phonesex","phuck","phuk","phuked","phuking","phukked","phukking","phuks","phuq","pigfucker","pillowbiter","pimp","pimpis","pinko","piss","pissed","pisser","pissers","pisses","pissflaps","pissin","pissing","pissoff","playboy","pms","polack","pollock","poon","poontang","poop","porn","porno","pornography","pornos","pot","potty","prick","pricks","prig","pron","prostitute","prude","pube","pubic","pubis","punkass","punky","puss","pusse","pussi","pussies","pussy","pussyfart","pussypalace","pussypounder","pussys","puto","queaf","queef","queer","queero","queers","quicky","quim","racy","rape","raped","raper","raping","rapist","raunch","rectal","rectum","rectus","reefer","reetard","reich","retard","retarded","revue","rimjaw","rimjob","rimming","ritard","rtard","rum","rump","rumprammer","ruski","sadism","sadist","sandbar","sausagequeen","scag","scantily","schizo","schlong","screw","screwed","screwing","scroat","scrog","scrot","scrote","scrotum","scrud","scum","seaman","seamen","seduce","semen","sex","sexual","shag","shagger","shaggin","shagging","shamedame","shemale","shibari","shibary","shit","shitdick","shite","shiteater","shited","shitey","shitface","shitfuck","shitfucker","shitfull","shithead","shithole","shithouse","shiting","shitings","shits","shitt","shitted","shitter","shitters","shitting","shittings","shitty","shiz","shota","sissy","skag","skank","slave","sleaze","sleazy","slope","slut","slutbucket","slutdumper","slutkiss","sluts","smegma","smut","smutty","snatch","sniper","snuff","sob","sodom","son-of-a-bitch","souse","soused","spac","sperm","spic","spick","spik","spiks","spooge","spunk","steamy","stfu","stiffy","stoned","strip","strip club","stripclub","stroke","stupid","suck","sucked","sucking","sumofabiatch","tampon","tard","tawdry","teabagging","teat","teets","teez","terd","teste","testee","testes","testical","testicle","testis","threesome","throating","thrust","thug","tinkle","tit","titfuck","titi","tits","titt","tittiefucker","titties","titty","tittyfuck","tittyfucker","tittywank","titwank","toke","toots","tosser","tramp","transsexual","trashy","tubgirl","turd","tush","twat","twathead","twats","twatty","twunt","twunter","ugly","undies","unwed","urinal","urine","uterus","uzi","vag","vagina","vaginas","valium","viagra","vigra","virgin","vixen","vodka","vomit","voyeur","vulgar","vulva","wad","wang","wank","wanker","wanky","wazoo","wedgie","weed","weenie","weewee","weiner","weirdo","wench","wetback","whitey","whiz","whoar","whoralicious","whore","whorealicious","whored","whoreface","whorehopper","whorehouse","whores","whoring","wigger","willies","willy","womb","woody","woose","wop","wtf","x-rated2g1c","xx","xxx","yaoi","yury"];function Oo(e){return Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oo(e)}function To(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jo(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */jo=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return E()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function h(){}function f(){}function d(){}var p={};s(p,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(A([])));g&&g!==t&&n.call(g,o)&&(p=g);var y=d.prototype=h.prototype=Object.create(p);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==Oo(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=d,s(y,"constructor",d),s(d,"constructor",f),f.displayName=s(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(b.prototype),s(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new b(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function Po(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Lo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Po(i,r,o,a,s,"next",e)}function s(e){Po(i,r,o,a,s,"throw",e)}a(void 0)}))}}var Io,Do,Co,Mo,Fo="",Ko=!1,No=void 0,Ro=void 0,Bo=function(e){new Date;(Fo=new yo(e)).version(1).stores({documents:"++id, indexed_at, created_at, site, site_identifier, content, metadata, score, use_count, site_username, css_identifier, url, deleted_at",sections:"++id, parentid, content"}),No=new Eo.Index({language:"us"}),Ro=new Eo.Document({document:{id:"id",index:[{field:"content",language:"us"},{field:"parentid"}]}}),Fo.documents.count().then((function(e){e>0&&Fo.documents.toArray().then((function(e){e.forEach((function(e){No.add(e.id,e.content)}))}))})),Fo.sections.toArray().then((function(e){e.forEach((function(e){var t;Ro.add({id:e.id,content:null===(t=e.content)||void 0===t?void 0:t.toLowerCase(),parentid:e.parentid})}))}))},qo=function(){var e=Lo(jo().mark((function e(t){var n,r;return jo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Fo.documents){e.next=7;break}return n="",n="reset"===t?"":t,e.next=5,Fo.documents.filter((function(e){return!e.deleted_at&&e.site&&e.site.includes(n)})).count();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),zo=function(){var e=Lo(jo().mark((function e(t){var n,r,o,i,a;return jo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.pageNo,r=t.pageLimit,o=t.filterParams,i="",i="reset"===o.platform?"":o.platform,!Fo.documents){e.next=11;break}return e.next=6,Fo.documents.filter((function(e){return console.log(e),o.platform.length>0?!e.deleted_at&&e.site&&e.site.includes(i):!e.deleted_at})).offset(n*r).limit(r).toArray();case 6:return a=e.sent,e.abrupt("return",a);case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Uo=function(){var e=Lo(jo().mark((function e(t,n){var r,o,i,a;return jo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Fo.sections.where("parentid").equals(n).delete();case 3:for(Ro.remove({parentid:n}),r=[],o=(null==t?void 0:t.split(/[.?!]/))||[],i="",a=0;a<o.length;a++)o[a].length>0&&(i+=o[a]+"."),i.length>0&&(a%4==0||a===o.length-1)&&(Go(i)&&r.push({id:Math.floor(1e10*Math.random()),content:i.toLowerCase(),parentid:n}),i="");return e.next=11,Fo.sections.bulkAdd(r);case 11:e.sent,r.forEach((function(e){Ro.add({id:e.id,content:e.content,parentid:e.parentid})}));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Go=function(e){var t,n,r,o,i,a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,c=[];s?c=null!=s&&null!==(n=s.settings)&&void 0!==n&&n.excludedWords?null==s||null===(r=s.settings)||void 0===r||null===(o=r.excludedWords)||void 0===o||null===(i=o.toString())||void 0===i||null===(a=i.split(","))||void 0===a?void 0:a.filter((function(e){return!!e.trim()})):[]:c=So;if(c=null===(t=c)||void 0===t?void 0:t.filter((function(e){return!!e.trim()})).map((function(e){return"\\b".concat(e,"\\b")})),c.length){var u,l=new RegExp(null===(u=c)||void 0===u?void 0:u.join("|"),"gi");if(e.match(l))return!1}return!0},Wo=function(){var e=Lo(jo().mark((function e(t){var n,r,o,i,a,s,c,u,l,h,f,d,p,m,g;return jo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.createdAt,r=t.site,o=t.siteIdentifier,i=t.content,a=t.metadata,s=t.score,c=t.useCount,u=t.siteUsername,l=t.cssIdentifier,t.id,h=t.url,f=t.manual,d=new Date,p=!0,f){e.next=8;break}return e.next=7,Hi().then((function(e){return Go(i,e)}));case 7:p=e.sent;case 8:if(p){e.next=11;break}return console.log("failed filter, not saving"),e.abrupt("return",{status:"unsaved",message:"User filter"});case 11:if(!r){e.next=17;break}return e.next=14,Fo.documents.where({site:r,site_identifier:o}).first();case 14:e.t0=e.sent,e.next=20;break;case 17:return e.next=19,Fo.documents.where({site_identifier:o}).first();case 19:e.t0=e.sent;case 20:if(m=e.t0,g=null,!m){e.next=30;break}return e.next=26,Fo.documents.update(m.id,{indexed_at:(new Date).getTime(),created_at:n,site:r,site_identifier:o,content:i,metadata:a,score:s,use_count:c,site_username:u,css_identifier:l,url:h,deleted_at:null});case 26:g=e.sent,No.update(g,i),e.next=34;break;case 30:return e.next=32,Fo.documents.add({indexed_at:(new Date).getTime(),created_at:n,site:r,site_identifier:o,content:i,metadata:a,score:s,use_count:c,site_username:u,css_identifier:l,url:h,deleted_at:null});case 32:g=e.sent,No.add(g,i);case 34:return e.next=36,Uo(i,g);case 36:return console.log("indexDocument took ".concat(new Date-d,"ms")),e.abrupt("return",{status:"saved",message:"Document indexed"});case 38:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$o=function(){var e=Lo(jo().mark((function e(t){var n,r,o,i;return jo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,t.site,r=t.siteIdentifier,o="",!n){e.next=10;break}return o=n,e.next=7,Fo.documents.update(n,{content:null,metadata:null,deleted_at:(new Date).getTime()});case 7:No.remove(n),e.next=20;break;case 10:return e.next=13,Fo.documents.where({site_identifier:r}).first();case 13:if(!(i=e.sent)){e.next=20;break}return o=i.id,e.next=19,Fo.documents.update(o,{content:null,metadata:null,deleted_at:(new Date).getTime()});case 19:No.remove(o);case 20:return e.next=23,Fo.sections.where("parentid").equals(o).delete();case 23:Ko,Ro.search(o,{index:["parentid"]}).forEach((function(e){var t;null===(t=e.result)||void 0===t||t.forEach((function(e){Ro.remove(e)}))}));case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Jo=function(){var e=Lo(jo().mark((function e(t){var n,r,o;return jo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.site,r=t.siteIdentifier,!n){e.next=8;break}return e.next=5,Fo.documents.where({site:n,site_identifier:r}).first();case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,Fo.documents.where({site_identifier:r}).first();case 10:e.t0=e.sent;case 11:if(!(o=e.t0)){e.next=19;break}if(!o.deleted_at||o.content){e.next=16;break}return e.abrupt("return",-1);case 16:return e.abrupt("return",{results:To({},r,"saved")});case 19:return e.abrupt("return",{results:To({},r,"unsaved")});case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vo=function(){var e=Lo(jo().mark((function e(t){var n,r,o,i,a,s,c,u,l,h,f,d=arguments;return jo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d.length>1&&void 0!==d[1]?d[1]:void 0,t){e.next=3;break}return e.abrupt("return",[]);case 3:if(o="",!r){e.next=10;break}return e.next=7,Fo.documents.where({site_identifier:r}).first();case 7:(i=e.sent)&&(o=i.id);case 10:if((a=No.search(t,5,{suggest:!0}))&&o&&(a=a.filter((function(e){return e!==o}))),s=Ro.search({parentid:a,index:["content"],query:t.trim(),expand:!0,suggest:!0,limit:6}),c=[],null==(u=null==s||null===(n=s[0])||void 0===n?void 0:n.result)||!u.length){e.next=28;break}Ko,l=0;case 20:if(!(l<u.length)){e.next=28;break}return e.next=23,Fo.sections.get(u[l]);case 23:(h=e.sent)&&(f=h.content,c.push({text:f}));case 25:l++,e.next=20;break;case 28:return e.abrupt("return",c);case 30:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Yo(e){return Yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yo(e)}function Ho(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ho=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return E()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function h(){}function f(){}function d(){}var p={};s(p,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(A([])));g&&g!==t&&n.call(g,o)&&(p=g);var y=d.prototype=h.prototype=Object.create(p);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==Yo(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=d,s(y,"constructor",d),s(d,"constructor",f),f.displayName=s(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(b.prototype),s(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new b(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function Qo(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Zo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Qo(i,r,o,a,s,"next",e)}function s(e){Qo(i,r,o,a,s,"throw",e)}a(void 0)}))}}var Xo=!0,ei=function(){return!(Io||Co)&&Xo},ti="tokens",ni="token",ri=function(){var e=Zo(Ho().mark((function e(t){return Ho().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Xo){e.next=2;break}return e.abrupt("return",null);case 2:if(!Co){e.next=23;break}if(!(Mo<Date.now())){e.next=20;break}if(!Io){e.next=18;break}if(!(Do>=Date.now())){e.next=18;break}return e.next=8,ra({refreshToken:Io}).catch((function(e){console.log("error getting new token",e)}));case 8:if("clear"!==(Co=e.sent)){e.next=12;break}return ai(),e.abrupt("return",null);case 12:if("disable"!==Co){e.next=16;break}return Xo=!1,ai(),e.abrupt("return",null);case 16:case 35:return Mo=Date.now()+6e4,e.abrupt("return",Co);case 18:e.next=21;break;case 20:return e.abrupt("return",Co);case 21:case 37:e.next=42;break;case 23:if(!Io){e.next=39;break}if(!(Do>=Date.now())){e.next=37;break}return e.next=27,ra({refreshToken:Io}).catch((function(e){console.log("error getting new token",e)}));case 27:if("clear"!==(Co=e.sent)){e.next=31;break}return ai(),e.abrupt("return",null);case 31:if("disable"!==Co){e.next=35;break}return Xo=!1,ai(),e.abrupt("return",null);case 39:if(!t){e.next=42;break}return e.next=42,ci(t);case 42:return e.abrupt("return",null);case 43:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oi=function(){return new Promise((function(e,t){var n=indexedDB.open("tokenDB",1);n.onerror=function(e){console.error("Failed to open database:",e.target.error),t(e.target.error)},n.onsuccess=function(t){var n=t.target.result;e(n)},n.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(ti)||t.createObjectStore(ti)}}))},ii=function(e){return new Promise((function(t,n){e&&oi().then((function(r){var o=r.transaction(ti,"readwrite");o.objectStore(ti).put(e,ni),o.onerror=function(e){console.error("Failed to save token:",e.target.error),n(e.target.error)},o.oncomplete=function(n){t(e)}})).catch((function(e){n(e)}))}))};new Promise((function(e,t){oi().then((function(n){var r=n.transaction(ti,"readonly").objectStore(ti).get(ni);r.onerror=function(e){console.error("Failed to load token:",e.target.error),t(e.target.error)},r.onsuccess=function(){var t=Zo(Ho().mark((function t(n){var r,o,i,a,s;return Ho().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r="";try{r=n.target.result}catch(t){e(null)}return o=si(r),(i=o["https://example.com/email"])&&Bo(i),Io=r,Do=o.exp,t.next=9,ra({refreshToken:Io}).catch((function(e){console.log("error getting otherside token",e)}));case 9:return(a=t.sent)&&(Co=a,s=si(a),Mo=s.exp),t.abrupt("return",e(r));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})).catch((function(e){t(e)}))}));var ai=function(){return new Promise((function(e,t){oi().then((function(e){e.transaction(ti,"readwrite").objectStore(ti).clear()}))}))},si=function(e){try{var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(n)}catch(e){return{}}},ci=function(){var e=Zo(Ho().mark((function e(t){var n,r,o,i;return Ho().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[tryGettingOthersideRefreshToken] - STARTING"),e.next=3,oa({accessToken:t}).catch((function(e){console.log("error getting otherside token",e)}));case 3:if(!(n=e.sent)){e.next=17;break}if(console.log("new token!",n),Io=n,(r=si(n)).exp){e.next=10;break}return e.abrupt("return",null);case 10:return e.next=12,ii(n);case 12:return Do=null==r?void 0:r.exp,e.next=15,ra({refreshToken:n}).catch((function(e){console.log("error getting otherside token",e)}));case 15:(o=e.sent)&&(Co=o,i=si(o),Mo=i.exp);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function ui(e){return ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ui(e)}function li(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */li=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return E()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function h(){}function f(){}function d(){}var p={};s(p,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(A([])));g&&g!==t&&n.call(g,o)&&(p=g);var y=d.prototype=h.prototype=Object.create(p);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==ui(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=d,s(y,"constructor",d),s(d,"constructor",f),f.displayName=s(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(b.prototype),s(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new b(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function hi(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function fi(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){hi(i,r,o,a,s,"next",e)}function s(e){hi(i,r,o,a,s,"throw",e)}a(void 0)}))}}var di=function(e){return new Q(e)}({domain:"auth.hyperwriteai.com",client_id:"RNaZU55raZSUW4936PUhkEuGYyIxRZ77",audience:"https://hyperwrite.ai/",scope:"openid profile email",redirect_uri:"chrome-extension://kljjoeapehcmaphfcjkmbhkinoaopdnd/auth.html",debug:!1}),pi=!1,mi=0,gi="",yi=0,vi=0,bi="",wi="",xi=0,ki=function(e){return gi&&yi&&vi>Date.now()-e?"good":!gi&&mi>1&&Date.now()-yi<1e3?"login_required"===wi?{error:"login_required"}:{error:"Too Frequent, requests made a second ago"}:null},_i=0;function Ai(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:65e3;return Date.now()-_i<1e3&&ei()?(console.log("rejecting cause too frequent"),{error:"Too Frequent, requests made a second ago"}):(_i=Date.now(),mi+=1,new Promise(function(){var r=fi(li().mark((function r(o,i){var a,s,c,u;return li().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=null,!e.USE_OTHERSIDE_TOKEN){r.next=5;break}return r.next=4,ri(gi);case 4:a=r.sent;case 5:if(!a){r.next=10;break}return o(a),r.abrupt("return");case 10:if(!(s=ki(n))){r.next=14;break}return"good"===s?o(gi):i(s),r.abrupt("return");case 14:s||(yi=Date.now(),c=setTimeout((function(){setTimeout((function(){xi<1&&Se({name:"Error - auth timed out on iFrame"})}),3e3),xi+=1,i(new Error("timeout on getTokenSilently"))}),t),u=!gi,di.getTokenSilently({ignoreCache:u}).then(function(){var e=fi(li().mark((function e(t){var n,r,a,s;return li().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:pi,!vi||Date.now()-vi>100?(n=si(t),r=n.sub||"",a=n["https://example.com/emailVerified"]||"",bi=n["https://example.com/email"],chrome.storage.local.set({hyperwriteEmail:bi}),Bo(bi),s=n["https://example.com/userid"],r.startsWith("auth")&&!a||!s?!r.startsWith("auth")||a?o(t):(wi="",i("login error")):(gi=t,vi=Date.now(),o(t))):i(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){"login_required"===(null==e?void 0:e.error)&&(wi="login_required"),i(e)})).catch((function(e){console.log(" do we get this error? ",e)})).finally((function(){return clearTimeout(c)})));case 15:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()))}function Ei(e){return Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ei(e)}function Si(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Si(Object(n),!0).forEach((function(t){Ti(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Si(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ti(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ji(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ji=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return E()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function h(){}function f(){}function d(){}var p={};s(p,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(A([])));g&&g!==t&&n.call(g,o)&&(p=g);var y=d.prototype=h.prototype=Object.create(p);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==Ei(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=d,s(y,"constructor",d),s(d,"constructor",f),f.displayName=s(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(b.prototype),s(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new b(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function Pi(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Li(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Pi(i,r,o,a,s,"next",e)}function s(e){Pi(i,r,o,a,s,"throw",e)}a(void 0)}))}}var Ii=e.BASE_URL,Di=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.suggestionKey,r=t.option,o=Ii+"/acceptsuggestion",e.next=4,Ai();case 4:return i=e.sent,(a=new FormData).append("key",n),a.append("option",r),e.next=10,fetch(o,{method:"POST",body:a,headers:{Authorization:"Bearer ".concat(i)}}).then((function(e){return e.json()})).catch((function(e){console.info(e)}));case 10:return s=e.sent,e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ci=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s,c,u,l,h,f,d,p,m,g,y,v,b,w,x,k;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.command,r=t.blocks,o=t.key,i=t.offset,a=t.description,s=t.title,c=t.documentMetadata,u=t.infos,l=t.testing,h=void 0!==l&&l,f=t.format,t.complete,d=t.sentenceLength,p=void 0===d?"":d,m=t.facts,g=void 0===m?"":m,y=t.accessToken,v=t.isImage,b=void 0!==v&&v,!h){e.next=3;break}return e.abrupt("return",{results:["1","2","3","4"],key:"foo"});case 3:return w=Ii+"/commandSuggestions",b&&(c=Oi(Oi({},c),{},{method:"image"})),(x=new FormData).append("command",n),x.append("blocks",JSON.stringify(r)),x.append("origin","extension"),x.append("key",o),x.append("offset",i),x.append("version","0.0.3"),a?x.append("description",a):x.append("description",""),c&&x.append("metadata",JSON.stringify(c)),x.append("title",s),x.append("infos",JSON.stringify(u)),x.append("format",f),""!==p&&x.append("sentenceLength",p),g&&x.append("facts",g),e.next=21,fetch(w,{method:"POST",body:x,headers:{Authorization:"Bearer ".concat(y)}}).then((function(e){return e.json()})).then((function(e){return"expired token"===(null==e?void 0:e.status)?{expiredToken:!0}:e})).catch((function(e){return console.log("error",e),{}}));case 21:return k=e.sent,e.abrupt("return",k);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Mi=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s,c,u;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.key,r=t.index,o=t.text,i=t.testing,!(void 0!==i&&i)){e.next=4;break}return console.log({key:n,index:r,text:o}),e.abrupt("return","");case 4:return a=Ii+"/acceptCommandSuggestion",e.next=7,Ai();case 7:return s=e.sent,(c=new FormData).append("key",n),c.append("option",r),c.append("editedtext",o),e.next=14,fetch(a,{method:"POST",body:c,headers:{Authorization:"Bearer ".concat(s)}}).then((function(e){return e.json()})).catch((function(e){return console.log("error",e),{}}));case 14:return u=e.sent,e.abrupt("return",u);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fi=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s,c,u;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.feedback,r=t.type,o=Ii+"/submitFeedback",i=chrome.runtime.getManifest().version,a={app:"extension",type:r,version:i},e.next=6,Ai();case 6:return s=e.sent,console.log("got token, accessToken",s),c=new FormData,"opinion"===r?c.append("feedback","Extension feedback - "+n):c.append("feedback","Extension bug - "+n),c.append("metadata",JSON.stringify(a)),c.append("requestsResponse","true"),e.next=14,fetch(o,{method:"POST",body:c,headers:{Authorization:"Bearer ".concat(s)}}).then((function(e){e.json()})).catch((function(e){console.info(e)}));case 14:return u=e.sent,e.abrupt("return",u);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ki=function(){var t=Li(ji().mark((function t(n){var r,o,i,a,s,c,u,l,h,f,d,p,m,g,y,v,b,w,x,k;return ji().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.text,o=n.rewriteType,i=void 0===o?"Casual":o,a=n.customText,s=void 0===a?"":a,c=n.testing,u=void 0!==c&&c,l=n.site,h=n.priorText,f=void 0===h?"":h,d=n.method,p=void 0===d?void 0:d,m=n.rawText,g=void 0!==m&&m,y=n.settings,v=void 0===y?{}:y,!u&&!e.TESTING_REWRITE){t.next=3;break}return t.abrupt("return",{options:["1","2","3"],key:"26b67992-07cf-4221-be67-3680b167a18c"});case 3:return t.next=5,Ai();case 5:return b=t.sent,w=new FormData,"Custom"!==i?w.append("rewriteType",i):w.append("rewriteType",s),w.append("quotedtext",r),w.append("origin","extension"),w.append("site",l),f&&w.append("priorText",f),p&&w.append("method",p),w.append("rawText",g),w.append("settings",JSON.stringify(v)),x={method:"POST",body:w,headers:{Authorization:"Bearer ".concat(b)}},t.next=18,fetch(Ii+"/rewrite",x).then((function(e){return e.json()})).then((function(e){return"expired token"===(null==e?void 0:e.status)?{expiredToken:!0}:e})).catch((function(e){return console.log("Error rewriting text",e),[{}]}));case 18:return k=t.sent,t.abrupt("return",k);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ni=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.key,r=t.option,o=Ii+"/acceptRewrite",e.next=4,Ai();case 4:return i=e.sent,(a=new FormData).append("key",n),a.append("option",r),e.next=10,fetch(o,{method:"POST",body:a,headers:{Authorization:"Bearer ".concat(i)}}).then((function(e){return e.json()})).catch((function(e){console.info(e)}));case 10:return s=e.sent,e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ri=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.source,r=t.source_identifier,o=Ii+"/loadExternalSettings",e.next=4,Ai();case 4:return i=e.sent,(a=new FormData).append("source",n),a.append("source_identifier",r),e.next=10,fetch(o,{method:"POST",body:a,headers:{Authorization:"Bearer ".concat(i)}}).then((function(e){return e.json()})).catch((function(e){console.info(e)}));case 10:return s=e.sent,e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Bi=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s,c;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.source,r=t.source_identifier,o=t.settings,i=Ii+"/saveExternalSettings",e.next=4,Ai();case 4:return a=e.sent,(s=new FormData).append("source",n),s.append("source_identifier",r),s.append("settings",JSON.stringify(o)),e.next=11,fetch(i,{method:"POST",body:s,headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){return e.json()})).catch((function(e){console.info(e)}));case 11:return c=e.sent,e.abrupt("return",c);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qi=function(){var e=Li(ji().mark((function e(){var t,n;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ai();case 2:return t=e.sent,n={method:"GET",headers:{Authorization:"Bearer ".concat(t)}},e.next=6,fetch(Ii+"/checkAvailableModels",n).then((function(e){return e.json()})).catch((function(e){return console.log("error in API",e),e}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),zi=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s,c,u;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.source,r=t.sourceId,o=t.text,i=t.title,a=t.id,e.next=3,Ai();case 3:return s=e.sent,(c=new FormData).append("text",o),c.append("origin","GoogleDocs"),c.append("title",i),c.append("source",n),c.append("sourceId",r),a&&c.append("id",a),u={method:"POST",body:c,headers:{Authorization:"Bearer ".concat(s)}},e.abrupt("return",fetch(Ii+"/save_external_document",u).then((function(e){return e.json()})).catch((function(e){return e})));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ui=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.source,r=t.sourceId,e.next=3,Ai();case 3:return o=e.sent,(i=new FormData).append("source",n),i.append("sourceId",r),a={method:"POST",body:i,headers:{Authorization:"Bearer ".concat(o)}},e.abrupt("return",fetch(Ii+"/view_linked_external_documents",a).then((function(e){return e.json()})).catch((function(e){return e})));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Gi=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.source,o=t.sourceId,e.next=3,Ai();case 3:return i=e.sent,(a=new FormData).append("id",n),a.append("source",r),a.append("sourceId",o),s={method:"POST",body:a,headers:{Authorization:"Bearer ".concat(i)}},e.abrupt("return",fetch(Ii+"/delete_external_document",s).then((function(e){return e.json()})).catch((function(e){return e})));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Wi=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.source,o=t.sourceId,e.next=3,Ai();case 3:return i=e.sent,(a=new FormData).append("source",r),a.append("sourceId",o),a.append("id",n),s={method:"POST",body:a,headers:{Authorization:"Bearer ".concat(i)}},e.abrupt("return",fetch(Ii+"/load_external_document",s).then((function(e){return e.json()})).catch((function(e){return e})));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$i=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ids,r=t.source,o=t.sourceId,e.next=3,Ai();case 3:return i=e.sent,(a=new FormData).append("source",r),a.append("sourceId",o),a.append("ids",n.join("\n")),s={method:"POST",body:a,headers:{Authorization:"Bearer ".concat(i)}},e.abrupt("return",fetch(Ii+"/load_external_sources",s).then((function(e){return e.json()})).catch((function(e){return e})));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ji=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s,c,u;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.content_type,r=t.related_content,o=t.reason,i=t.user_comment,e.next=3,Ai();case 3:return a=e.sent,s=Ii+"/submitSuggestionFeedback",(c=new FormData).append("content_type",n),c.append("related_content",r),c.append("reason",o),c.append("user_comment",i),e.next=12,fetch(s,{method:"POST",body:c,headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){return console.log("content feedback save fired",e)})).catch((function(e){return console.log("error",e),{}}));case 12:return u=e.sent,e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Vi=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.settings,e.next=3,Ai();case 3:return r=e.sent,o=Ii+"/saveUserExternalSettings",(i=new FormData).append("settings",JSON.stringify(n)),e.next=9,fetch(o,{method:"POST",body:i,headers:{Authorization:"Bearer ".concat(r)}}).then((function(e){return e.json()})).catch((function(e){console.info(e)}));case 9:return a=e.sent,e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Yi=function(){var e=Li(ji().mark((function e(t){var n,r,o,i;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ii+"/registerEmailFeedback",e.next=3,Ai();case 3:return r=e.sent,(o=new FormData).append("acceptedCharacterCount",t.acceptedCharacterCount),o.append("acceptedTypeaheadCount",t.acceptedTypeaheadCount),o.append("feedback",t.feedback),o.append("shownTypeaheadCount",t.shownTypeaheadCount),o.append("toggledTypeaheadCount",t.toggledTypeaheadCount),i={method:"POST",body:o,headers:{Authorization:"Bearer ".concat(r)}},e.abrupt("return",fetch(n,i).then((function(e){return e.json()})).catch((function(e){return e})));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Hi=function(){var e=Li(ji().mark((function e(){var t,n,r,o;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ii+"/loadUserExternalSettings",e.next=3,Ai();case 3:return n=e.sent,(r=new FormData).append("subscriptionData","true"),o={method:"POST",body:r,headers:{Authorization:"Bearer ".concat(n)}},e.abrupt("return",fetch(t,o).then((function(e){return e.ok?e.json():{success:!1}})).catch((function(e){return console.log("error: ",e),e})));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Qi=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.searchPhrase,r=t.source,o=t.sourceId,e.next=3,Ai();case 3:return i=e.sent,(a=new FormData).append("searchPhrase",n),a.append("source",r),a.append("sourceId",o),s={method:"POST",body:a,headers:{Authorization:"Bearer ".concat(i)}},e.abrupt("return",fetch(Ii+"/getSimilarFromSources",s).then((function(e){return e.json()})).catch((function(e){return e})));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Zi=function(){var e=Li(ji().mark((function e(){var t,n;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ai();case 2:return t=e.sent,n={method:"POST",headers:{Authorization:"Bearer ".concat(t)}},e.abrupt("return",fetch(Ii+"/checkInvitesRemaining",n).then((function(e){return e.json()})).catch((function(e){return e})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Xi=function(){var e=Li(ji().mark((function e(){var t,n;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ai();case 2:return t=e.sent,n={method:"POST",headers:{Authorization:"Bearer ".concat(t)}},e.abrupt("return",fetch(Ii+"/generateInviteCode",n).then((function(e){return e.json()})).catch((function(e){return e})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ea=function(){var e=Li(ji().mark((function e(t){var n,r,o,i,a,s;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.site,r=t.successFailure,o=t.time,i=new FormData,e.next=4,Ai();case 4:return a=e.sent,i.append("site",n),i.append("successFailure",r),i.append("time",o),s={method:"POST",body:i,headers:{Authorization:"Bearer ".concat(a)}},e.abrupt("return",fetch(Ii+"/genSuccessFailure",s).then((function(e){return e.json()})).catch((function(e){return e})));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ta=function(){var e=Li(ji().mark((function e(t){var n,r,o,i;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.site,r=new FormData,e.next=4,Ai();case 4:return o=e.sent,r.append("site",n),i={method:"POST",body:r,headers:{Authorization:"Bearer ".concat(o)}},e.abrupt("return",fetch(Ii+"/logSlowInstance",i).then((function(e){return e.json()})).catch((function(e){return e})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),na=function(){var e=Li(ji().mark((function e(t){var n,r,o,i;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.hash,e.next=3,Ai();case 3:return r=e.sent,(o=new FormData).append("oldHash",n),i={method:"POST",body:o,headers:{Authorization:"Bearer ".concat(r)}},e.abrupt("return",fetch(Ii+"/checkCommandTemplates",i).then((function(e){return e.json()})).catch((function(e){return e})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ra=function(){var e=Li(ji().mark((function e(t){var n,r;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.refreshToken,r={method:"POST",headers:{Authorization:"Bearer ".concat(n)}},e.abrupt("return",fetch("https://api.hyperwriteai.com/getOthersideAccessToken",r).then((function(e){return e.json()})).then((function(e){return null==e?void 0:e.token})).catch((function(e){return null})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oa=function(){var e=Li(ji().mark((function e(t){var n,r;return ji().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.accessToken,r={method:"POST",headers:{Authorization:"Bearer ".concat(n)}},e.abrupt("return",fetch("https://api.hyperwriteai.com/getOthersideRefreshToken",r).then((function(e){return e.json()})).then((function(e){return null==e?void 0:e.token})).catch((function(e){return null})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function ia(e){return ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ia(e)}function aa(e){return function(e){if(Array.isArray(e))return sa(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return sa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sa(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ca(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ca=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof h?t:h,i=Object.create(o.prototype),a=new _(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return E()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function h(){}function f(){}function d(){}var p={};s(p,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(A([])));g&&g!==t&&n.call(g,o)&&(p=g);var y=d.prototype=h.prototype=Object.create(p);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==ia(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=d,s(y,"constructor",d),s(d,"constructor",f),f.displayName=s(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(b.prototype),s(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new b(c(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),s(y,o,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function ua(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function la(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ua(i,r,o,a,s,"next",e)}function s(e){ua(i,r,o,a,s,"throw",e)}a(void 0)}))}}function ha(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ha(Object(n),!0).forEach((function(t){da(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ha(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function da(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}try{var pa=function(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(n)},ma={"colab.research.google.com":!0,"hyperwriteai.com":!0,"www.youtube.com":!0,"app.slack.com":!0,"www.weebly.com":!0,"insight.adsrvr.org":!0,"www.netflix.com":!0,"docs.google.com/spreadsheets":!0,"twitter.com":!0},ga=-1,ya=[],va=function(){return ma},ba=function(e){chrome.tabs.reload(e.id)};chrome.runtime.onMessageExternal.addListener((function(e,t,n){console.log({request:e,sender:t})})),chrome.runtime.onInstalled.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("detail: ",n),console.log("detail.reason: ",n.reason),console.log("detail.previousVersion: ",n.previousVersion),r=chrome.runtime.getManifest(),console.log("manifestData.version: ",r.version),"install"===n.reason&&(console.log("Extension fresh install"),chrome.tabs.create({url:"https://hyperwriteai.com/documents"}),chrome.runtime.setUninstallURL("https://hyperwriteai.com/uninstall?user=not-defined-yet&typeahead=".concat(!0))),3e3,3,chrome.tabs.query({},function(){var t=la(ca().mark((function t(n){var r,o;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r=0;r<n.length;r++)o=n[r],e.AVOID_RELOAD||ba(o);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),chrome.runtime.onMessage.addListener((function(e,t,n){if("content"===e.from&&"showPageAction"===e.subject&&chrome.pageAction.show(t.tab.id),"submitFeedback"===e.apiRequest&&(Fi({feedback:e.text,type:e.type}).then((function(e){})),n("Feedback API request received")),"saveDocumentSettings"===e.apiRequest){try{var r=null==e?void 0:e.url.substr(35,44);Bi({source:e.source,source_identifier:r,settings:e.settings}).then((function(e){}))}catch(e){console.log("error: ",e)}n("message received")}if("saveUserSettings"===e.apiRequest){try{Vi({settings:e.settings}).then((function(e){}))}catch(e){console.log("error!: ",e)}n("message received")}if("reloadExtension"===e.request&&(n("reload message received"),chrome.runtime.reload()),"saveTypeAheadContentFeedback"===e.request){try{xe({feedback:e.feedback,metadata:e.metadata,user_comment:e.user_comment}).then((function(e){}))}catch(e){console.log("error!: ",e)}n("message received")}}));var wa=!1,xa=function(){var e=la(ca().mark((function e(t){var n,r,o,i;return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.site,r=t.isAuthed,o=t.port,i=t.email,chrome.storage.sync.set(da({},n+"_auth",r));try{o.postMessage({result:{authed:r,email:i},email:i,status:"complete",function:"checkAccessCall"})}catch(e){wa}case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ka=function(){var e=la(ca().mark((function e(t){var n,r,o;return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.site,r=t.email,o=t.port,chrome.storage.local.get(["activeSites"],function(){var e=la(ca().mark((function e(t){var i,a,s,c;return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=null==t?void 0:t.activeSites)||(a={},chrome.storage.local.set({activeSites:a})),s=!0,!va()[n]||null!==(i=a[n])&&void 0!==i&&i.isActive?a[n]&&(s=a[n].isActive):(s=!1,c=fa(fa({},a),{},da({},n,fa(fa({},a[n]),{},{isActive:!1}))),chrome.storage.local.set({activeSites:c})),e.next=8,xa({site:n,isAuthed:s,port:o,email:r});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_a=function(){var e=la(ca().mark((function e(t){var n,r;return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.site,r=t.isActive,chrome.storage.local.get(["activeSites"],function(){var e=la(ca().mark((function e(t){var o,i;return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=null==t?void 0:t.activeSites)?(i=fa(fa({},o),{},da({},n,fa(fa({},o[n]),{},{isActive:r}))),chrome.storage.local.set({activeSites:i})):(o=da({},n,{isActive:r}),chrome.storage.local.set({activeSites:o})),e.abrupt("return",{result:{isActive:r},status:"complete",function:"changeSiteActive"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Aa="";chrome.runtime.onConnect.addListener((function(e){if(["authentication"].includes(e.name)&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r,o,i,a;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("login"!==n.action){t.next=29;break}return chrome.storage.local.set({authenticated:!1},(function(){wa})),100,t.next=6,new Promise((function(e){return setTimeout(e,100)}));case 6:return r="",o="",t.prev=8,t.next=12,Ai(5e3).catch((function(t){o=t.error,"login_required"===(null==t?void 0:t.error)&&e.postMessage({function:"checkAccessCall",loginError:!0,status:"error"})}));case 12:r=t.sent,t.next=18;break;case 15:t.prev=15,t.t0=t.catch(8);case 18:if(chrome.storage.local.get(["authedId"],(function(e){var t="none";if(r){var n=pa(r)["https://example.com/userid"];!e.authedId&&n&&(chrome.storage.local.set({authedId:n},(function(){})),t=n)}chrome.runtime.setUninstallURL("https://hyperwriteai.com/uninstall?user=".concat(t,"&typeahead=",!0,"&"))})),!r){t.next=28;break}return i=pa(r),a=i["https://example.com/email"],chrome.storage.local.set({authenticated:!0},(function(){wa})),t.next=26,ka({site:n.site,email:a,port:e});case 26:t.next=29;break;case 28:"login_required"===o&&e.postMessage({function:"checkAccessCall",status:"error"});case 29:case"end":return t.stop()}}),t,null,[[8,15]])})));return function(e){return t.apply(this,arguments)}}()),"acceptGenerationOption"===e.name&&e.onMessage.addListener((function(t){Di({suggestionKey:t.key,option:t.index}).then((function(t){e.postMessage(t)}))})),"HyperCreate"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r,o;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="l3lb",t.next=3,Ai();case 3:o=t.sent,e.postMessage({purpose:"gotAuth"}),Ci({command:n.command,blocks:[{key:"l3la",text:n.text,type:"unstyled",depth:0,inlineStyleRanges:[],entityRanges:[],data:{}},{key:"l3lb",text:"",type:"unstyled",depth:0,inlineStyleRanges:[],entityRanges:[],data:{}}],key:r,offset:0,description:n.description,title:n.title,documentMetadata:n.documentMetadata,infos:{foo:{}},format:"",complete:"new",sentenceLength:n.sentenceLength,facts:n.facts,accessToken:o,isImage:n.isImage}).then((function(t){e.postMessage({options:t})}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"acceptCommandSuggestions"===e.name&&e.onMessage.addListener((function(e){Mi({key:e.key,index:e.index,text:e.text}).then((function(e){return console.log("response: ",e)}))})),"rewrite"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ki({text:n.text,rewriteType:n.rewriteType,customText:n.customText,site:n.site,priorText:n.priorText,method:n.method,rawText:n.rawText,settings:n.settings}).then((function(t){e.postMessage(t)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"acceptRewrite"===e.name&&e.onMessage.addListener((function(e){Ni({key:e.key,option:e.option}).then((function(e){return console.log("response: ",e)}))})),"loadDocumentSettings"===e.name)try{e.onMessage.addListener((function(t){var n=null==t?void 0:t.url.substr(35,44);Ri({source:t.source,source_identifier:n}).then((function(t){e.postMessage(t)}))}))}catch(t){e.postMessage(t)}if("registerEmailFeedback"===e.name)try{e.onMessage.addListener((function(t){Yi(t).then((function(t){e.postMessage(t)}))}))}catch(t){e.postMessage(t)}if("loadUserSettings"===e.name)try{e.onMessage.addListener((function(t){Hi().then((function(t){var n;if(null!=t&&t.disable_otherside_auth&&(!!Xo&&(ai(),Io=void 0,Do=void 0,Co=void 0,Mo=void 0,Xo=!1,!0)))return;if(null!=t&&t.enable_otherside_auth&&(!Xo&&(Xo=!0,Io=void 0,Do=void 0,Co=void 0,Mo=void 0,!0)))return;null!=t&&t.badSites&&(n=t.badSites.reduce((function(e,t){return e[t]=!0,e}),{}),ma=fa(fa({},ma),n)),e.postMessage(t)}))}))}catch(t){e.postMessage(t)}if("changeSiteActive"===e.name)try{e.onMessage.addListener((function(t){_a(t).then((function(t){e.postMessage(t)}))}))}catch(t){e.postMessage(t)}if("saveExternalDocument"===e.name)try{e.onMessage.addListener((function(t){zi({source:"GoogleDocs",sourceId:t.url.substr(35,44),text:t.text,title:t.title,id:t.id}).then((function(t){e.postMessage(t)}))}))}catch(t){e.postMessage(t)}if("viewExternalDocs"===e.name)try{e.onMessage.addListener((function(t){Ui({source:"GoogleDocs",sourceId:t.url.substr(35,44)}).then((function(t){e.postMessage(t)}))}))}catch(t){e.postMessage(t)}if("loadExternalSource"===e.name)try{e.onMessage.addListener((function(t){Wi({source:"GoogleDocs",sourceId:t.url.substr(35,44),id:t.id}).then((function(t){e.postMessage(t)}))}))}catch(t){e.postMessage(t)}if("deleteExternalSource"===e.name)try{e.onMessage.addListener((function(t){Gi({source:"GoogleDocs",sourceId:t.url.substr(35,44),id:t.id}).then((function(t){e.postMessage(t)}))}))}catch(t){e.postMessage(t)}if("loadExternalSources"===e.name)try{e.onMessage.addListener((function(t){$i({source:"GoogleDocs",sourceId:t.url.substr(35,44),ids:t.ids}).then((function(t){e.postMessage(t)}))}))}catch(t){e.postMessage(t)}if("searchExternalSources"===e.name)try{e.onMessage.addListener((function(t){Qi({searchPhrase:t.searchPhrase,source:"GoogleDocs",sourceId:t.url.substr(35,44)}).then((function(t){e.postMessage(t)}))}))}catch(t){e.postMessage(t)}if("checkModels"===e.name)try{e.onMessage.addListener((function(t){chrome.tabs.query({currentWindow:!0,active:!0},(function(){qi().then((function(t){e.postMessage(t)}))}))}))}catch(t){e.postMessage(t)}if("postGenerationFeedback"===e.name)try{e.onMessage.addListener((function(e){chrome.tabs.query({currentWindow:!0,active:!0},(function(t){Ji({content_type:e.content_type,related_content:e.related_content,reason:e.reason,user_comment:e.user_comment})}))}))}catch(t){e.postMessage(t)}if("saveContentToDatabase"===e.name)try{e.onMessage.addListener(function(){var e=la(ca().mark((function e(t){return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("got request: "),e.next=3,ye({id:t.id,text:t.text,title:t.title,sourceId:t.sourceId,url:t.url});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(t){e.postMessage(t)}if("saveExampleEmails"===e.name)try{e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.useLocal){t.next=10;break}return Se({name:"Indexing: Index local document",source:n.platform}),t.next=4,Wo({site:n.platform,siteIdentifier:n.id,url:n.url,content:n.text,id:n.id,manual:n.manual});case 4:return r=t.sent,console.log("saving locally"),e.postMessage(r),t.abrupt("return");case 10:return t.next=12,ve({id:n.id,text:n.text,from:n.from,url:n.url,platform:n.platform,metadata:n.metadata});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(t){e.postMessage(t)}if("checkSavedEmailIndexedStatus"===e.name)try{e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r,o;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.postMessage({status:"ack"}),r=!1,!n.useLocal){t.next=9;break}return o=n.email[0].id,t.next=6,Jo({siteIdentifier:o});case 6:r=t.sent,t.next=12;break;case 9:return t.next=11,we({email:n.email});case 11:r=t.sent;case 12:e.postMessage({indexedStatus:r,contentId:n.id});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}catch(t){e.postMessage(t)}if("removeExampleEmail"===e.name)try{e.onMessage.addListener(function(){var e=la(ca().mark((function e(t){return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("got remove request: "),!t.useLocal){e.next=6;break}Se({name:"Indexing: Delete local document",source:t.platform}),$o({siteIdentifier:t.id,site:t.platform}),e.next=8;break;case 6:return e.next=8,be({contentId:t.id,platform:t.platform});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(t){e.postMessage(t)}"getTypeAheads"===e.name&&e.onMessage.addListener((function(t){e.postMessage({status:"getting typeaheds"}),Ea({port:e,message:t})})),"listExampleEmails"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.postMessage({status:"getting typeaheds"}),t.next=3,ke({text:n.text,method:n.method});case 3:r=t.sent,e.postMessage(r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"getIndexDbCount"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.postMessage({status:"getting document count"}),t.next=3,qo(n.platform);case 3:r=t.sent,e.postMessage(r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"listIndexDbDocuments"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r,o,i,a;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.pageNo,o=n.pageLimit,i=n.filterParams,e.postMessage({status:"getting documents"}),t.next=4,zo({pageNo:r,pageLimit:o,filterParams:i});case 4:a=t.sent,e.postMessage(a);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"deleteIndexDbDocument"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.postMessage({status:"getting documents"}),t.next=3,$o(fa({},n));case 3:r=t.sent,e.postMessage(r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"saveMeasurements"===e.name&&e.onMessage.addListener((function(t){e.postMessage({status:"saving measurements"}),_e(t)})),"logAcceptedTypeahead"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.postMessage({status:"getting typeaheds"}),t.next=3,Ae({type:n.type,metadata:n.metadata,app:n.app});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"logShownTypeahead"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.postMessage({status:"getting typeaheds"}),t.next=3,Ee({type:n.type,app:n.app,metadata:n.metadata});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"triggerEvent"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r,o,i;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.postMessage({status:"triggering event"}),Aa&&(i=fa(fa({},null===(o=n)||void 0===o?void 0:o.metadata),{},{subscriptionStatus:Aa}),n=fa(fa({},n),{},{metadata:i})),null!==(r=n)&&void 0!==r&&r.source){t.next=6;break}chrome.tabs.query({active:!0,currentWindow:!0},function(){var e=la(ca().mark((function e(t){var r,o;return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[0],o=r.url.split("/")[2],n=fa(fa({},n),{},{source:o}),e.next=5,Se(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.next=8;break;case 6:return t.next=8,Se(n);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"checkInvitesRemaining"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.postMessage({status:"checking invites remaining"}),t.next=3,Zi();case 3:r=t.sent,e.postMessage({invitesRemaining:r,status:"complete"});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"generateInviteCode"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.postMessage({status:"generating invite code"}),t.next=3,Xi();case 3:r=t.sent,e.postMessage({inviteCode:r,status:"complete"});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"genSuccessFailure"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.postMessage({status:"genSuccessFailure"}),t.next=3,ea({site:n.site,successFailure:n.successFailure,time:n.time});case 3:r=t.sent,e.postMessage({successFailure:r,status:"complete"});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"logSlowInstance"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.postMessage({status:"logSlowInstance"}),t.next=3,ta({site:n.site});case 3:r=t.sent,e.postMessage({slowInstance:r,status:"complete"});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"loadTypeaheadAccess"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Oe();case 2:r=t.sent,e.postMessage({results:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"saveTypeaheadAccess"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Te(n);case 2:r=t.sent,e.postMessage({results:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"reloadTab"===e.name&&e.onMessage.addListener(function(){var e=la(ca().mark((function e(t){return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!=t&&t.reloadTab&&chrome.tabs.reload();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),"submitSurvey"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,je(n);case 2:t.sent,e.postMessage({});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"checkSurveyComplete"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Pe(n);case 2:r=t.sent,e.postMessage(r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"registerCompletedTypeahead"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Le(n);case 2:r=t.sent,e.postMessage(r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),"checkCommandTemplates"===e.name&&e.onMessage.addListener(function(){var t=la(ca().mark((function t(n){var r;return ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,na({hash:ga});case 2:(r=t.sent).templates&&(ga=r.hash,ya=r.templates),e.postMessage({templates:ya,update:!0,status:"complete"});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}));var Ea=function(){var e=la(ca().mark((function e(t){var n,r,o,i,a,s,c;return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.port,o=t.message,i=o.typeaheadMetadata,null!==(n=i)&&void 0!==n&&n.history&&(i.history=[].concat(aa(i.history),[{time:(new Date).getTime(),function:"background_leaving_callTypeahead",timeTaken:(new Date).getTime()-i.history.slice(-1)[0].time}])),a=o.contentIdentifier||"",s=new Date,c=[],o.ignoreSearch){e.next=16;break}return e.prev=7,e.next=10,Vo(o.text,a);case 10:c=e.sent,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7);case 16:(new Date).getTime()-s.getTime(),ge({isEarlyTypeahead:o.isEarlyTypeahead,typeaheadMetadata:i,text:o.text,title:o.title,description:o.description,history:o.history,priorText:o.priorText,email:o.email,doSpeedy:o.doSpeedy,app:o.app,history_format:o.history_format,metadata:o.metadata,temperature:o.temperature,gens:o.generations,tokens:o.length,reason:o.reason,similarSnippets:c}).then((function(e){var t,n;null!==(t=i=null==e?void 0:e.typeaheadMetadata)&&void 0!==t&&t.history&&(i.history=[].concat(aa(i.history),[{time:(new Date).getTime(),function:"background_returning_callTypeahead",timeTaken:(new Date).getTime()-i.history.slice(-1)[0].time}])),null!=e&&null!==(n=e.experiments)&&void 0!==n&&n.subscriptionTier&&(Aa=e.experiments.subscriptionTier),r.postMessage(fa(fa({},e),{},{typeaheadMetadata:i,options:null==e?void 0:e.choices,key:null==o?void 0:o.key,function:"doTypeahead",status:"complete",experiments:null==e?void 0:e.experiments,flagged:(null==e?void 0:e.ContentFlag)||"Pre-Filter"===(null==e?void 0:e.error),config:null==e?void 0:e.config}))}));case 19:case"end":return e.stop()}}),e,null,[[7,13]])})));return function(t){return e.apply(this,arguments)}}();null!=e&&e.ZENDESK_AUTOFILL&&chrome.tabs.onUpdated.addListener(function(){var e=la(ca().mark((function e(t,n,r){return ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n.url&&chrome.tabs.sendMessage(t,{message:"url has changed"})}catch(e){console.log("error in url change detection",e)}case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}())}catch(t){console.log(t)}})()})();